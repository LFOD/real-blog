---
title: 'Bayes Theorem and the Probability of Having COVID-19'
author: "Lucy D'Agostino McGowan"
date: '2020-04-09'
slug: bayes-theorem-and-covid-19-infection
categories: [statistics, uncertainty, coronavirus, casual inference, bayes theorem]
tags: [statistics, uncertainty, coronavirus, casual inference, bayes]
excerpt: "I've seen a few papers describing the characteristics of people who tested positive for SARS-CoV-2 and this is sometimes being interpreted as describing people with certain characteristic's the probability of infection. Let's talk about why that's likely not true."
---



<p>Iâ€™ve seen a few papers describing the characteristics of people who tested positive for SARS-CoV-2 and this is sometimes being interpreted as describing people with certain characteristicâ€™s the <strong>probability of infection</strong>. Letâ€™s talk about why thatâ€™s likely not true.</p>
<p>ğŸ‘‰ Usually when thinking about estimating the prevalence of a disease, we use the <strong>sensitivity</strong> and <strong>specificity</strong> of the test to help us<br />
ğŸ‘‰ The calculations assume that everyone is equally likely to get tested, and with SARS-CoV-2 that is likely not the case</p>
<p>Letâ€™s do some ğŸ’­ thought experiments. For these, my goal is to estimate the probability of being infected with ğŸ¦  SARS-CoV-2 given you have ğŸ§© Disease X</p>
<p>For example,ğŸ§© Disease X could be:</p>
<p>â™¥ï¸ heart disease<br />
ğŸ˜¡ hypertension<br />
â• it could also be any subgroup (for example age, etc)</p>
<p>In these ğŸ’­ thought experiments, we donâ€™t actually have perfect information about who is infected with ğŸ¦  SARS-CoV-2, we just know among those who are ğŸ§ª <strong>tested</strong> who has been infected with ğŸ¦  SARS-CoV-2. This is really the crux of the matter.</p>
<p>For these ğŸ’­ thought experiments, assume that the current tests are <em>perfect</em> (that is there are 0 false positives and 0 false negatives)</p>
<p>â˜ï¸ Note that this is likely not the case, with the current testing framework false positives (+) are unlikely but false negatives (-) may be occurring.</p>
<p>We want the probability of being infected with SARS-CoV-2 given you have Disease X: P(ğŸ¦ |ğŸ§©)</p>
<p>To get this, we need P(ğŸ§©|ğŸ¦ ) because based on Bayesâ€™ Theorem we know:</p>
<p>P(ğŸ¦ |ğŸ§©) = P(ğŸ§©|ğŸ¦ )P(ğŸ¦ ) / P(ğŸ§©)</p>
<p>BUT, instead of P(ğŸ§©|ğŸ¦ ), we actually have P(ğŸ§©|ğŸ¦ , ğŸ§ª) - the probability of having disease X given you have SARS-CoV-2 AND you were tested. So the crux of these thought experiments will be trying to get an accurate estimate of P(ğŸ§©|ğŸ¦ ) so that we can get back to P(ğŸ¦ |ğŸ§©).</p>
<div id="thought-experiment-1-best-case-scenario" class="section level2">
<h2>Thought experiment 1ï¸âƒ£: Best case scenario</h2>
<p><label for="tufte-mn-" class="margin-toggle">âŠ•</label><input type="checkbox" id="tufte-mn-" class="margin-toggle"><span class="marginnote">Note: all of these numbers are made up!</span>
ğŸ§© 20% of the population has disease X<br />
ğŸ¦  50% are infected with SARS-CoV-2
âŒ There is no relationship between disease X and SARS-CoV-2<br />
ğŸ§ª People with disease X are just as likely to get tested than people without disease X</p>
<p><img src="https://pbs.twimg.com/media/EVLdlokU4AQauYQ?format=jpg&amp;name=medium" /></p>
<p>Why is thought experiment 1ï¸âƒ£ a best case scenario?</p>
<p>It looks like:</p>
<p>ğŸ§ª 50% have SARS-CoV-2 infection among those tested<br />
ğŸ§ª Of those who tested positive, the prevalence of disease X is 20%<br />
P(ğŸ¦ |ğŸ§©) = 50%</p>
<p>âœ… Reality (no relationship between disease X and SARS-CoV-2) matches what we see</p>
</div>
<div id="thought-experiment-2-oversampling-scenario" class="section level2">
<h2>Thought experiment 2ï¸âƒ£: Oversampling scenario</h2>
<p>ğŸ§© 20% of the population has disease X
Microbe 50% have SARS-CoV-2 infection<br />
âŒ There is no relationship between disease X and SARS-CoV-2<br />
ğŸ§ª People with disease X are <strong>2x</strong> more likely to get tested than people without disease X</p>
<p><img src="https://pbs.twimg.com/media/EVLSv4XUUAAmrVf?format=jpg&amp;name=medium" /></p>
<p>Why is thought experiment 2ï¸âƒ£ bad?</p>
<p>It looks like:</p>
<p>ğŸ§ª 50% have SARS-CoV-2 infection among those tested<br />
ğŸ§ª Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 33% ğŸ˜±</p>
<p>âŒ If we plug in what we see (P(ğŸ§©|ğŸ¦ , ğŸ§ª) for P(ğŸ§©|ğŸ¦ )), it looks like P(ğŸ¦ |ğŸ§©) is 82.5%, when in reality it is 50%.</p>
</div>
<div id="thought-experiment-3-undersampling-scenario" class="section level2">
<h2>Thought experiment 3ï¸âƒ£: Undersampling scenario</h2>
<p>ğŸ§© 20% of the population has disease X<br />
ğŸ¦  50% have SARS-CoV-2 infection<br />
âŒ There is no relationship between disease X and SARS-CoV-2<br />
ğŸ§ª People with disease X are <strong>1/2</strong> as likely to get tested than people without disease X</p>
<p><img src="https://pbs.twimg.com/media/EVLTevlUUAEvE14?format=jpg&amp;name=medium" /></p>
<p>Why is thought experiment 3ï¸âƒ£ bad?</p>
<p>It looks like:
ğŸ§ª 50% have SARS-CoV-2 infection among those tested<br />
ğŸ§ª Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 11%</p>
<p>âŒ If we plug in what we see (P(ğŸ§©|ğŸ¦ , ğŸ§ª) for P(ğŸ§©|ğŸ¦ )), it looks like P(ğŸ¦ |ğŸ§©) is 27.5%, when in reality it is 50%.</p>
</div>
<div id="thought-experiment-4-two-problems-scenario" class="section level2">
<h2>Thought experiment 4ï¸âƒ£: two problems scenario</h2>
<p>ğŸ§© 20% of the population has disease X<br />
ğŸ¦  56% have SARS-CoV-2 infection<br />
âœ… people with disease X are 1.6 times more likely to have SARS-CoV-2 infection, P(ğŸ¦ |ğŸ§©) = 80%<br />
ğŸ§ª People with disease X are <strong>5</strong> as likely to get tested than people without disease X</p>
<p><img src="https://pbs.twimg.com/media/EVLUjEyUMAELWG8?format=jpg&amp;name=medium" /></p>
<p>Why is thought experiment 4ï¸âƒ£ bad?</p>
<p>It looks like:</p>
<p>ğŸ¦ ğŸ§ª 66% have SARS-CoV-2 infection among those tested<br />
ğŸ§©ğŸ§ª Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 66%</p>
<p>âŒ Weâ€™re getting both the prevalence of SARS-CoV-2 <strong>and</strong> itâ€™s association with Disease X wrong</p>
</div>
<div id="how-can-we-fix-this" class="section level2">
<h2>How can we fix this?</h2>
<p>OKAY, scenarios finished, so hopefully this highlights why we canâ€™t take the prevalence of characteristics in the <strong>tested positive</strong> population as the prevalence of characteristics in the overall population with a SARS-CoV-2 infection. Now, here are tips for how we can correct the numbers.</p>
<p>Scenario 2ï¸âƒ£: Oversampling by 2x</p>
<p>ğŸ‘‰ take those with disease X that tested positive for SARS-CoV-2 and downweight them by a factor of 2.</p>
<p>âœ… the adjusted prevalence of Disease X among those that tested positive for SARS-CoV-2 (0.5 / 2.5) = 0.2 (20%)</p>
<p>P(ğŸ¦ |ğŸ§©) = 50%</p>
<p><img src="https://pbs.twimg.com/media/EVLXjDhUMAE1K7_?format=jpg&amp;name=medium" /></p>
<p>Scenario 3ï¸âƒ£: Undersampling by 1/2</p>
<p>ğŸ‘‰ take those with disease X that tested positive for SARS-CoV-2 and upweight them by a factor of 2.</p>
<p>âœ… the adjusted prevalence of Disease X among those that tested positive for SARS-CoV-2 (2/ 10) = 0.2 (20%)</p>
<p>P(ğŸ¦ |ğŸ§©) = 50%</p>
<p><img src="https://pbs.twimg.com/media/EVLXmSkUMAAHZ3g?format=jpg&amp;name=medium" /></p>
<p>Scenario 4ï¸âƒ£: Two problems</p>
<p>For the prevalence of SARS-CoV-2 infections, correct by weighing by the probability of being tested in each subgroup. Here:</p>
<p>ğŸ§© = disease X<br />
âŒğŸ§© = No disease X</p>
<p>P(ğŸ¦ ) = P(ğŸ¦  | ğŸ§©) P(ğŸ§©) + P(ğŸ¦  | âŒğŸ§©) P(âŒğŸ§©)</p>
<p>âœ…P(ğŸ¦ ) = â…˜ * 0.2 + Â½ * 0.8 = 56%</p>
<p>Said another way, for calculating the overall prevalence of SARS-CoV-2, this is like downweighting the oversampled Disease X people (divide by 5).</p>
<p>âœ… P(ğŸ¦ ) = (â…˜ + 2) / (â…˜ + 2 + â…• + 2) = 0.56</p>
<p>For calculating the prevalence of disease X among those with SARS-CoV-2 infections:</p>
<p>âœ… P(ğŸ§© | ğŸ¦ ) = P(ğŸ¦  | ğŸ§©) P(ğŸ§©) / P(ğŸ¦ ) = â…˜ * 0.2 / 0.56 = 0.285</p>
<p>Again, downweight the oversampled Disease X population (divide by 5).</p>
<p>âœ… P(ğŸ§© | ğŸ¦ ) = â…˜ / (â…˜ + 2) = 0.285</p>
<p>P(ğŸ¦  | ğŸ§©) = 80%</p>
<p><img src="https://pbs.twimg.com/media/EVLXqXAUEAApzdi?format=jpg&amp;name=medium" /></p>
<p>Hopefully this is somewhat helpful when reading about characteristics of those who are currently testing positive for SARS-CoV-2. As always, please let me know if there is something Iâ€™ve missed! ğŸ™</p>
</div>
