---
title: "Secret Sampling \U0001F385\U0001F936"
author: "Sarah Lotspeich and Lucy D'Agostino McGowan"
date: '2017-11-15'
slug: secret-sampling
categories: 
  - rstats
  - holiday cheer
tags: 
  - rstats
  - holiday cheer
excerpt: "'Tis the season for white elphant / גמד וענק / Yankee swap / secret santa-ing! We thought it'd be particularly fun to do it #rstats style."
---



<p>’Tis the season for white elphant / גמד וענק / Yankee swap / secret santa-ing! There are various rules for this, for our version:</p>
<p>🏷 each participant receives the name of someone else to purchase a gift for<br />
🎁 gifts are exchanged at a party<br />
🤔 the receiver is tasked with guessing who the gift-giver was!</p>
<p>We thought it’d be particularly fun to do it #rstats style.</p>
<div id="assigning-partners" class="section level1">
<h1>Assigning partners</h1>
<p>We had our classmates sign up if they were interested in a Google Form.</p>
<p><label for="tufte-mn-" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-" class="margin-toggle"><span class="marginnote"><img src="/images/2017-11-14/google-form.png" /></span></p>
<p>resulting in a Google Sheet with each participant’s <code>name</code>, <code>email</code>, and <code>interests</code></p>
<pre class="r"><code>library(&quot;googlesheets&quot;)
library(&quot;dplyr&quot;)</code></pre>
<pre class="r"><code>df &lt;- gs_url(&quot;https://docs.google.com/spreadsheets/d/1NHbsjZVhvIxzuivXWQvDBst0oMN7ZcCjCbI8XJeXxJI/edit#gid=860103774&quot;) %&gt;%
  gs_read()</code></pre>
<p>We began by making a tibble that shuffled the <code>name</code> in the first column and assigned a random <code>partner</code> in the second.</p>
<pre class="r"><code>dat &lt;- tibble(
  name = sample(df$name),
  partner = sample(df$name)
)</code></pre>
<p>“But what if someone was assigned to be their own partner!” you may ask. <label for="tufte-mn-" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-" class="margin-toggle"><span class="marginnote"><img src="https://media.giphy.com/media/23WStXFJFKN44/giphy.gif" /></span> Have no fear! A <code>while</code> loop is here! We allow a <code>while</code> loop to iterate until every individual is assigned a partner (who isn’t them!).</p>
<pre class="r"><code>while (any(dat$name == dat$partner)) {
  dat &lt;- tibble(
    name = sample(df$name),
    partner = sample(df$name)
  )
}</code></pre>
<p>We then do a join to pull the emails back in.</p>
<pre class="r"><code>df_name &lt;- names[ , c(&quot;name&quot;, &quot;email&quot;)]
df_partner &lt;- names[ , c(&quot;name&quot;, &quot;interests&quot;)]
dat &lt;- dat %&gt;%
  left_join(df_name, c(&quot;name&quot; = &quot;name&quot;)) %&gt;%
  left_join(df_partner, c(&quot;partner&quot; = &quot;name&quot;))</code></pre>
</div>
<div id="sending-the-email" class="section level1">
<h1>Sending the email</h1>
<p><a href="https://twitter.com/_inundata">Karthik</a> and I had a blast at <a href="https://ropensci.org">rOpenSci</a> unconf creating the <a href="https://github.com/ropenscilabs/ponyexpress">ponyexpress package</a> - what a delightful chance to use it! We didn’t want the secret to be spoiled (i.e. we didn’t want to know who would be buying us gifts!), so we wrote a script to send an email to our classmates.</p>
<pre class="r"><code>## devtools::install_github(&quot;ropenscilabs/ponyexpress&quot;)
library(&quot;ponyexpress&quot;)</code></pre>
<p><label for="tufte-mn-" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-" class="margin-toggle"><span class="marginnote"><img src="https://assets-auto.rbl.ms/248d7dc3241d5585d0d9feba16933a8f5352c8f3fd6fb575c246725b35128824" /></span></p>
<pre class="r"><code>body &lt;- &quot;Dear {name},

You have been assigned to surprise &lt;b&gt;{partner}&lt;/b&gt; with a happy gift! {partner} told us they have the following interests:

&lt;b&gt;{interests}&lt;/b&gt;

Remember, the price limit is $20. 

&lt;img src = &#39;https://media.giphy.com/media/zhPXoVIBMtnUs/giphy.gif&#39;&gt; &lt;/img&gt;

Happy white elephant-ing,
Sarah &amp; Lucy&quot;

our_template &lt;- glue::glue(glitter_template)

parcel &lt;- parcel_create(dat,
                        sender_name = &quot;Lucy&quot;,
                        sender_email = &quot;lucydagostino@gmail.com&quot;,
                        subject = &quot;Secret Santa!&quot;,
                        template = our_template)

parcel_preview(parcel)     

parcel_send(parcel)</code></pre>
<p>This will create an email like this:</p>
<p><img src = "/images/2017-11-14/email.png" width = "500"></img></p>
<p>And that’s it! Happy gift-ing 🎁!</p>
<div class="figure">
<img src="https://media.giphy.com/media/zhPXoVIBMtnUs/giphy.gif" />

</div>
</div>
