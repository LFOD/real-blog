<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Custom JS Visualization in RMarkdown"/>
<meta name="twitter:description" content="I happened to stumble upon the preview release page for RStudio recently and noticed something that made me exorbitantly happy.
 A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…
 “Support for JavaScript and CSS chunks in R Notebooks”! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting."/>



  	<meta property="og:title" content=" Custom JS Visualization in RMarkdown &middot;  Live Free or Dichotomize" />
  	<meta property="og:site_name" content="Live Free or Dichotomize" />
  	<meta property="og:url" content="/2017/01/24/custom-js-visualization-in-rmarkdown/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2017-01-24T10:54:24&#43;02:00" />

    
    <meta property="og:article:tag" content="javascript" />
    
    <meta property="og:article:tag" content="visualization" />
    
    

    <title>
       Custom JS Visualization in RMarkdown &middot;  Live Free or Dichotomize
    </title>

    <meta name="description" content="A statistics blog from two goofy Phd students." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../../../../images/favicon.ico">
	  <link rel="apple-touch-icon" href="../../../../images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="../../../../css/screen.css" />
    <link rel="stylesheet" type="text/css" href="../../../../css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />


    
      
          <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="Live Free or Dichotomize" />
      
      
    
    <meta name="generator" content="Hugo 0.18.1" />

    <link rel="canonical" href="../../../../2017/01/24/custom-js-visualization-in-rmarkdown/" />

    

    






</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="../../../../about/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/lfod/blog">GitHub</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/LucyStats">Lucy&#39;s Twitter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/NickStrayer">Nick&#39;s Twitter</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="../../../../index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="../../../../"><img src="../../../../images/logo.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Custom JS Visualization in RMarkdown</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-01-24T10:54:24&#43;02:00">
            Jan 24, 2017
          </time>
        
         
          <span class="post-tag small"><a href="../../../../tags/javascript/">#javascript</a></span>
         
          <span class="post-tag small"><a href="../../../../tags/visualization/">#visualization</a></span>
         
        </section>
    </header>

    <section class="post-content">


<p>I happened to stumble upon the <a href="https://www.rstudio.com/products/rstudio/download/preview/">preview release page</a> for RStudio recently and noticed something that made me exorbitantly happy.</p>
<blockquote>
<p>A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…</p>
</blockquote>
<p><em>“Support for JavaScript and CSS chunks in R Notebooks”</em>! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting. Previously my workflow for generating an interactive graphic would be something like:</p>
<ul>
<li>Download data</li>
<li>Clean data and do preliminary visualization in R</li>
<li>Export what I liked to a csv file and make a new directory with a set of <code>.html, .js, .css</code> files in it.</li>
<li>Load data into javascript/d3.js in the new javascript file.</li>
<li>Plot.</li>
</ul>
<p>This workflow has served me very well, I did it probably 20 times a day when working at the New York Times and I am very fast with it. If you want to just make a stand alone visualization it’s fantastic, however, as a biostatistician who works with a lot of other biostatisticians, people tend to want to see where the data comes from.</p>
<p>With Javascript chunks in <code>.Rmd</code> files you can explicitly show the code for data gathering/cleaning etc. in a language that your collaborators can understand, along with making custom d3 charts with that data. All without ever leaving RStudio. I will show you my quick and dirty solution to doing so.</p>
<div id="getting-data-into-javascript" class="section level2">
<h2>Getting data into Javascript</h2>
<p>Instead of generating a csv file in R and then loading that into javascript we will instead send the data directly through the html to javascript. (<em>Note:</em> This wont work well with super large data).</p>
<p>Inspired by <a href="https://medium.com/@becausealice2/getting-r-and-d3-js-to-play-nicely-in-r-markdown-270e302a52d3#.772g93eb3">this</a> medium post I wrote a little function that takes a dataframe and sends it to the html document in the <code>.json</code> format.</p>
<pre class="r"><code>library(tidyverse)
library(jsonlite)

send_df_to_js &lt;- function(df){
  cat(
    paste(
    &#39;&lt;script&gt;
      var data = &#39;,toJSON(df),&#39;;
    &lt;/script&gt;&#39;
    , sep=&quot;&quot;)
  )
}</code></pre>
<p>To illustrate how it works we will generate some random data into a dataframe.</p>
<pre class="r"><code>#Generate some random x and y data to plot
n &lt;- 300
random_data &lt;- data_frame(x = runif(n)*10) %&gt;% 
  mutate(y = 0.5*x^3 - 1.3*x^2 + rnorm(n, mean = 0, sd = 80),
         group = paste(&quot;group&quot;, sample(c(1,2,3), n, replace = T)))</code></pre>
<p>Now we send a snippit of the dataframe into the function to see the output…</p>
<pre class="r"><code>random_data %&gt;% 
  head() %&gt;% 
  send_df_to_js()</code></pre>
<pre><code>## &lt;script&gt;
##       var data = [{&quot;x&quot;:5.9163,&quot;y&quot;:-45.8182,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:3.4755,&quot;y&quot;:64.2628,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:4.2556,&quot;y&quot;:24.1629,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:5.6682,&quot;y&quot;:80.8743,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:4.5396,&quot;y&quot;:-124.9692,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:5.4025,&quot;y&quot;:13.8923,&quot;group&quot;:&quot;group 3&quot;}];
##     &lt;/script&gt;</code></pre>
<p>Beautiful, we have our data, in <code>json</code> format, wrapped in a script tag. Now we can send the whole dataframe through. This time I am using the <code>results = &quot;asis&quot;</code> option in the code chunk (<code>{r, results = &quot;asis&quot;}</code>), to write the results directly to the html document and not to the output like we did above.</p>
<pre class="r"><code>#Initiate data transfer protocol one
send_df_to_js(random_data)</code></pre>
<script>
      var data = [{"x":5.9163,"y":-45.8182,"group":"group 3"},{"x":3.4755,"y":64.2628,"group":"group 1"},{"x":4.2556,"y":24.1629,"group":"group 2"},{"x":5.6682,"y":80.8743,"group":"group 1"},{"x":4.5396,"y":-124.9692,"group":"group 2"},{"x":5.4025,"y":13.8923,"group":"group 3"},{"x":2.9398,"y":-150.6787,"group":"group 2"},{"x":5.9993,"y":-43.6789,"group":"group 3"},{"x":4.9488,"y":-78.8114,"group":"group 2"},{"x":9.4562,"y":264.297,"group":"group 3"},{"x":0.0592,"y":-19.9311,"group":"group 3"},{"x":1.4078,"y":65.5129,"group":"group 3"},{"x":2.8076,"y":-105.4599,"group":"group 3"},{"x":5.3238,"y":173.2654,"group":"group 2"},{"x":8.2684,"y":226.0982,"group":"group 1"},{"x":2.8271,"y":107.7256,"group":"group 3"},{"x":0.182,"y":-86.9755,"group":"group 3"},{"x":3.6775,"y":-92.1473,"group":"group 3"},{"x":0.884,"y":54.924,"group":"group 2"},{"x":1.2199,"y":80.9665,"group":"group 1"},{"x":5.8522,"y":135.6753,"group":"group 3"},{"x":9.4884,"y":462.5099,"group":"group 3"},{"x":9.6225,"y":363.2139,"group":"group 3"},{"x":6.7939,"y":53.3573,"group":"group 3"},{"x":4.2563,"y":21.831,"group":"group 3"},{"x":5.2411,"y":13.0734,"group":"group 3"},{"x":9.5422,"y":307.8614,"group":"group 1"},{"x":6.2745,"y":-15.8482,"group":"group 2"},{"x":9.5592,"y":369.3136,"group":"group 2"},{"x":4.7174,"y":-79.0851,"group":"group 3"},{"x":6.3023,"y":108.9861,"group":"group 3"},{"x":5.5511,"y":103.3347,"group":"group 3"},{"x":1.8581,"y":9.6992,"group":"group 3"},{"x":8.5145,"y":103.8222,"group":"group 3"},{"x":1.6757,"y":-206.7009,"group":"group 3"},{"x":3.4886,"y":-76.0612,"group":"group 2"},{"x":4.1015,"y":-14.2232,"group":"group 2"},{"x":2.6534,"y":60.4473,"group":"group 2"},{"x":3.4676,"y":-11.4277,"group":"group 1"},{"x":2.6015,"y":37.3514,"group":"group 1"},{"x":7.0315,"y":202.5109,"group":"group 2"},{"x":7.2397,"y":97.3175,"group":"group 2"},{"x":9.2531,"y":189.1101,"group":"group 3"},{"x":1.606,"y":21.9222,"group":"group 1"},{"x":0.7561,"y":-104.1959,"group":"group 1"},{"x":3.7584,"y":-83.5558,"group":"group 3"},{"x":4.6103,"y":-10.8608,"group":"group 1"},{"x":7.1699,"y":103.1003,"group":"group 2"},{"x":6.3792,"y":67.1674,"group":"group 1"},{"x":6.9808,"y":164.4976,"group":"group 2"},{"x":6.3575,"y":10.5661,"group":"group 3"},{"x":8.5983,"y":241.8532,"group":"group 3"},{"x":3.832,"y":164.3482,"group":"group 1"},{"x":2.8011,"y":29.949,"group":"group 2"},{"x":5.3874,"y":145.096,"group":"group 3"},{"x":4.6418,"y":-23.1814,"group":"group 2"},{"x":8.2652,"y":182.3253,"group":"group 1"},{"x":2.3357,"y":166.2209,"group":"group 3"},{"x":6.207,"y":-49.6297,"group":"group 1"},{"x":3.8322,"y":47.5612,"group":"group 1"},{"x":2.3413,"y":-243.5293,"group":"group 1"},{"x":6.9923,"y":58.0471,"group":"group 2"},{"x":5.4189,"y":-59.6968,"group":"group 3"},{"x":4.2221,"y":0.2541,"group":"group 1"},{"x":1.8921,"y":-34.9282,"group":"group 3"},{"x":0.5219,"y":52.0449,"group":"group 1"},{"x":2.3573,"y":35.5912,"group":"group 3"},{"x":7.7544,"y":166.2366,"group":"group 1"},{"x":7.9836,"y":24.2784,"group":"group 1"},{"x":2.9769,"y":16.1577,"group":"group 1"},{"x":1.7898,"y":12.102,"group":"group 2"},{"x":9.5013,"y":223.8816,"group":"group 2"},{"x":7.4233,"y":158.2595,"group":"group 3"},{"x":8.7571,"y":336.313,"group":"group 1"},{"x":6.5473,"y":30.9855,"group":"group 3"},{"x":5.8678,"y":33.521,"group":"group 3"},{"x":1.2021,"y":-61.7319,"group":"group 1"},{"x":1.9866,"y":107.2518,"group":"group 1"},{"x":0.1578,"y":-14.046,"group":"group 1"},{"x":8.0061,"y":136.6289,"group":"group 1"},{"x":2.802,"y":-6.9318,"group":"group 2"},{"x":7.2537,"y":12.173,"group":"group 1"},{"x":1.1516,"y":-32.3296,"group":"group 3"},{"x":0.2122,"y":91.1002,"group":"group 3"},{"x":5.6555,"y":194.0523,"group":"group 1"},{"x":9.9118,"y":330.5297,"group":"group 1"},{"x":9.1346,"y":287.2535,"group":"group 3"},{"x":3.6675,"y":-88.192,"group":"group 1"},{"x":8.389,"y":140.5647,"group":"group 3"},{"x":6.0938,"y":99.4315,"group":"group 2"},{"x":4.2269,"y":71.4321,"group":"group 3"},{"x":2.3162,"y":21.3011,"group":"group 2"},{"x":2.1172,"y":53.0805,"group":"group 1"},{"x":2.2686,"y":47.8607,"group":"group 1"},{"x":0.4319,"y":57.8657,"group":"group 3"},{"x":4.1506,"y":-19.4949,"group":"group 1"},{"x":5.593,"y":89.0368,"group":"group 2"},{"x":0.8852,"y":-37.6071,"group":"group 3"},{"x":8.819,"y":145.6304,"group":"group 1"},{"x":4.6529,"y":29.9949,"group":"group 1"},{"x":0.7389,"y":-109.7236,"group":"group 1"},{"x":3.7986,"y":22.35,"group":"group 3"},{"x":6.3856,"y":84.1418,"group":"group 1"},{"x":4.6171,"y":37.9215,"group":"group 3"},{"x":0.7962,"y":-66.3678,"group":"group 2"},{"x":8.5001,"y":96.2653,"group":"group 3"},{"x":9.0144,"y":299.2136,"group":"group 2"},{"x":2.8996,"y":-57.4802,"group":"group 2"},{"x":7.809,"y":264.7895,"group":"group 1"},{"x":0.3712,"y":-4.3689,"group":"group 1"},{"x":7.6605,"y":52.6001,"group":"group 1"},{"x":3.2497,"y":6.4403,"group":"group 2"},{"x":4.7613,"y":91.3557,"group":"group 1"},{"x":8.5779,"y":267.7793,"group":"group 3"},{"x":5.8922,"y":104.5596,"group":"group 3"},{"x":6.3525,"y":-90.9781,"group":"group 2"},{"x":5.7899,"y":165.1401,"group":"group 2"},{"x":4.8527,"y":-11.979,"group":"group 1"},{"x":4.9844,"y":81.7203,"group":"group 3"},{"x":8.2983,"y":132.4322,"group":"group 1"},{"x":1.2139,"y":44.1236,"group":"group 2"},{"x":0.7755,"y":-92.5824,"group":"group 2"},{"x":5.2988,"y":85.6808,"group":"group 1"},{"x":5.2726,"y":76.2278,"group":"group 1"},{"x":8.8259,"y":269.7891,"group":"group 1"},{"x":1.9954,"y":-76.122,"group":"group 1"},{"x":9.8722,"y":335.0146,"group":"group 3"},{"x":0.9872,"y":41.457,"group":"group 3"},{"x":3.7644,"y":-120.4402,"group":"group 3"},{"x":5.7172,"y":88.5685,"group":"group 2"},{"x":3.5935,"y":-112.0726,"group":"group 2"},{"x":9.5184,"y":159.6737,"group":"group 3"},{"x":6.8594,"y":107.6545,"group":"group 1"},{"x":9.987,"y":456.9501,"group":"group 1"},{"x":3.5312,"y":52.504,"group":"group 1"},{"x":1.7367,"y":-29.6525,"group":"group 2"},{"x":1.5886,"y":41.6534,"group":"group 1"},{"x":8.6715,"y":185.864,"group":"group 1"},{"x":8.9386,"y":363.7367,"group":"group 3"},{"x":2.0194,"y":-99.7372,"group":"group 3"},{"x":7.416,"y":146.905,"group":"group 3"},{"x":7.3272,"y":177.4626,"group":"group 3"},{"x":9.3688,"y":297.7015,"group":"group 1"},{"x":4.297,"y":-33.137,"group":"group 1"},{"x":5.8734,"y":47.4741,"group":"group 2"},{"x":2.635,"y":202.4701,"group":"group 2"},{"x":7.7927,"y":141.3971,"group":"group 3"},{"x":2.4473,"y":-66.9482,"group":"group 2"},{"x":5.7358,"y":47.3018,"group":"group 1"},{"x":9.4943,"y":272.5528,"group":"group 2"},{"x":4.9609,"y":-10.1801,"group":"group 1"},{"x":2.9127,"y":33.4242,"group":"group 1"},{"x":0.0361,"y":12.5095,"group":"group 1"},{"x":6.6344,"y":-31.2301,"group":"group 1"},{"x":5.5747,"y":-90.9211,"group":"group 2"},{"x":8.0433,"y":257.1713,"group":"group 3"},{"x":8.147,"y":172.7584,"group":"group 3"},{"x":4.0362,"y":-93.7088,"group":"group 2"},{"x":2.6128,"y":21.4476,"group":"group 2"},{"x":4.4257,"y":172.2581,"group":"group 2"},{"x":9.5234,"y":280.1587,"group":"group 3"},{"x":3.8285,"y":-95.7588,"group":"group 1"},{"x":6.0972,"y":116.8281,"group":"group 2"},{"x":1.0312,"y":-76.8576,"group":"group 1"},{"x":0.4034,"y":-60.328,"group":"group 1"},{"x":9.4833,"y":319.4346,"group":"group 2"},{"x":8.7198,"y":284.7844,"group":"group 2"},{"x":9.2616,"y":287.6246,"group":"group 3"},{"x":5.1159,"y":-17.6438,"group":"group 1"},{"x":0.0121,"y":-12.7911,"group":"group 1"},{"x":4.5329,"y":88.1521,"group":"group 1"},{"x":1.9761,"y":-66.0977,"group":"group 1"},{"x":8.1619,"y":275.7456,"group":"group 2"},{"x":5.9422,"y":48.8256,"group":"group 2"},{"x":5.1821,"y":-24.7867,"group":"group 3"},{"x":4.5494,"y":-213.7997,"group":"group 3"},{"x":7.7179,"y":196.9902,"group":"group 2"},{"x":8.2814,"y":166.5183,"group":"group 2"},{"x":1.1925,"y":-53.2894,"group":"group 1"},{"x":5.5685,"y":194.6646,"group":"group 3"},{"x":5.4649,"y":19.9991,"group":"group 3"},{"x":5.9345,"y":-84.4285,"group":"group 1"},{"x":9.2436,"y":395.5585,"group":"group 2"},{"x":6.3706,"y":131.58,"group":"group 2"},{"x":9.589,"y":399.1625,"group":"group 3"},{"x":0.7023,"y":26.7139,"group":"group 1"},{"x":2.9326,"y":-28.8423,"group":"group 1"},{"x":6.7089,"y":48.3982,"group":"group 3"},{"x":5.1491,"y":54.2672,"group":"group 3"},{"x":5.5736,"y":90.4472,"group":"group 3"},{"x":7.3073,"y":133.3554,"group":"group 3"},{"x":9.2142,"y":348.421,"group":"group 3"},{"x":6.2456,"y":48.5897,"group":"group 3"},{"x":4.5082,"y":110.7298,"group":"group 3"},{"x":9.1287,"y":425.0951,"group":"group 2"},{"x":9.4359,"y":305.8412,"group":"group 1"},{"x":9.3135,"y":406.4655,"group":"group 2"},{"x":3.6867,"y":-53.9177,"group":"group 3"},{"x":6.4978,"y":157.7105,"group":"group 1"},{"x":8.5236,"y":176.7244,"group":"group 2"},{"x":5.2342,"y":-45.0249,"group":"group 3"},{"x":9.9532,"y":370.1069,"group":"group 2"},{"x":0.2731,"y":-18.5645,"group":"group 1"},{"x":1.7975,"y":-52.9907,"group":"group 1"},{"x":6.1705,"y":132.4028,"group":"group 1"},{"x":3.9249,"y":115.2359,"group":"group 3"},{"x":6.5648,"y":65.2309,"group":"group 1"},{"x":9.9391,"y":261.9167,"group":"group 1"},{"x":6.8522,"y":112.9234,"group":"group 3"},{"x":1.47,"y":36.2083,"group":"group 1"},{"x":9.1739,"y":253.471,"group":"group 2"},{"x":3.777,"y":-42.6221,"group":"group 2"},{"x":0.3187,"y":38.4371,"group":"group 3"},{"x":5.9247,"y":180.4337,"group":"group 1"},{"x":8.0185,"y":64.2102,"group":"group 1"},{"x":2.6055,"y":89.1812,"group":"group 3"},{"x":6.9932,"y":116.562,"group":"group 2"},{"x":7.3396,"y":130.0839,"group":"group 2"},{"x":7.3467,"y":121.4292,"group":"group 1"},{"x":0.1555,"y":-104.5409,"group":"group 3"},{"x":4.9441,"y":11.2991,"group":"group 3"},{"x":0.8009,"y":-31.3884,"group":"group 2"},{"x":1.8505,"y":-102.8181,"group":"group 3"},{"x":0.1896,"y":-2.9326,"group":"group 3"},{"x":1.9948,"y":33.5143,"group":"group 3"},{"x":6.6116,"y":-78.8203,"group":"group 2"},{"x":8.0672,"y":350.0338,"group":"group 1"},{"x":8.3335,"y":119.1516,"group":"group 2"},{"x":4.8503,"y":-51.3368,"group":"group 1"},{"x":7.0323,"y":144.307,"group":"group 1"},{"x":2.0007,"y":104.738,"group":"group 1"},{"x":0.6267,"y":65.2279,"group":"group 1"},{"x":7.8979,"y":57.392,"group":"group 3"},{"x":2.2036,"y":-15.9525,"group":"group 1"},{"x":6.2933,"y":92.3293,"group":"group 2"},{"x":0.5385,"y":136.8049,"group":"group 2"},{"x":2.5687,"y":-3.9579,"group":"group 1"},{"x":1.6332,"y":40.7215,"group":"group 3"},{"x":7.2144,"y":166.9764,"group":"group 3"},{"x":7.8116,"y":100.0158,"group":"group 3"},{"x":8.8493,"y":219.3798,"group":"group 3"},{"x":9.3519,"y":285.732,"group":"group 3"},{"x":8.0527,"y":145.7598,"group":"group 3"},{"x":6.6337,"y":72.5103,"group":"group 3"},{"x":8.7812,"y":169.5001,"group":"group 3"},{"x":8.4469,"y":84.4864,"group":"group 3"},{"x":0.6972,"y":126.1293,"group":"group 3"},{"x":3.9321,"y":46.347,"group":"group 3"},{"x":8.1491,"y":252.8942,"group":"group 3"},{"x":8.3233,"y":-41.6754,"group":"group 3"},{"x":7.05,"y":207.7439,"group":"group 2"},{"x":0.189,"y":27.1233,"group":"group 3"},{"x":9.9973,"y":364.1728,"group":"group 1"},{"x":9.7219,"y":265.4861,"group":"group 1"},{"x":7.9051,"y":-36.7643,"group":"group 3"},{"x":3.3843,"y":71.6438,"group":"group 1"},{"x":8.4512,"y":266.833,"group":"group 1"},{"x":4.8107,"y":26.6196,"group":"group 3"},{"x":1.4621,"y":-18.0486,"group":"group 2"},{"x":6.7712,"y":28.9946,"group":"group 3"},{"x":3.7597,"y":-2.4299,"group":"group 2"},{"x":6.1049,"y":45.4717,"group":"group 1"},{"x":1.1211,"y":38.5044,"group":"group 2"},{"x":8.7066,"y":213.381,"group":"group 2"},{"x":7.9364,"y":118.1726,"group":"group 2"},{"x":7.2793,"y":144.9753,"group":"group 2"},{"x":6.6244,"y":161.4025,"group":"group 3"},{"x":8.0374,"y":112.2094,"group":"group 2"},{"x":9.2084,"y":292.4902,"group":"group 2"},{"x":1.1928,"y":-138.2253,"group":"group 3"},{"x":2.8065,"y":11.9019,"group":"group 2"},{"x":9.2503,"y":279.2434,"group":"group 3"},{"x":6.7319,"y":175.8007,"group":"group 3"},{"x":9.1549,"y":301.0231,"group":"group 3"},{"x":0.8852,"y":-26.3123,"group":"group 3"},{"x":5.9529,"y":213.5073,"group":"group 2"},{"x":8.9739,"y":274.6361,"group":"group 3"},{"x":6.3232,"y":232.1458,"group":"group 2"},{"x":1.7449,"y":33.979,"group":"group 1"},{"x":9.3474,"y":171.456,"group":"group 2"},{"x":3.7861,"y":-2.6079,"group":"group 2"},{"x":9.7616,"y":339.7099,"group":"group 3"},{"x":9.7115,"y":393.552,"group":"group 2"},{"x":3.5917,"y":-14.5348,"group":"group 1"},{"x":8.8504,"y":279.5151,"group":"group 1"},{"x":8.9167,"y":252.4343,"group":"group 2"},{"x":1.3829,"y":-32.0172,"group":"group 2"},{"x":7.2489,"y":131.8665,"group":"group 3"},{"x":4.9885,"y":24.2697,"group":"group 1"},{"x":8.6009,"y":264.9039,"group":"group 1"},{"x":3.3526,"y":118.4638,"group":"group 1"},{"x":9.1034,"y":252.0829,"group":"group 1"},{"x":5.8254,"y":213.6056,"group":"group 3"},{"x":5.9922,"y":110.805,"group":"group 2"},{"x":3.5069,"y":-5.6817,"group":"group 2"},{"x":4.7706,"y":-52.6689,"group":"group 1"},{"x":4.3015,"y":-203.473,"group":"group 3"},{"x":3.4827,"y":2.835,"group":"group 2"},{"x":8.7834,"y":238.0589,"group":"group 3"},{"x":1.9397,"y":-82.344,"group":"group 2"}];
    </script>
<p>Now our data is inside our page’s javascript scope and ready to be played with!</p>
</div>
<div id="drawing-pretty-pictures" class="section level2">
<h2>Drawing pretty pictures</h2>
<p>Let’s make a super simple d3 scatter plot to see this randomly generated data. All I have to do is include my desired javascript libraries, make a <code>div</code> element for my visualization to go into and then put my <code>{js}</code> block in. RMarkdown will slot the javascript into the page and we’re good to go.</p>
<p>In this example I did…</p>
<pre><code>&lt;script src=&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://d3js.org/d3.v4.min.js&quot;&gt;&lt;/script&gt;

&lt;div id = &quot;viz&quot;&gt;&lt;/div&gt; 

` ` `{js}
//code goes here
` ` `</code></pre>
</div>
<div id="did-it-work" class="section level2">
<h2>Did it work?</h2>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<div id="viz">

</div>
<script type="text/javascript">
var point_vals = d3.select("#viz").append("p").text("Mouseover some data!");

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $("#did-it-work").width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d => d.x);
var y_extent = d3.extent(data, d => d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select("#viz").append("svg")
    .attr("width", width + 2*margin)
    .attr("height", height + 2*margin)
  .append("g")
    .attr("transform",
          "translate(" + margin + "," + margin + ")");

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(".dots")
    .data(data)
  .enter().append("circle")
    .attr("class", "dots")
    .attr("fill", d => d.group === "group 1"? "steelblue":"orangered")
    .attr("fill-opacity", 0.3)
    .attr("r", 5)
    .attr("cx", d => x(d.x) )
    .attr("cy", d => y(d.y) )
    .on("mouseover", function(d){
       d3.selectAll(".dots").attr("r", 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr("r", 10);
      
       point_vals.text("X:" + d.x + " Y:" + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append("g")
    .call(d3.axisLeft(y));
</script>
</div>
<div id="why-when" class="section level2">
<h2>Why/ When</h2>
<p>This is a bad example of a visualization for this scenario as something like plotly could do this in much less effort. If you’re doing something more complicated/ bespoke then this is a great resource to have.</p>
</div>
<div id="addendum" class="section level2">
<h2>Addendum</h2>
<p>If you’re interested, here’s the javascript code I included to make the above graph.</p>
<pre><code>var point_vals = d3.select(&quot;#viz&quot;).append(&quot;p&quot;).text(&quot;Mouseover some data!&quot;);

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $(&quot;#did-it-work&quot;).width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d =&gt; d.x);
var y_extent = d3.extent(data, d =&gt; d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select(&quot;#viz&quot;).append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width + 2*margin)
    .attr(&quot;height&quot;, height + 2*margin)
  .append(&quot;g&quot;)
    .attr(&quot;transform&quot;,
          &quot;translate(&quot; + margin + &quot;,&quot; + margin + &quot;)&quot;);

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(&quot;.dots&quot;)
    .data(data)
  .enter().append(&quot;circle&quot;)
    .attr(&quot;class&quot;, &quot;dots&quot;)
    .attr(&quot;fill&quot;, d =&gt; d.group === &quot;group 1&quot;? &quot;steelblue&quot;:&quot;orangered&quot;)
    .attr(&quot;fill-opacity&quot;, 0.3)
    .attr(&quot;r&quot;, 5)
    .attr(&quot;cx&quot;, d =&gt; x(d.x) )
    .attr(&quot;cy&quot;, d =&gt; y(d.y) )
    .on(&quot;mouseover&quot;, function(d){
       d3.selectAll(&quot;.dots&quot;).attr(&quot;r&quot;, 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr(&quot;r&quot;, 10);
      
       point_vals.text(&quot;X:&quot; + d.x + &quot; Y:&quot; + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append(&quot;g&quot;)
    .attr(&quot;transform&quot;, &quot;translate(0,&quot; + height + &quot;)&quot;)
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append(&quot;g&quot;)
    .call(d3.axisLeft(y));</code></pre>
</div>




    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="../../../../" style="background-image: url(/images/logo.png)"><span class="hidden">'s Picture</span></a>
    </figure>
    

    








<div class="post-author">

    <img style = "border-radius: 25px;" src="https://avatars0.githubusercontent.com/u/6764693?v=3&amp;u=c9c491a636605fe3d6122defb43eb367b3d9381f&amp;s=400" alt="Nick Strayer image" width="90" height="90">
    <br>
    <span style="font-size: 1.02em;font-weight: bold;">
        Nick Strayer
    </span>
    |
    <a style = "text-decoration: none;" class = "post-author__text" href = http://nickstrayer.me >
        <img style="width:20px;" src = "http://image.flaticon.com/icons/png/128/12/12195.png"/>
    </a>

    <a class="icon-twitter post-author__text" style="font-size: 1.4em; text-decoration: none;" href = https://twitter.com/NicholasStrayer onclick="window.open(this.href"></a>

    <a style = "text-decoration: none;" class = "post-author__text" href = https://github.com/nstrayer >
        <img style="width:23px;" src = "https://a248.e.akamai.net/assets.github.com/images/icons/emoji/octocat.png"/>
    </a>


    <br>

    <p class="post-author__text">Randomly walking my way though a career in statistics</p>
    


    
<section class="share">
  <p style="font-size: 1em; font-weight:bold;">Share this post <a class="icon-twitter" style="font-size: 1.1em" href="https://twitter.com/share?text=Custom%20JS%20Visualization%20in%20RMarkdown&nbsp;-&nbsp;Live%20Free%20or%20Dichotomize&amp;url=https://livefreeordichotomize.com%2f2017%2f01%2f24%2fcustom-js-visualization-in-rmarkdown%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
 </a></p>
</section>



    




  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Live Free or Dichotomize</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="../../../../js/jquery.js"></script>
    <script type="text/javascript" src="../../../../js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="../../../../js/index.js"></script>
    
</body>
</html>

