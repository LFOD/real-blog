<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Custom JS Visualizations in RMarkdown Documents"/>
<meta name="twitter:description" content="I happened to stumble upon the preview release page for RStudio recently and noticed something that made me exorbitantly happy.
 A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…
 “Support for JavaScript and CSS chunks in R Notebooks”! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting."/>



  	<meta property="og:title" content=" Custom JS Visualizations in RMarkdown Documents &middot;  Live Free or Dichotomize" />
  	<meta property="og:site_name" content="Live Free or Dichotomize" />
  	<meta property="og:url" content="/2017/01/24/custom-js-visualizations-in-rmarkdown-documents/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2017-01-24T10:54:24&#43;02:00" />

    
    <meta property="og:article:tag" content="javascript" />
    
    <meta property="og:article:tag" content="visualization" />
    
    

    <title>
       Custom JS Visualizations in RMarkdown Documents &middot;  Live Free or Dichotomize
    </title>

    <meta name="description" content="A statistics blog from two goofy Phd students." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../../../../images/favicon.ico">
	  <link rel="apple-touch-icon" href="../../../../images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="../../../../css/screen.css" />
    <link rel="stylesheet" type="text/css" href="../../../../css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />


    
      
          <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="Live Free or Dichotomize" />
      
      
    
    <meta name="generator" content="Hugo 0.18.1" />

    <link rel="canonical" href="../../../../2017/01/24/custom-js-visualizations-in-rmarkdown-documents/" />

    

    






</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="../../../../about/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/lfod/blog">GitHub</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/LucyStats">Lucy&#39;s Twitter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/NickStrayer">Nick&#39;s Twitter</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="../../../../index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="../../../../"><img src="../../../../images/logo.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Custom JS Visualizations in RMarkdown Documents</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-01-24T10:54:24&#43;02:00">
            Jan 24, 2017
          </time>
        
         
          <span class="post-tag small"><a href="../../../../tags/javascript/">#javascript</a></span>
         
          <span class="post-tag small"><a href="../../../../tags/visualization/">#visualization</a></span>
         
        </section>
    </header>

    <section class="post-content">


<p>I happened to stumble upon the <a href="https://www.rstudio.com/products/rstudio/download/preview/">preview release page</a> for RStudio recently and noticed something that made me exorbitantly happy.</p>
<blockquote>
<p>A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…</p>
</blockquote>
<p><em>“Support for JavaScript and CSS chunks in R Notebooks”</em>! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting. Previously my workflow for generating an interactive graphic would be something like:</p>
<ul>
<li>Download data</li>
<li>Clean data and do preliminary visualization in R</li>
<li>Export what I liked to a csv file and make a new directory with a set of <code>.html, .js, .css</code> files in it.</li>
<li>Load data into javascript/d3.js in the new javascript file.</li>
<li>Plot.</li>
</ul>
<p>This workflow has served me very well, I did it probably 20 times a day when working at the New York Times and I am very fast with it. If you want to just make a stand alone visualization it’s fantastic, however, as a biostatistician who works with a lot of other biostatisticians, people tend to want to see where the data comes from.</p>
<p>With Javascript chunks in <code>.Rmd</code> files you can explicitly show the code for data gathering/cleaning etc. in a language that your collaborators can understand, along with making custom d3 charts with that data. All without ever leaving RStudio. I will show you my quick and dirty solution to doing so.</p>
<div id="getting-data-into-javascript" class="section level2">
<h2>Getting data into Javascript</h2>
<p>Instead of generating a csv file in R and then loading that into javascript we will instead send the data directly through the html to javascript. (<em>Note:</em> This wont work well with super large data).</p>
<p>Inspired by <a href="https://medium.com/@becausealice2/getting-r-and-d3-js-to-play-nicely-in-r-markdown-270e302a52d3#.772g93eb3">this</a> medium post I wrote a little function that takes a dataframe and sends it to the html document in the <code>.json</code> format.</p>
<pre class="r"><code>library(tidyverse)
library(jsonlite)

send_df_to_js &lt;- function(df){
  cat(
    paste(
    &#39;&lt;script&gt;
      var data = &#39;,toJSON(df),&#39;;
    &lt;/script&gt;&#39;
    , sep=&quot;&quot;)
  )
}</code></pre>
<p>To illustrate how it works we will generate some random data into a dataframe.</p>
<pre class="r"><code>#Generate some random x and y data to plot
n &lt;- 300
random_data &lt;- data_frame(x = runif(n)*10) %&gt;% 
  mutate(y = 0.5*x^3 - 1.3*x^2 + rnorm(n, mean = 0, sd = 80),
         group = paste(&quot;group&quot;, sample(c(1,2,3), n, replace = T)))</code></pre>
<p>Now we send a snippit of the dataframe into the function to see the output…</p>
<pre class="r"><code>random_data %&gt;% 
  head() %&gt;% 
  send_df_to_js()</code></pre>
<pre><code>## &lt;script&gt;
##       var data = [{&quot;x&quot;:1.2238,&quot;y&quot;:-49.4897,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:7.4091,&quot;y&quot;:164.8781,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:8.45,&quot;y&quot;:248.4451,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:1.2849,&quot;y&quot;:67.7754,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:3.9746,&quot;y&quot;:-7.0472,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:6.5551,&quot;y&quot;:5.2527,&quot;group&quot;:&quot;group 2&quot;}];
##     &lt;/script&gt;</code></pre>
<p>Beautiful, we have our data, in <code>json</code> format, wrapped in a script tag. Now we can send the whole dataframe through. This time I am using the <code>results = &quot;asis&quot;</code> option in the code chunk (<code>{r, results = &quot;asis&quot;}</code>), to write the results directly to the html document and not to the output like we did above.</p>
<pre class="r"><code>#Initiate data transfer protocol one
send_df_to_js(random_data)</code></pre>
<script>
      var data = [{"x":1.2238,"y":-49.4897,"group":"group 2"},{"x":7.4091,"y":164.8781,"group":"group 1"},{"x":8.45,"y":248.4451,"group":"group 1"},{"x":1.2849,"y":67.7754,"group":"group 3"},{"x":3.9746,"y":-7.0472,"group":"group 3"},{"x":6.5551,"y":5.2527,"group":"group 2"},{"x":1.0383,"y":-45.6582,"group":"group 3"},{"x":9.9794,"y":532.1476,"group":"group 2"},{"x":3.4816,"y":0.0162,"group":"group 2"},{"x":9.1806,"y":204.7875,"group":"group 1"},{"x":6.5576,"y":-63.6344,"group":"group 3"},{"x":1.4943,"y":27.4842,"group":"group 3"},{"x":0.7976,"y":60.4668,"group":"group 1"},{"x":9.9997,"y":214.6135,"group":"group 3"},{"x":9.8043,"y":319.1399,"group":"group 3"},{"x":2.8721,"y":49.3395,"group":"group 3"},{"x":3.3976,"y":87.7651,"group":"group 3"},{"x":4.47,"y":11.1668,"group":"group 3"},{"x":3.9763,"y":-15.6589,"group":"group 1"},{"x":8.5428,"y":286.6512,"group":"group 1"},{"x":3.4216,"y":-124.64,"group":"group 1"},{"x":8.9911,"y":321.5405,"group":"group 3"},{"x":7.1585,"y":131.6969,"group":"group 2"},{"x":7.0122,"y":-68.1653,"group":"group 3"},{"x":2.2071,"y":44.5339,"group":"group 1"},{"x":9.7588,"y":438.0447,"group":"group 1"},{"x":1.2664,"y":95.9676,"group":"group 1"},{"x":9.2812,"y":331.087,"group":"group 3"},{"x":2.3052,"y":46.5407,"group":"group 3"},{"x":2.4608,"y":23.8457,"group":"group 3"},{"x":0.2891,"y":25.7934,"group":"group 1"},{"x":3.3245,"y":56.4275,"group":"group 3"},{"x":5.8135,"y":-49.7549,"group":"group 1"},{"x":9.5449,"y":215.0457,"group":"group 2"},{"x":1.4164,"y":-120.7456,"group":"group 1"},{"x":0.6033,"y":61.6902,"group":"group 2"},{"x":8.0546,"y":224.7372,"group":"group 3"},{"x":6.2452,"y":85.4793,"group":"group 2"},{"x":3.3723,"y":77.469,"group":"group 1"},{"x":1.7887,"y":119.6445,"group":"group 3"},{"x":4.53,"y":-163.0268,"group":"group 3"},{"x":3.5026,"y":-29.8607,"group":"group 2"},{"x":6.4849,"y":11.0135,"group":"group 1"},{"x":0.2267,"y":-12.4616,"group":"group 2"},{"x":7.2663,"y":300.781,"group":"group 1"},{"x":6.7476,"y":136.2889,"group":"group 1"},{"x":3.4896,"y":31.8303,"group":"group 3"},{"x":8.521,"y":102.1098,"group":"group 1"},{"x":9.3644,"y":395.9214,"group":"group 2"},{"x":9.1987,"y":324.0033,"group":"group 3"},{"x":6.8369,"y":88.927,"group":"group 2"},{"x":7.9752,"y":170.2847,"group":"group 2"},{"x":1.7961,"y":-133.8498,"group":"group 2"},{"x":1.8253,"y":120.3341,"group":"group 1"},{"x":0.1937,"y":-37.6029,"group":"group 2"},{"x":1.2099,"y":33.9112,"group":"group 1"},{"x":9.5276,"y":281.3459,"group":"group 1"},{"x":3.8894,"y":-140.4403,"group":"group 1"},{"x":7.9865,"y":273.7126,"group":"group 1"},{"x":9.9055,"y":449.6412,"group":"group 1"},{"x":7.3889,"y":51.6563,"group":"group 2"},{"x":2.8599,"y":-108.7749,"group":"group 1"},{"x":5.2919,"y":210.8894,"group":"group 1"},{"x":8.2443,"y":-6.8399,"group":"group 2"},{"x":7.4455,"y":-5.8202,"group":"group 1"},{"x":3.897,"y":-23.38,"group":"group 3"},{"x":9.6165,"y":288.7471,"group":"group 1"},{"x":1.982,"y":43.6317,"group":"group 2"},{"x":2.1163,"y":11.6306,"group":"group 2"},{"x":4.1673,"y":56.837,"group":"group 3"},{"x":6.6848,"y":119.7514,"group":"group 3"},{"x":2.364,"y":134.9852,"group":"group 1"},{"x":3.1599,"y":50.8393,"group":"group 3"},{"x":6.4927,"y":117.3681,"group":"group 2"},{"x":2.3558,"y":-48.6172,"group":"group 1"},{"x":1.7852,"y":-117.9352,"group":"group 2"},{"x":9.6859,"y":317.2011,"group":"group 2"},{"x":1.1687,"y":-91.3673,"group":"group 2"},{"x":8.0924,"y":217.1138,"group":"group 1"},{"x":4.0783,"y":-9.9377,"group":"group 1"},{"x":6.6594,"y":62.0367,"group":"group 3"},{"x":5.4779,"y":91.7995,"group":"group 1"},{"x":7.3773,"y":104.6777,"group":"group 3"},{"x":0.5934,"y":-20.451,"group":"group 3"},{"x":7.0514,"y":261.323,"group":"group 1"},{"x":0.7349,"y":6.9692,"group":"group 1"},{"x":0.3448,"y":25.1982,"group":"group 2"},{"x":8.5654,"y":215.6046,"group":"group 1"},{"x":3.7633,"y":-75.9123,"group":"group 3"},{"x":9.6972,"y":369.6588,"group":"group 3"},{"x":1.0177,"y":37.1078,"group":"group 1"},{"x":2.7416,"y":-33.9887,"group":"group 2"},{"x":0.4748,"y":-46.0242,"group":"group 3"},{"x":5.7443,"y":17.0649,"group":"group 3"},{"x":4.9885,"y":75.8367,"group":"group 2"},{"x":1.3542,"y":-59.4089,"group":"group 1"},{"x":1.3693,"y":22.4429,"group":"group 1"},{"x":8.8599,"y":271.7314,"group":"group 3"},{"x":5.0029,"y":39.1787,"group":"group 1"},{"x":0.0889,"y":-42.3577,"group":"group 1"},{"x":7.019,"y":97.6189,"group":"group 1"},{"x":0.5129,"y":93.0624,"group":"group 3"},{"x":2.655,"y":84.7639,"group":"group 2"},{"x":7.7447,"y":253.7266,"group":"group 2"},{"x":3.4043,"y":271.0826,"group":"group 3"},{"x":7.3663,"y":174.043,"group":"group 3"},{"x":3.7694,"y":-24.4581,"group":"group 3"},{"x":5.8243,"y":249.9328,"group":"group 2"},{"x":1.877,"y":84.5509,"group":"group 2"},{"x":6.6279,"y":37.8656,"group":"group 1"},{"x":8.9686,"y":150.5053,"group":"group 1"},{"x":6.1922,"y":41.8634,"group":"group 3"},{"x":1.4372,"y":-17.4027,"group":"group 2"},{"x":8.5225,"y":96.7568,"group":"group 1"},{"x":1.2763,"y":-108.92,"group":"group 2"},{"x":6.2402,"y":-28.7498,"group":"group 2"},{"x":4.8574,"y":160.4265,"group":"group 1"},{"x":3.4303,"y":109.6857,"group":"group 2"},{"x":8.1934,"y":209.2107,"group":"group 3"},{"x":2.1426,"y":94.1387,"group":"group 2"},{"x":7.7039,"y":196.2761,"group":"group 2"},{"x":0.196,"y":-51.8056,"group":"group 2"},{"x":4.515,"y":10.5938,"group":"group 3"},{"x":5.8028,"y":95.4305,"group":"group 3"},{"x":7.4773,"y":230.408,"group":"group 2"},{"x":8.7609,"y":321.1386,"group":"group 2"},{"x":7.384,"y":164.7916,"group":"group 2"},{"x":0.1706,"y":-76.3608,"group":"group 1"},{"x":2.4607,"y":-106.9769,"group":"group 2"},{"x":0.6406,"y":-5.7823,"group":"group 3"},{"x":3.8167,"y":33.9065,"group":"group 1"},{"x":5.3691,"y":124.5268,"group":"group 3"},{"x":6.2583,"y":-107.0669,"group":"group 2"},{"x":5.1409,"y":-44.1548,"group":"group 2"},{"x":7.9966,"y":265.5993,"group":"group 2"},{"x":4.2358,"y":56.1732,"group":"group 1"},{"x":0.6275,"y":13.9726,"group":"group 2"},{"x":9.6943,"y":379.2005,"group":"group 2"},{"x":2.9389,"y":-103.5493,"group":"group 1"},{"x":1.3321,"y":55.7926,"group":"group 2"},{"x":4.0997,"y":-146.8903,"group":"group 1"},{"x":4.1223,"y":-30.5411,"group":"group 2"},{"x":5.3638,"y":67.4707,"group":"group 2"},{"x":6.4429,"y":-22.6996,"group":"group 3"},{"x":7.4175,"y":88.4285,"group":"group 2"},{"x":4.9691,"y":96.746,"group":"group 1"},{"x":9.444,"y":522.5827,"group":"group 3"},{"x":0.0787,"y":-86.0131,"group":"group 2"},{"x":7.3983,"y":163.6932,"group":"group 3"},{"x":0.9738,"y":-32.622,"group":"group 1"},{"x":2.0117,"y":62.694,"group":"group 3"},{"x":8.9314,"y":181.251,"group":"group 3"},{"x":8.6709,"y":261.2493,"group":"group 2"},{"x":4.3494,"y":177.5067,"group":"group 3"},{"x":0.302,"y":82.8831,"group":"group 1"},{"x":7.2211,"y":24.1182,"group":"group 3"},{"x":0.5551,"y":-10.5036,"group":"group 1"},{"x":9.2727,"y":412.9749,"group":"group 2"},{"x":1.602,"y":32.5634,"group":"group 2"},{"x":6.3718,"y":93.8475,"group":"group 2"},{"x":7.6208,"y":183.6829,"group":"group 1"},{"x":8.3324,"y":91.624,"group":"group 3"},{"x":8.7874,"y":217.3783,"group":"group 3"},{"x":7.2202,"y":214.825,"group":"group 2"},{"x":5.9268,"y":66.5843,"group":"group 3"},{"x":7.357,"y":201.2352,"group":"group 3"},{"x":9.3087,"y":235.8074,"group":"group 2"},{"x":8.848,"y":232.0066,"group":"group 3"},{"x":1.6598,"y":-50.8751,"group":"group 1"},{"x":0.2255,"y":106.9894,"group":"group 1"},{"x":0.5187,"y":-58.1456,"group":"group 1"},{"x":5.6289,"y":51.7196,"group":"group 3"},{"x":1.0537,"y":122.2984,"group":"group 3"},{"x":7.4777,"y":92.8693,"group":"group 3"},{"x":4.8779,"y":-114.9191,"group":"group 2"},{"x":6.1114,"y":-22.1277,"group":"group 3"},{"x":0.5307,"y":-131.5242,"group":"group 1"},{"x":7.2106,"y":96.6063,"group":"group 1"},{"x":7.1739,"y":21.8286,"group":"group 2"},{"x":8.492,"y":318.424,"group":"group 2"},{"x":8.3653,"y":34.9211,"group":"group 1"},{"x":8.1259,"y":58.9254,"group":"group 1"},{"x":0.0482,"y":-44.2728,"group":"group 3"},{"x":4.8662,"y":111.1049,"group":"group 3"},{"x":3.8449,"y":-15.4679,"group":"group 1"},{"x":7.6082,"y":84.8935,"group":"group 1"},{"x":6.4373,"y":41.8313,"group":"group 2"},{"x":6.6963,"y":-52.0224,"group":"group 3"},{"x":6.3862,"y":51.8024,"group":"group 1"},{"x":1.1666,"y":61.0405,"group":"group 3"},{"x":7.4757,"y":49.0877,"group":"group 2"},{"x":7.2112,"y":169.9559,"group":"group 1"},{"x":4.2844,"y":6.4988,"group":"group 1"},{"x":4.7154,"y":108.0841,"group":"group 3"},{"x":9.1437,"y":16.6275,"group":"group 1"},{"x":1.4207,"y":-10.5385,"group":"group 2"},{"x":7.4078,"y":98.1505,"group":"group 2"},{"x":0.5262,"y":-24.0173,"group":"group 3"},{"x":8.1222,"y":240.1396,"group":"group 2"},{"x":1.7939,"y":0.4483,"group":"group 1"},{"x":5.4771,"y":47.2777,"group":"group 1"},{"x":8.9684,"y":295.3535,"group":"group 3"},{"x":1.5892,"y":-96.7203,"group":"group 2"},{"x":1.5657,"y":41.5314,"group":"group 1"},{"x":7.1095,"y":68.3132,"group":"group 3"},{"x":5.1799,"y":5.2047,"group":"group 2"},{"x":7.3003,"y":68.3774,"group":"group 2"},{"x":6.2356,"y":168.2493,"group":"group 2"},{"x":6.3951,"y":187.3077,"group":"group 1"},{"x":2.842,"y":-39.6665,"group":"group 3"},{"x":9.4297,"y":310.6399,"group":"group 3"},{"x":4.1883,"y":11.1233,"group":"group 2"},{"x":0.6353,"y":-41.3994,"group":"group 3"},{"x":3.3322,"y":-6.8022,"group":"group 1"},{"x":5.7091,"y":15.1244,"group":"group 1"},{"x":4.1899,"y":26.1351,"group":"group 3"},{"x":6.2648,"y":-36.3866,"group":"group 1"},{"x":1.9341,"y":-27.113,"group":"group 1"},{"x":1.6477,"y":190.1571,"group":"group 1"},{"x":5.8519,"y":197.5546,"group":"group 1"},{"x":6.5168,"y":132.0009,"group":"group 2"},{"x":9.6932,"y":351.1546,"group":"group 1"},{"x":0.621,"y":31.4603,"group":"group 1"},{"x":7.0623,"y":5.7497,"group":"group 1"},{"x":6.9667,"y":-51.6351,"group":"group 1"},{"x":9.6772,"y":223.5206,"group":"group 2"},{"x":4.8919,"y":-89.5423,"group":"group 2"},{"x":2.5114,"y":-11.0649,"group":"group 1"},{"x":8.1136,"y":163.15,"group":"group 3"},{"x":6.0905,"y":129.3188,"group":"group 1"},{"x":9.0442,"y":211.2835,"group":"group 1"},{"x":9.0681,"y":363.1816,"group":"group 2"},{"x":2.8817,"y":112.0016,"group":"group 1"},{"x":6.7422,"y":248.9755,"group":"group 1"},{"x":0.4919,"y":-147.9229,"group":"group 3"},{"x":8.2198,"y":237.4773,"group":"group 2"},{"x":9.7299,"y":409.5702,"group":"group 3"},{"x":8.3489,"y":306.6612,"group":"group 3"},{"x":7.128,"y":141.3842,"group":"group 1"},{"x":6.2648,"y":-24.5875,"group":"group 2"},{"x":5.3288,"y":58.1941,"group":"group 2"},{"x":1.9774,"y":-3.8462,"group":"group 1"},{"x":9.1157,"y":328.2566,"group":"group 1"},{"x":1.7326,"y":107.8332,"group":"group 2"},{"x":3.6379,"y":-94.9063,"group":"group 1"},{"x":2.4303,"y":-165.8963,"group":"group 3"},{"x":4.5302,"y":44.2512,"group":"group 3"},{"x":3.8343,"y":-23.612,"group":"group 2"},{"x":0.913,"y":-25.1485,"group":"group 3"},{"x":8.1009,"y":224.9611,"group":"group 3"},{"x":6.0349,"y":109.5476,"group":"group 3"},{"x":1.9984,"y":-0.0645,"group":"group 2"},{"x":5.6458,"y":86.8436,"group":"group 1"},{"x":4.3573,"y":-10.9692,"group":"group 2"},{"x":2.0686,"y":67.9848,"group":"group 1"},{"x":9.5519,"y":299.7076,"group":"group 2"},{"x":4.1628,"y":-117.9255,"group":"group 2"},{"x":3.6547,"y":91.9585,"group":"group 1"},{"x":7.3324,"y":104.3211,"group":"group 3"},{"x":1.1655,"y":67.5844,"group":"group 3"},{"x":3.2638,"y":-0.2999,"group":"group 3"},{"x":7.7356,"y":242.0796,"group":"group 2"},{"x":0.1205,"y":-0.3181,"group":"group 1"},{"x":0.7401,"y":77.1806,"group":"group 3"},{"x":6.3489,"y":128.6805,"group":"group 2"},{"x":4.4236,"y":29.6556,"group":"group 2"},{"x":4.706,"y":86.6746,"group":"group 1"},{"x":5.6694,"y":0.3054,"group":"group 3"},{"x":6.1571,"y":160.8113,"group":"group 2"},{"x":4.2243,"y":147.3512,"group":"group 3"},{"x":3.5366,"y":-78.9025,"group":"group 3"},{"x":2.2574,"y":26.903,"group":"group 1"},{"x":3.3248,"y":-74.6931,"group":"group 1"},{"x":6.5148,"y":-124.9328,"group":"group 1"},{"x":1.3931,"y":44.7838,"group":"group 2"},{"x":0.1451,"y":-18.8328,"group":"group 3"},{"x":7.4748,"y":103.7667,"group":"group 2"},{"x":3.5869,"y":-26.5013,"group":"group 2"},{"x":3.0504,"y":153.1036,"group":"group 2"},{"x":9.6117,"y":368.6962,"group":"group 1"},{"x":7.9583,"y":90.9688,"group":"group 1"},{"x":9.5536,"y":223.1353,"group":"group 2"},{"x":7.5093,"y":168.6467,"group":"group 3"},{"x":2.5876,"y":141.129,"group":"group 2"},{"x":5.6255,"y":108.9748,"group":"group 2"},{"x":5.8388,"y":101.5192,"group":"group 3"},{"x":4.6063,"y":72.7047,"group":"group 1"},{"x":8.9903,"y":179.1244,"group":"group 1"},{"x":8.0034,"y":251.3097,"group":"group 3"},{"x":3.2608,"y":159.631,"group":"group 2"},{"x":3.8639,"y":-77.2821,"group":"group 2"},{"x":8.4798,"y":392.8968,"group":"group 1"},{"x":5.5356,"y":-41.023,"group":"group 1"},{"x":3.643,"y":-37.248,"group":"group 1"},{"x":7.8438,"y":76.5035,"group":"group 2"},{"x":0.7819,"y":-35.5634,"group":"group 3"},{"x":0.4866,"y":-63.2671,"group":"group 2"},{"x":3.2278,"y":4.3211,"group":"group 3"},{"x":0.9122,"y":46.9033,"group":"group 2"},{"x":9.965,"y":360.2133,"group":"group 3"}];
    </script>
<p>Now our data is inside our page’s javascript scope and ready to be played with!</p>
</div>
<div id="drawing-pretty-pictures" class="section level2">
<h2>Drawing pretty pictures</h2>
<p>Let’s make a super simple d3 scatter plot to see this randomly generated data. All I have to do is include my desired javascript libraries, make a <code>div</code> element for my visualization to go into and then put my <code>{js}</code> block in. RMarkdown will slot the javascript into the page and we’re good to go.</p>
<p>In this example I did…</p>
<pre><code>&lt;script src=&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://d3js.org/d3.v4.min.js&quot;&gt;&lt;/script&gt;

&lt;div id = &quot;viz&quot;&gt;&lt;/div&gt; 

` ` `{js}
//code goes here
` ` `</code></pre>
</div>
<div id="did-it-work" class="section level2">
<h2>Did it work?</h2>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<div id="viz">

</div>
<script type="text/javascript">
var point_vals = d3.select("#viz").append("p").text("Mouseover some data!");

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $("#did-it-work").width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d => d.x);
var y_extent = d3.extent(data, d => d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select("#viz").append("svg")
    .attr("width", width + 2*margin)
    .attr("height", height + 2*margin)
  .append("g")
    .attr("transform",
          "translate(" + margin + "," + margin + ")");

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(".dots")
    .data(data)
  .enter().append("circle")
    .attr("class", "dots")
    .attr("fill", d => d.group === "group 1"? "steelblue":"orangered")
    .attr("fill-opacity", 0.3)
    .attr("r", 5)
    .attr("cx", d => x(d.x) )
    .attr("cy", d => y(d.y) )
    .on("mouseover", function(d){
       d3.selectAll(".dots").attr("r", 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr("r", 10);
      
       point_vals.text("X:" + d.x + " Y:" + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append("g")
    .call(d3.axisLeft(y));
</script>
</div>
<div id="why-when" class="section level2">
<h2>Why/ When</h2>
<p>This is a bad example of a visualization for this scenario as something like plotly could do this in much less effort. If you’re doing something more complicated/ bespoke then this is a great resource to have.</p>
</div>
<div id="addendum" class="section level2">
<h2>Addendum</h2>
<p>If you’re interested, here’s the javascript code I included to make the above graph.</p>
<pre><code>var point_vals = d3.select(&quot;#viz&quot;).append(&quot;p&quot;).text(&quot;Mouseover some data!&quot;);

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $(&quot;#did-it-work&quot;).width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d =&gt; d.x);
var y_extent = d3.extent(data, d =&gt; d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select(&quot;#viz&quot;).append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width + 2*margin)
    .attr(&quot;height&quot;, height + 2*margin)
  .append(&quot;g&quot;)
    .attr(&quot;transform&quot;,
          &quot;translate(&quot; + margin + &quot;,&quot; + margin + &quot;)&quot;);

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(&quot;.dots&quot;)
    .data(data)
  .enter().append(&quot;circle&quot;)
    .attr(&quot;class&quot;, &quot;dots&quot;)
    .attr(&quot;fill&quot;, d =&gt; d.group === &quot;group 1&quot;? &quot;steelblue&quot;:&quot;orangered&quot;)
    .attr(&quot;fill-opacity&quot;, 0.3)
    .attr(&quot;r&quot;, 5)
    .attr(&quot;cx&quot;, d =&gt; x(d.x) )
    .attr(&quot;cy&quot;, d =&gt; y(d.y) )
    .on(&quot;mouseover&quot;, function(d){
       d3.selectAll(&quot;.dots&quot;).attr(&quot;r&quot;, 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr(&quot;r&quot;, 10);
      
       point_vals.text(&quot;X:&quot; + d.x + &quot; Y:&quot; + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append(&quot;g&quot;)
    .attr(&quot;transform&quot;, &quot;translate(0,&quot; + height + &quot;)&quot;)
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append(&quot;g&quot;)
    .call(d3.axisLeft(y));</code></pre>
</div>




    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="../../../../" style="background-image: url(/images/logo.png)"><span class="hidden">'s Picture</span></a>
    </figure>
    

    








<div class="post-author">

    <img style = "border-radius: 25px;" src="https://avatars0.githubusercontent.com/u/6764693?v=3&amp;u=c9c491a636605fe3d6122defb43eb367b3d9381f&amp;s=400" alt="Nick Strayer image" width="90" height="90">
    <br>
    <span style="font-size: 1.02em;font-weight: bold;">
        Nick Strayer
    </span>
    |
    <a style = "text-decoration: none;" class = "post-author__text" href = http://nickstrayer.me >
        <img style="width:20px;" src = "http://image.flaticon.com/icons/png/128/12/12195.png"/>
    </a>

    <a class="icon-twitter post-author__text" style="font-size: 1.4em; text-decoration: none;" href = https://twitter.com/NicholasStrayer onclick="window.open(this.href"></a>

    <a style = "text-decoration: none;" class = "post-author__text" href = https://github.com/nstrayer >
        <img style="width:23px;" src = "https://a248.e.akamai.net/assets.github.com/images/icons/emoji/octocat.png"/>
    </a>


    <br>

    <p class="post-author__text">Randomly walking my way though a career in statistics</p>
    


    
<section class="share">
  <p style="font-size: 1em; font-weight:bold;">Share this post <a class="icon-twitter" style="font-size: 1.1em" href="https://twitter.com/share?text=Custom%20JS%20Visualizations%20in%20RMarkdown%20Documents&nbsp;-&nbsp;Live%20Free%20or%20Dichotomize&amp;url=https://livefreeordichotomize.com%2f2017%2f01%2f24%2fcustom-js-visualizations-in-rmarkdown-documents%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
 </a></p>
</section>



    




  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Live Free or Dichotomize</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="../../../../js/jquery.js"></script>
    <script type="text/javascript" src="../../../../js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="../../../../js/index.js"></script>
    
</body>
</html>

