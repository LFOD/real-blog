<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Custom JavaScript visualizations in RMarkdown"/>
<meta name="twitter:description" content="I happened to stumble upon the preview release page for RStudio recently and noticed something that made me exorbitantly happy.
 A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…
 “Support for JavaScript and CSS chunks in R Notebooks”! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting."/>



  	<meta property="og:title" content=" Custom JavaScript visualizations in RMarkdown &middot;  Live Free or Dichotomize" />
  	<meta property="og:site_name" content="Live Free or Dichotomize" />
  	<meta property="og:url" content="/2017/01/24/custom-javascript-visualizations-in-rmarkdown/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2017-01-24T10:54:24&#43;02:00" />

    
    <meta property="og:article:tag" content="javascript" />
    
    <meta property="og:article:tag" content="visualization" />
    
    

    <title>
       Custom JavaScript visualizations in RMarkdown &middot;  Live Free or Dichotomize
    </title>

    <meta name="description" content="A statistics blog from two goofy Phd students." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../../../../images/favicon.ico">
	  <link rel="apple-touch-icon" href="../../../../images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="../../../../css/screen.css" />
    <link rel="stylesheet" type="text/css" href="../../../../css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />

    
      
          <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="Live Free or Dichotomize" />
      
      
    
    <meta name="generator" content="Hugo 0.17" />

    <link rel="canonical" href="../../../../2017/01/24/custom-javascript-visualizations-in-rmarkdown/" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92165973-1', 'auto');
  ga('send', 'pageview');

</script>

    






</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="../../../../about/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/lfod/real-blog">GitHub</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/LucyStats">Lucy&#39;s Twitter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/NicholasStrayer">Nick&#39;s Twitter</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="../../../../index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="../../../../"><img src="../../../../images/logo.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Custom JavaScript visualizations in RMarkdown</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-01-24T10:54:24&#43;02:00">
            Jan 24, 2017
          </time>
        
         
          <span class="post-tag small"><a href="../../../../tags/javascript/">#javascript</a></span>
         
          <span class="post-tag small"><a href="../../../../tags/visualization/">#visualization</a></span>
         
        </section>
    </header>

    <section class="post-content">


<p><br></p>
<p>I happened to stumble upon the <a href="https://www.rstudio.com/products/rstudio/download/preview/">preview release page</a> for RStudio recently and noticed something that made me exorbitantly happy.</p>
<blockquote>
<p>A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…</p>
</blockquote>
<p><em>“Support for JavaScript and CSS chunks in R Notebooks”</em>! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting. Previously my workflow for generating an interactive graphic would be something like:</p>
<ul>
<li>Download data</li>
<li>Clean data and do preliminary visualization in R</li>
<li>Export what I liked to a csv file and make a new directory with a set of <code>.html, .js, .css</code> files in it.</li>
<li>Load data into javascript/d3.js in the new javascript file.</li>
<li>Plot.</li>
</ul>
<p>This workflow has served me very well, I did it probably 20 times a day when working at the New York Times and I am very fast with it. If you want to just make a stand alone visualization it’s fantastic, however, as a biostatistician who works with a lot of other biostatisticians, people tend to want to see where the data comes from.</p>
<p>With Javascript chunks in <code>.Rmd</code> files you can explicitly show the code for data gathering/cleaning etc. in a language that your collaborators can understand, along with making custom d3 charts with that data. All without ever leaving RStudio. I will show you my quick and dirty solution to doing so.</p>
<div id="getting-data-into-javascript" class="section level2">
<h2>Getting data into Javascript</h2>
<p>Instead of generating a csv file in R and then loading that into javascript we will instead send the data directly through the html to javascript. (<em>Note:</em> This wont work well with super large data).</p>
<p>Inspired by <a href="https://medium.com/@becausealice2/getting-r-and-d3-js-to-play-nicely-in-r-markdown-270e302a52d3#.772g93eb3">this</a> medium post I wrote a little function that takes a dataframe and sends it to the html document in the <code>.json</code> format.</p>
<pre class="r"><code>library(tidyverse)
library(jsonlite)

send_df_to_js &lt;- function(df){
  cat(
    paste(
    &#39;&lt;script&gt;
      var data = &#39;,toJSON(df),&#39;;
    &lt;/script&gt;&#39;
    , sep=&quot;&quot;)
  )
}</code></pre>
<p>To illustrate how it works we will generate some random data into a dataframe.</p>
<pre class="r"><code>#Generate some random x and y data to plot
n &lt;- 300
random_data &lt;- data_frame(x = runif(n)*10) %&gt;% 
  mutate(y = 0.5*x^3 - 1.3*x^2 + rnorm(n, mean = 0, sd = 80),
         group = paste(&quot;group&quot;, sample(c(1,2,3), n, replace = T)))</code></pre>
<p>Now we send a snippit of the dataframe into the function to see the output…</p>
<pre class="r"><code>random_data %&gt;% 
  head() %&gt;% 
  send_df_to_js()</code></pre>
<pre><code>## &lt;script&gt;
##       var data = [{&quot;x&quot;:5.1162,&quot;y&quot;:-46.3068,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:0.4562,&quot;y&quot;:31.2804,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:0.6782,&quot;y&quot;:-52.6119,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:5.2959,&quot;y&quot;:-52.3112,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:4.6645,&quot;y&quot;:-13.5448,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:7.4817,&quot;y&quot;:207.7494,&quot;group&quot;:&quot;group 2&quot;}];
##     &lt;/script&gt;</code></pre>
<p>Beautiful, we have our data, in <code>json</code> format, wrapped in a script tag. Now we can send the whole dataframe through. This time I am using the <code>results = &quot;asis&quot;</code> option in the code chunk (<code>{r, results = &quot;asis&quot;}</code>), to write the results directly to the html document and not to the output like we did above.</p>
<pre class="r"><code>#Initiate data transfer protocol one
send_df_to_js(random_data)</code></pre>
<script>
      var data = [{"x":5.1162,"y":-46.3068,"group":"group 3"},{"x":0.4562,"y":31.2804,"group":"group 1"},{"x":0.6782,"y":-52.6119,"group":"group 1"},{"x":5.2959,"y":-52.3112,"group":"group 1"},{"x":4.6645,"y":-13.5448,"group":"group 2"},{"x":7.4817,"y":207.7494,"group":"group 2"},{"x":8.6461,"y":242.1554,"group":"group 1"},{"x":9.1827,"y":243.1479,"group":"group 3"},{"x":6.8721,"y":-25.7041,"group":"group 2"},{"x":6.0867,"y":54.8649,"group":"group 2"},{"x":5.2067,"y":-34.2949,"group":"group 2"},{"x":8.1715,"y":-5.4236,"group":"group 1"},{"x":4.4607,"y":-63.0038,"group":"group 1"},{"x":6.3942,"y":215.4326,"group":"group 2"},{"x":3.6244,"y":39.3995,"group":"group 1"},{"x":7.7061,"y":262.1096,"group":"group 2"},{"x":9.4833,"y":270.042,"group":"group 3"},{"x":3.6655,"y":-19.4778,"group":"group 2"},{"x":6.5462,"y":307.3679,"group":"group 2"},{"x":7.4608,"y":64.5969,"group":"group 3"},{"x":5.3925,"y":-108.9362,"group":"group 1"},{"x":6.7787,"y":100.5908,"group":"group 2"},{"x":6.6139,"y":75.6255,"group":"group 1"},{"x":3.163,"y":-41.5343,"group":"group 2"},{"x":3.5193,"y":-47.1199,"group":"group 1"},{"x":6.0488,"y":84.613,"group":"group 1"},{"x":7.4606,"y":247.5339,"group":"group 2"},{"x":6.6448,"y":117.4448,"group":"group 2"},{"x":8.4995,"y":85.4425,"group":"group 1"},{"x":4.3691,"y":70.055,"group":"group 3"},{"x":6.0521,"y":7.6063,"group":"group 1"},{"x":4.8037,"y":-43.927,"group":"group 3"},{"x":1.2511,"y":-42.2995,"group":"group 2"},{"x":5.1001,"y":-123.782,"group":"group 3"},{"x":0.9715,"y":22.3899,"group":"group 3"},{"x":6.7808,"y":138.0596,"group":"group 1"},{"x":5.3929,"y":-165.7388,"group":"group 3"},{"x":3.4279,"y":-19.5501,"group":"group 1"},{"x":2.1678,"y":48.3077,"group":"group 2"},{"x":4.4743,"y":22.5522,"group":"group 2"},{"x":8.2214,"y":290.4805,"group":"group 1"},{"x":3.9358,"y":-60.7383,"group":"group 2"},{"x":6.1277,"y":15.448,"group":"group 1"},{"x":3.9072,"y":-119.466,"group":"group 1"},{"x":3.4609,"y":-39.2849,"group":"group 2"},{"x":8.4668,"y":223.8005,"group":"group 3"},{"x":0.0533,"y":-77.297,"group":"group 2"},{"x":6.0043,"y":42.9101,"group":"group 1"},{"x":3.7075,"y":88.6548,"group":"group 3"},{"x":3.3836,"y":48.3493,"group":"group 2"},{"x":9.619,"y":430.2209,"group":"group 2"},{"x":0.6508,"y":28.3045,"group":"group 2"},{"x":3.0408,"y":79.8333,"group":"group 1"},{"x":2.5639,"y":-88.0993,"group":"group 1"},{"x":4.277,"y":-43.882,"group":"group 1"},{"x":3.4519,"y":-0.9631,"group":"group 3"},{"x":5.4183,"y":80.6461,"group":"group 3"},{"x":6.2418,"y":198.2431,"group":"group 1"},{"x":5.6723,"y":6.9054,"group":"group 1"},{"x":3.8555,"y":-117.3536,"group":"group 3"},{"x":4.7856,"y":70.3984,"group":"group 1"},{"x":5.1317,"y":28.0247,"group":"group 1"},{"x":7.6522,"y":135.6824,"group":"group 1"},{"x":4.2312,"y":-13.2611,"group":"group 1"},{"x":4.4467,"y":81.388,"group":"group 3"},{"x":0.175,"y":79.4935,"group":"group 2"},{"x":1.8265,"y":38.6366,"group":"group 1"},{"x":3.73,"y":-37.8971,"group":"group 1"},{"x":1.1404,"y":-113.5531,"group":"group 1"},{"x":5.6023,"y":125.4496,"group":"group 2"},{"x":4.9681,"y":-52.657,"group":"group 1"},{"x":5.4185,"y":-1.6513,"group":"group 1"},{"x":1.5906,"y":8.3293,"group":"group 1"},{"x":0.7664,"y":100.697,"group":"group 1"},{"x":8.3963,"y":340.5532,"group":"group 2"},{"x":2.2874,"y":-88.8015,"group":"group 2"},{"x":4.3116,"y":-84.1783,"group":"group 2"},{"x":5.6534,"y":-44.4034,"group":"group 3"},{"x":3.9826,"y":-11.0541,"group":"group 3"},{"x":7.1342,"y":158.1202,"group":"group 3"},{"x":8.5816,"y":189.6791,"group":"group 3"},{"x":6.0555,"y":-22.2403,"group":"group 3"},{"x":3.2757,"y":-89.3256,"group":"group 2"},{"x":0.819,"y":-108.622,"group":"group 1"},{"x":5.6151,"y":34.6804,"group":"group 2"},{"x":7.6469,"y":216.9807,"group":"group 3"},{"x":3.2184,"y":-42.1577,"group":"group 1"},{"x":5.623,"y":-2.7286,"group":"group 1"},{"x":4.1259,"y":12.6585,"group":"group 3"},{"x":6.3047,"y":40.8341,"group":"group 3"},{"x":2.2116,"y":73.0117,"group":"group 1"},{"x":2.1735,"y":-4.73,"group":"group 3"},{"x":9.844,"y":290.3496,"group":"group 2"},{"x":4.4461,"y":105.0511,"group":"group 1"},{"x":7.1733,"y":13.7035,"group":"group 1"},{"x":8.0801,"y":56.336,"group":"group 1"},{"x":9.8908,"y":409.3649,"group":"group 2"},{"x":8.5326,"y":353.097,"group":"group 1"},{"x":9.298,"y":181.4813,"group":"group 1"},{"x":7.4509,"y":-3.854,"group":"group 1"},{"x":7.005,"y":71.9695,"group":"group 1"},{"x":9.321,"y":298.4871,"group":"group 3"},{"x":3.0574,"y":-25.7501,"group":"group 3"},{"x":8.6681,"y":197.3545,"group":"group 2"},{"x":1.9095,"y":-161.4897,"group":"group 1"},{"x":2.4494,"y":-29.7089,"group":"group 2"},{"x":0.8618,"y":54.0216,"group":"group 2"},{"x":3.162,"y":-2.6952,"group":"group 3"},{"x":5.9464,"y":76.2577,"group":"group 2"},{"x":9.7455,"y":361.5106,"group":"group 2"},{"x":1.5727,"y":180.6104,"group":"group 2"},{"x":5.4232,"y":17.8789,"group":"group 2"},{"x":7.8534,"y":248.7398,"group":"group 1"},{"x":7.3088,"y":5.8947,"group":"group 3"},{"x":9.1125,"y":176.996,"group":"group 1"},{"x":5.1955,"y":37.0387,"group":"group 2"},{"x":7.7867,"y":34.7644,"group":"group 1"},{"x":6.5567,"y":214.0232,"group":"group 2"},{"x":8.6813,"y":183.4559,"group":"group 3"},{"x":9.9267,"y":330.7274,"group":"group 3"},{"x":5.0922,"y":56.6162,"group":"group 1"},{"x":9.5371,"y":424.1902,"group":"group 1"},{"x":6.5304,"y":59.2615,"group":"group 2"},{"x":4.6671,"y":-75.6146,"group":"group 3"},{"x":1.338,"y":54.2503,"group":"group 2"},{"x":2.8005,"y":-137.1593,"group":"group 1"},{"x":8.1021,"y":310.452,"group":"group 1"},{"x":4.0686,"y":-76.9085,"group":"group 1"},{"x":9.5069,"y":435.8052,"group":"group 3"},{"x":0.8981,"y":16.3915,"group":"group 2"},{"x":6.0089,"y":34.1392,"group":"group 2"},{"x":7.9857,"y":252.9129,"group":"group 3"},{"x":5.0834,"y":77.2913,"group":"group 2"},{"x":1.6487,"y":-24.7351,"group":"group 3"},{"x":0.2533,"y":-15.3762,"group":"group 1"},{"x":3.9755,"y":-158.7492,"group":"group 2"},{"x":2.9926,"y":-114.2788,"group":"group 3"},{"x":7.7759,"y":125.8929,"group":"group 3"},{"x":8.4738,"y":124.4414,"group":"group 2"},{"x":1.6926,"y":0.8088,"group":"group 1"},{"x":2.4047,"y":-2.56,"group":"group 2"},{"x":5.385,"y":10.1538,"group":"group 1"},{"x":7.7676,"y":187.7514,"group":"group 2"},{"x":7.1777,"y":277.6055,"group":"group 1"},{"x":4.6257,"y":25.57,"group":"group 2"},{"x":4.5831,"y":-60.5174,"group":"group 2"},{"x":6.6702,"y":58.2409,"group":"group 2"},{"x":0.9551,"y":-18.771,"group":"group 1"},{"x":9.9645,"y":302.4055,"group":"group 2"},{"x":8.8456,"y":238.569,"group":"group 1"},{"x":6.6115,"y":-17.5631,"group":"group 3"},{"x":1.2592,"y":187.7402,"group":"group 2"},{"x":6.4925,"y":-153.4486,"group":"group 2"},{"x":3.2816,"y":21.2522,"group":"group 1"},{"x":8.1324,"y":284.0352,"group":"group 2"},{"x":8.4689,"y":261.5842,"group":"group 3"},{"x":8.3122,"y":246.8091,"group":"group 2"},{"x":2.0068,"y":-19.1761,"group":"group 1"},{"x":2.3861,"y":-52.5402,"group":"group 2"},{"x":9.9627,"y":332.4352,"group":"group 2"},{"x":8.3271,"y":158.4162,"group":"group 2"},{"x":3.1072,"y":28.0859,"group":"group 1"},{"x":7.0125,"y":-136.2825,"group":"group 1"},{"x":3.3936,"y":8.7578,"group":"group 2"},{"x":0.1685,"y":236.8054,"group":"group 2"},{"x":2.5478,"y":-15.6752,"group":"group 3"},{"x":9.3417,"y":338.2967,"group":"group 2"},{"x":5.9278,"y":173.5791,"group":"group 2"},{"x":8.9561,"y":181.7342,"group":"group 3"},{"x":3.4852,"y":-11.613,"group":"group 1"},{"x":2.5761,"y":-39.7009,"group":"group 1"},{"x":9.0998,"y":290.8473,"group":"group 2"},{"x":3.4737,"y":-46.942,"group":"group 2"},{"x":5.8846,"y":-88.7312,"group":"group 3"},{"x":2.0962,"y":19.2221,"group":"group 1"},{"x":4.9694,"y":91.5125,"group":"group 3"},{"x":1.0158,"y":-43.6279,"group":"group 3"},{"x":5.6557,"y":82.7064,"group":"group 2"},{"x":6.6857,"y":107.8936,"group":"group 3"},{"x":8.1807,"y":110.2859,"group":"group 2"},{"x":9.2916,"y":134.9698,"group":"group 2"},{"x":5.269,"y":1.6042,"group":"group 3"},{"x":2.4251,"y":50.5526,"group":"group 2"},{"x":0.8172,"y":111.484,"group":"group 3"},{"x":3.8882,"y":12.1427,"group":"group 2"},{"x":0.6953,"y":-37.9491,"group":"group 1"},{"x":4.4698,"y":200.7334,"group":"group 2"},{"x":5.4303,"y":-67.8519,"group":"group 3"},{"x":2.2773,"y":-61.1436,"group":"group 2"},{"x":3.3088,"y":8.2836,"group":"group 1"},{"x":4.9867,"y":94.3682,"group":"group 1"},{"x":2.9492,"y":-99.8279,"group":"group 1"},{"x":3.0981,"y":-43.3068,"group":"group 3"},{"x":6.0925,"y":2.7935,"group":"group 3"},{"x":9.0441,"y":300.0693,"group":"group 3"},{"x":7.0643,"y":179.904,"group":"group 2"},{"x":5.8729,"y":36.5852,"group":"group 3"},{"x":1.3385,"y":-18.6535,"group":"group 2"},{"x":0.8392,"y":-15.9676,"group":"group 1"},{"x":0.6391,"y":-1.1855,"group":"group 1"},{"x":4.8355,"y":-106.5904,"group":"group 1"},{"x":6.5672,"y":60.2029,"group":"group 3"},{"x":5.1639,"y":105.3537,"group":"group 2"},{"x":4.587,"y":-96.2848,"group":"group 3"},{"x":4.575,"y":84.9284,"group":"group 3"},{"x":5.5465,"y":207.0343,"group":"group 3"},{"x":0.5345,"y":-41.4268,"group":"group 2"},{"x":7.5622,"y":41.7748,"group":"group 1"},{"x":4.7998,"y":102.5952,"group":"group 2"},{"x":8.4444,"y":215.2373,"group":"group 2"},{"x":0.8389,"y":115.4963,"group":"group 3"},{"x":1.3645,"y":75.7199,"group":"group 2"},{"x":3.2798,"y":-99.2148,"group":"group 2"},{"x":4.0578,"y":-85.4269,"group":"group 3"},{"x":0.2025,"y":60.7926,"group":"group 2"},{"x":7.9982,"y":191.9102,"group":"group 3"},{"x":0.7994,"y":-15.3195,"group":"group 2"},{"x":9.4463,"y":294.906,"group":"group 1"},{"x":4.482,"y":57.0404,"group":"group 3"},{"x":3.5669,"y":-16.7005,"group":"group 1"},{"x":6.053,"y":150.1485,"group":"group 3"},{"x":7.18,"y":99.9896,"group":"group 3"},{"x":7.248,"y":267.3202,"group":"group 2"},{"x":6.9703,"y":-3.3329,"group":"group 1"},{"x":4.3059,"y":-46.1672,"group":"group 2"},{"x":4.977,"y":107.5954,"group":"group 2"},{"x":5.9616,"y":42.6722,"group":"group 2"},{"x":6.9768,"y":86.6593,"group":"group 1"},{"x":6.7877,"y":45.1433,"group":"group 1"},{"x":8.2341,"y":248.3508,"group":"group 3"},{"x":9.655,"y":355.7473,"group":"group 3"},{"x":0.8401,"y":-40.6287,"group":"group 3"},{"x":7.4414,"y":-1.6852,"group":"group 3"},{"x":1.4789,"y":68.0579,"group":"group 1"},{"x":9.3778,"y":219.3952,"group":"group 1"},{"x":7.4767,"y":25.577,"group":"group 2"},{"x":6.1874,"y":13.1916,"group":"group 1"},{"x":3.2069,"y":-117.4434,"group":"group 2"},{"x":9.4813,"y":284.5667,"group":"group 2"},{"x":5.496,"y":-19.9106,"group":"group 1"},{"x":7.4412,"y":151.1317,"group":"group 3"},{"x":7.1619,"y":248.6018,"group":"group 3"},{"x":7.3996,"y":96.7037,"group":"group 3"},{"x":7.1906,"y":26.327,"group":"group 2"},{"x":9.5213,"y":426.974,"group":"group 3"},{"x":0.2784,"y":-148.9069,"group":"group 3"},{"x":6.0756,"y":127.5393,"group":"group 2"},{"x":3.8094,"y":-49.2222,"group":"group 2"},{"x":1.2864,"y":45.4004,"group":"group 3"},{"x":8.9881,"y":256.6767,"group":"group 1"},{"x":2.371,"y":23.0363,"group":"group 3"},{"x":0.0675,"y":66.9479,"group":"group 2"},{"x":1.0431,"y":46.0385,"group":"group 1"},{"x":6.6582,"y":40.6152,"group":"group 1"},{"x":3.6342,"y":9.5917,"group":"group 2"},{"x":7.9857,"y":111.0603,"group":"group 1"},{"x":9.6027,"y":223.5836,"group":"group 1"},{"x":5.3665,"y":-32.1991,"group":"group 2"},{"x":3.0935,"y":54.6191,"group":"group 3"},{"x":5.1721,"y":171.1735,"group":"group 1"},{"x":0.9189,"y":-138.8599,"group":"group 2"},{"x":8.9064,"y":236.1688,"group":"group 1"},{"x":1.2244,"y":-121.8523,"group":"group 2"},{"x":3.0991,"y":100.0224,"group":"group 1"},{"x":1.2248,"y":-102.065,"group":"group 1"},{"x":6.499,"y":188.8823,"group":"group 2"},{"x":8.8496,"y":285.9406,"group":"group 2"},{"x":3.3164,"y":93.656,"group":"group 2"},{"x":6.5484,"y":-21.9495,"group":"group 1"},{"x":4.9479,"y":-37.8048,"group":"group 2"},{"x":9.1348,"y":315.5999,"group":"group 1"},{"x":4.8901,"y":-15.1432,"group":"group 2"},{"x":4.75,"y":43.7644,"group":"group 3"},{"x":4.8735,"y":17.6255,"group":"group 3"},{"x":9.3625,"y":385.8708,"group":"group 2"},{"x":0.2733,"y":-159.5509,"group":"group 1"},{"x":7.706,"y":207.2522,"group":"group 3"},{"x":6.0377,"y":103.6348,"group":"group 3"},{"x":4.0187,"y":10.9424,"group":"group 2"},{"x":8.1629,"y":140.2559,"group":"group 1"},{"x":6.4605,"y":45.2021,"group":"group 3"},{"x":9.0196,"y":303.9195,"group":"group 2"},{"x":8.5343,"y":188.2329,"group":"group 2"},{"x":9.5614,"y":361.3083,"group":"group 3"},{"x":6.7327,"y":85.2436,"group":"group 3"},{"x":2.7065,"y":112.9137,"group":"group 3"},{"x":5.3808,"y":188.9325,"group":"group 1"},{"x":8.3647,"y":280.9988,"group":"group 2"},{"x":2.9377,"y":-146.9444,"group":"group 3"},{"x":1.7007,"y":-5.5273,"group":"group 3"},{"x":5.5078,"y":50.9962,"group":"group 1"},{"x":7.7318,"y":25.153,"group":"group 3"},{"x":8.4938,"y":154.9252,"group":"group 1"},{"x":6.8778,"y":93.6891,"group":"group 2"},{"x":8.385,"y":139.8333,"group":"group 1"},{"x":0.8777,"y":43.9984,"group":"group 2"},{"x":3.5575,"y":4.2029,"group":"group 3"},{"x":8.9721,"y":249.6153,"group":"group 1"},{"x":5.7529,"y":22.7479,"group":"group 2"},{"x":1.5744,"y":72.9238,"group":"group 2"}];
    </script>
<p>Now our data is inside our page’s javascript scope and ready to be played with!</p>
</div>
<div id="drawing-pretty-pictures" class="section level2">
<h2>Drawing pretty pictures</h2>
<p>Let’s make a super simple d3 scatter plot to see this randomly generated data. All I have to do is include my desired javascript libraries, make a <code>div</code> element for my visualization to go into and then put my <code>{js}</code> block in. RMarkdown will slot the javascript into the page and we’re good to go.</p>
<p>In this example I did…</p>
<pre><code>&lt;script src=&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://d3js.org/d3.v4.min.js&quot;&gt;&lt;/script&gt;

&lt;div id = &quot;viz&quot;&gt;&lt;/div&gt; 

` ` `{js}
//code goes here
` ` `</code></pre>
</div>
<div id="did-it-work" class="section level2">
<h2>Did it work?</h2>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<div id="viz">

</div>
<script type="text/javascript">
var point_vals = d3.select("#viz")
  .append("p")
  .attr("align", "center")
  .text("Mouseover some data!");

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $("#did-it-work").width();
  
// set the dimensions and margins of the graph
var margin = 30,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d => d.x);
var y_extent = d3.extent(data, d => d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select("#viz").append("svg")
    .attr("width", width + 2*margin)
    .attr("height", height + 2*margin)
  .append("g")
    .attr("transform",
          "translate(" + margin + "," + margin + ")");

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(".dots")
    .data(data)
  .enter().append("circle")
    .attr("class", "dots")
    .attr("fill", d => d.group === "group 1"? "steelblue":"orangered")
    .attr("fill-opacity", 0.3)
    .attr("r", 5)
    .attr("cx", d => x(d.x) )
    .attr("cy", d => y(d.y) )
    .on("mouseover", function(d){
       d3.selectAll(".dots").attr("r", 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr("r", 10);
      
       point_vals.text("X:" + d.x + " Y:" + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append("g")
    .call(d3.axisLeft(y));
</script>
</div>
<div id="why-when" class="section level2">
<h2>Why/ When</h2>
<p>This is a bad example of a visualization for this scenario as something like plotly could do this in much less effort. If you’re doing something more complicated/ bespoke then this is a great resource to have.</p>
</div>
<div id="addendum" class="section level2">
<h2>Addendum</h2>
<p>If you’re interested, here’s the javascript code I included to make the above graph.</p>
<pre><code>var point_vals = d3.select(&quot;#viz&quot;).append(&quot;p&quot;).text(&quot;Mouseover some data!&quot;);

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $(&quot;#did-it-work&quot;).width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d =&gt; d.x);
var y_extent = d3.extent(data, d =&gt; d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select(&quot;#viz&quot;).append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width + 2*margin)
    .attr(&quot;height&quot;, height + 2*margin)
  .append(&quot;g&quot;)
    .attr(&quot;transform&quot;,
          &quot;translate(&quot; + margin + &quot;,&quot; + margin + &quot;)&quot;);

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(&quot;.dots&quot;)
    .data(data)
  .enter().append(&quot;circle&quot;)
    .attr(&quot;class&quot;, &quot;dots&quot;)
    .attr(&quot;fill&quot;, d =&gt; d.group === &quot;group 1&quot;? &quot;steelblue&quot;:&quot;orangered&quot;)
    .attr(&quot;fill-opacity&quot;, 0.3)
    .attr(&quot;r&quot;, 5)
    .attr(&quot;cx&quot;, d =&gt; x(d.x) )
    .attr(&quot;cy&quot;, d =&gt; y(d.y) )
    .on(&quot;mouseover&quot;, function(d){
       d3.selectAll(&quot;.dots&quot;).attr(&quot;r&quot;, 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr(&quot;r&quot;, 10);
      
       point_vals.text(&quot;X:&quot; + d.x + &quot; Y:&quot; + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append(&quot;g&quot;)
    .attr(&quot;transform&quot;, &quot;translate(0,&quot; + height + &quot;)&quot;)
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append(&quot;g&quot;)
    .call(d3.axisLeft(y));</code></pre>
</div>




    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="../../../../" style="background-image: url(/images/logo.png)"><span class="hidden">'s Picture</span></a>
    </figure>
    

    








<div class="post-author">

    <img style = "border-radius: 25px;" src="https://avatars0.githubusercontent.com/u/6764693?v=3&amp;u=c9c491a636605fe3d6122defb43eb367b3d9381f&amp;s=400" alt="Nick Strayer image" width="90" height="90">
    <br>
    <span style="font-size: 1.02em;font-weight: bold;">
        Nick Strayer
    </span>
    |
    <a style = "text-decoration: none;" class = "post-author__text" href = http://nickstrayer.me >
        <img style="width:20px;" src = "http://image.flaticon.com/icons/png/128/12/12195.png"/>
    </a>

    <a class="icon-twitter post-author__text" style="font-size: 1.4em; text-decoration: none;" href = https://twitter.com/NicholasStrayer onclick="window.open(this.href"></a>

    <a style = "text-decoration: none;" class = "post-author__text" href = https://github.com/nstrayer >
        <img style="width:23px;" src = "https://a248.e.akamai.net/assets.github.com/images/icons/emoji/octocat.png"/>
    </a>


    <br>

    <p class="post-author__text">Randomly walking my way though a career in statistics</p>
    


    
<section class="share">
  <p style="font-size: 1em; font-weight:bold;">Share this post <a class="icon-twitter" style="font-size: 1.1em" href="https://twitter.com/share?text=Custom%20JavaScript%20visualizations%20in%20RMarkdown&nbsp;-&nbsp;Live%20Free%20or%20Dichotomize&amp;url=https://livefreeordichotomize.com%2f2017%2f01%2f24%2fcustom-javascript-visualizations-in-rmarkdown%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
 </a></p>
</section>



    


  <div id="disqus_thread"></div>
    <script type="text/javascript">
       
      var disqus_shortname = 'livefreeordichotomize'; 
      var disqus_identifier = '\/2017\/01\/24\/custom-javascript-visualizations-in-rmarkdown\/';
       
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


      

  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Live Free or Dichotomize</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="../../../../js/jquery.js"></script>
    <script type="text/javascript" src="../../../../js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="../../../../js/index.js"></script>
        
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="../../../../js/header_lines.js"></script>

    
</body>
</html>

