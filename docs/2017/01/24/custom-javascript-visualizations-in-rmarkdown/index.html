<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Custom JavaScript Visualizations in RMarkdown"/>
<meta name="twitter:description" content="I happened to stumble upon the preview release page for RStudio recently and noticed something that made me exorbitantly happy.
 A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…
 “Support for JavaScript and CSS chunks in R Notebooks”! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting."/>



  	<meta property="og:title" content=" Custom JavaScript Visualizations in RMarkdown &middot;  Live Free or Dichotomize" />
  	<meta property="og:site_name" content="Live Free or Dichotomize" />
  	<meta property="og:url" content="/2017/01/24/custom-javascript-visualizations-in-rmarkdown/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2017-01-24T10:54:24&#43;02:00" />

    
    <meta property="og:article:tag" content="javascript" />
    
    <meta property="og:article:tag" content="visualization" />
    
    

    <title>
       Custom JavaScript Visualizations in RMarkdown &middot;  Live Free or Dichotomize
    </title>

    <meta name="description" content="A statistics blog from two goofy Phd students." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../../../../images/favicon.ico">
	  <link rel="apple-touch-icon" href="../../../../images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="../../../../css/screen.css" />
    <link rel="stylesheet" type="text/css" href="../../../../css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />

    
      
          <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="Live Free or Dichotomize" />
      
      
    
    <meta name="generator" content="Hugo 0.17" />

    <link rel="canonical" href="../../../../2017/01/24/custom-javascript-visualizations-in-rmarkdown/" />

    

    






</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="../../../../about/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/lfod/blog">GitHub</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/LucyStats">Lucy&#39;s Twitter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/NickStrayer">Nick&#39;s Twitter</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="../../../../index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="../../../../"><img src="../../../../images/logo.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Custom JavaScript Visualizations in RMarkdown</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-01-24T10:54:24&#43;02:00">
            Jan 24, 2017
          </time>
        
         
          <span class="post-tag small"><a href="../../../../tags/javascript/">#javascript</a></span>
         
          <span class="post-tag small"><a href="../../../../tags/visualization/">#visualization</a></span>
         
        </section>
    </header>

    <section class="post-content">


<p><br></p>
<p>I happened to stumble upon the <a href="https://www.rstudio.com/products/rstudio/download/preview/">preview release page</a> for RStudio recently and noticed something that made me exorbitantly happy.</p>
<blockquote>
<p>A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…</p>
</blockquote>
<p><em>“Support for JavaScript and CSS chunks in R Notebooks”</em>! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting. Previously my workflow for generating an interactive graphic would be something like:</p>
<ul>
<li>Download data</li>
<li>Clean data and do preliminary visualization in R</li>
<li>Export what I liked to a csv file and make a new directory with a set of <code>.html, .js, .css</code> files in it.</li>
<li>Load data into javascript/d3.js in the new javascript file.</li>
<li>Plot.</li>
</ul>
<p>This workflow has served me very well, I did it probably 20 times a day when working at the New York Times and I am very fast with it. If you want to just make a stand alone visualization it’s fantastic, however, as a biostatistician who works with a lot of other biostatisticians, people tend to want to see where the data comes from.</p>
<p>With Javascript chunks in <code>.Rmd</code> files you can explicitly show the code for data gathering/cleaning etc. in a language that your collaborators can understand, along with making custom d3 charts with that data. All without ever leaving RStudio. I will show you my quick and dirty solution to doing so.</p>
<div id="getting-data-into-javascript" class="section level2">
<h2>Getting data into Javascript</h2>
<p>Instead of generating a csv file in R and then loading that into javascript we will instead send the data directly through the html to javascript. (<em>Note:</em> This wont work well with super large data).</p>
<p>Inspired by <a href="https://medium.com/@becausealice2/getting-r-and-d3-js-to-play-nicely-in-r-markdown-270e302a52d3#.772g93eb3">this</a> medium post I wrote a little function that takes a dataframe and sends it to the html document in the <code>.json</code> format.</p>
<pre class="r"><code>library(tidyverse)
library(jsonlite)

send_df_to_js &lt;- function(df){
  cat(
    paste(
    &#39;&lt;script&gt;
      var data = &#39;,toJSON(df),&#39;;
    &lt;/script&gt;&#39;
    , sep=&quot;&quot;)
  )
}</code></pre>
<p>To illustrate how it works we will generate some random data into a dataframe.</p>
<pre class="r"><code>#Generate some random x and y data to plot
n &lt;- 300
random_data &lt;- data_frame(x = runif(n)*10) %&gt;% 
  mutate(y = 0.5*x^3 - 1.3*x^2 + rnorm(n, mean = 0, sd = 80),
         group = paste(&quot;group&quot;, sample(c(1,2,3), n, replace = T)))</code></pre>
<p>Now we send a snippit of the dataframe into the function to see the output…</p>
<pre class="r"><code>random_data %&gt;% 
  head() %&gt;% 
  send_df_to_js()</code></pre>
<pre><code>## &lt;script&gt;

##       var data = [{&quot;x&quot;:5.3246,&quot;y&quot;:122.9751,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:6.9045,&quot;y&quot;:117.0852,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:9.1311,&quot;y&quot;:312.7409,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:0.5559,&quot;y&quot;:-80.3896,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:4.6768,&quot;y&quot;:115.0473,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:8.9504,&quot;y&quot;:358.7016,&quot;group&quot;:&quot;group 1&quot;}];

##     &lt;/script&gt;</code></pre>
<p>Beautiful, we have our data, in <code>json</code> format, wrapped in a script tag. Now we can send the whole dataframe through. This time I am using the <code>results = &quot;asis&quot;</code> option in the code chunk (<code>{r, results = &quot;asis&quot;}</code>), to write the results directly to the html document and not to the output like we did above.</p>
<pre class="r"><code>#Initiate data transfer protocol one
send_df_to_js(random_data)</code></pre>
<script>

      var data = [{"x":5.3246,"y":122.9751,"group":"group 3"},{"x":6.9045,"y":117.0852,"group":"group 3"},{"x":9.1311,"y":312.7409,"group":"group 3"},{"x":0.5559,"y":-80.3896,"group":"group 2"},{"x":4.6768,"y":115.0473,"group":"group 2"},{"x":8.9504,"y":358.7016,"group":"group 1"},{"x":0.5246,"y":81.3299,"group":"group 1"},{"x":8.2281,"y":268.1925,"group":"group 2"},{"x":1.4149,"y":-41.1731,"group":"group 3"},{"x":5.54,"y":143.972,"group":"group 3"},{"x":1.1647,"y":37.0031,"group":"group 3"},{"x":3.3158,"y":135.4621,"group":"group 1"},{"x":4.9032,"y":-8.4533,"group":"group 3"},{"x":7.6516,"y":236.0343,"group":"group 1"},{"x":0.6352,"y":-47.6863,"group":"group 1"},{"x":0.347,"y":-78.274,"group":"group 3"},{"x":9.1726,"y":278.4247,"group":"group 1"},{"x":5.7549,"y":-36.8618,"group":"group 3"},{"x":8.3329,"y":173.7892,"group":"group 1"},{"x":9.6573,"y":229.9297,"group":"group 3"},{"x":9.2472,"y":226.8547,"group":"group 1"},{"x":3.2241,"y":40.25,"group":"group 1"},{"x":1.7978,"y":62.1342,"group":"group 1"},{"x":7.7459,"y":163.6905,"group":"group 1"},{"x":4.806,"y":46.7496,"group":"group 3"},{"x":4.2921,"y":-32.1279,"group":"group 1"},{"x":6.4041,"y":148.3842,"group":"group 2"},{"x":4.2985,"y":-79.6476,"group":"group 1"},{"x":5.9514,"y":32.9182,"group":"group 1"},{"x":8.8997,"y":156.5728,"group":"group 3"},{"x":4.1575,"y":48.6139,"group":"group 1"},{"x":6.322,"y":105.9096,"group":"group 1"},{"x":5.4353,"y":140.4947,"group":"group 2"},{"x":5.67,"y":88.9629,"group":"group 3"},{"x":2.44,"y":-116.6142,"group":"group 3"},{"x":4.0051,"y":-20.3762,"group":"group 2"},{"x":0.6199,"y":49.2831,"group":"group 1"},{"x":1.4436,"y":-7.1237,"group":"group 2"},{"x":1.3409,"y":8.648,"group":"group 3"},{"x":3.3204,"y":-47.3753,"group":"group 1"},{"x":9.6047,"y":262.2087,"group":"group 1"},{"x":5.6247,"y":135.9289,"group":"group 3"},{"x":6.4663,"y":18.038,"group":"group 1"},{"x":6.7929,"y":131.8284,"group":"group 1"},{"x":9.7533,"y":348.7937,"group":"group 3"},{"x":1.1657,"y":-31.2583,"group":"group 1"},{"x":2.4719,"y":0.5755,"group":"group 3"},{"x":0.0987,"y":27.1865,"group":"group 3"},{"x":6.4019,"y":64.5846,"group":"group 1"},{"x":3.0344,"y":-31.8217,"group":"group 1"},{"x":9.4265,"y":253.559,"group":"group 1"},{"x":9.8445,"y":350.4434,"group":"group 1"},{"x":3.3263,"y":-33.0538,"group":"group 3"},{"x":0.1795,"y":-76.3764,"group":"group 3"},{"x":9.4519,"y":368.607,"group":"group 1"},{"x":1.9674,"y":-95.1508,"group":"group 1"},{"x":0.4369,"y":42.2921,"group":"group 2"},{"x":5.7662,"y":74.4905,"group":"group 3"},{"x":1.4282,"y":72.2106,"group":"group 1"},{"x":9.9887,"y":570.7665,"group":"group 3"},{"x":1.6062,"y":134.585,"group":"group 1"},{"x":5.6791,"y":44.969,"group":"group 1"},{"x":5.3667,"y":141.2013,"group":"group 1"},{"x":9.1295,"y":330.777,"group":"group 3"},{"x":5.3193,"y":93.1751,"group":"group 1"},{"x":0.9457,"y":-89.469,"group":"group 1"},{"x":5.3694,"y":79.715,"group":"group 1"},{"x":8.0805,"y":402.3389,"group":"group 1"},{"x":1.2944,"y":75.0622,"group":"group 2"},{"x":1.3487,"y":76.9836,"group":"group 3"},{"x":3.7065,"y":23.8521,"group":"group 1"},{"x":4.8297,"y":89.6689,"group":"group 3"},{"x":8.7313,"y":219.5758,"group":"group 1"},{"x":4.9777,"y":-51.764,"group":"group 2"},{"x":9.5444,"y":294.9685,"group":"group 1"},{"x":2.1063,"y":-32.0271,"group":"group 1"},{"x":8.2599,"y":26.2432,"group":"group 1"},{"x":8.3565,"y":264.4962,"group":"group 3"},{"x":9.1629,"y":319.5783,"group":"group 2"},{"x":8.0645,"y":154.5482,"group":"group 2"},{"x":1.8642,"y":31.2401,"group":"group 2"},{"x":3.674,"y":105.4221,"group":"group 3"},{"x":7.3938,"y":147.9484,"group":"group 3"},{"x":4.0743,"y":-19.2892,"group":"group 3"},{"x":7.2136,"y":81.5937,"group":"group 2"},{"x":1.0166,"y":-63.8589,"group":"group 1"},{"x":8.4659,"y":246.4744,"group":"group 1"},{"x":6.4977,"y":133.1263,"group":"group 3"},{"x":4.9176,"y":21.684,"group":"group 3"},{"x":6.825,"y":51.2373,"group":"group 1"},{"x":0.7736,"y":108.391,"group":"group 2"},{"x":7.4246,"y":83.6941,"group":"group 3"},{"x":0.928,"y":25.9002,"group":"group 1"},{"x":3.5948,"y":-121.1263,"group":"group 3"},{"x":8.4522,"y":105.9277,"group":"group 1"},{"x":2.1362,"y":-65.6993,"group":"group 3"},{"x":9.7332,"y":401.9002,"group":"group 2"},{"x":1.5161,"y":33.9605,"group":"group 3"},{"x":6.908,"y":23.4025,"group":"group 3"},{"x":6.2322,"y":3.2443,"group":"group 1"},{"x":1.7892,"y":-48.0356,"group":"group 2"},{"x":7.6822,"y":227.5688,"group":"group 1"},{"x":0.4345,"y":-10.1115,"group":"group 2"},{"x":2.3769,"y":-32.3761,"group":"group 2"},{"x":0.8183,"y":171.8569,"group":"group 3"},{"x":2.0274,"y":-16.8817,"group":"group 1"},{"x":5.2113,"y":164.9101,"group":"group 2"},{"x":6.5784,"y":228.9128,"group":"group 1"},{"x":4.2833,"y":-114.4416,"group":"group 2"},{"x":9.9233,"y":316.8529,"group":"group 3"},{"x":3.9769,"y":-158.7767,"group":"group 2"},{"x":2.331,"y":-75.3782,"group":"group 2"},{"x":1.3182,"y":-61.5722,"group":"group 1"},{"x":7.1549,"y":-22.5933,"group":"group 3"},{"x":7.4923,"y":151.3828,"group":"group 1"},{"x":9.4205,"y":371.8337,"group":"group 2"},{"x":9.902,"y":381.4643,"group":"group 3"},{"x":6.8423,"y":75.1478,"group":"group 2"},{"x":9.4932,"y":302.1836,"group":"group 1"},{"x":4.5973,"y":41.2486,"group":"group 2"},{"x":1.4376,"y":-25.8743,"group":"group 3"},{"x":4.483,"y":69.027,"group":"group 3"},{"x":1.1771,"y":-39.215,"group":"group 3"},{"x":9.0231,"y":367.7342,"group":"group 1"},{"x":6.5235,"y":112.0805,"group":"group 3"},{"x":8.4014,"y":230.1556,"group":"group 1"},{"x":7.9127,"y":215.9403,"group":"group 1"},{"x":6.094,"y":-129.0399,"group":"group 3"},{"x":0.7952,"y":190.77,"group":"group 3"},{"x":4.6804,"y":-13.2733,"group":"group 1"},{"x":5.0176,"y":74.8469,"group":"group 1"},{"x":4.1589,"y":87.5007,"group":"group 3"},{"x":7.4437,"y":190.8078,"group":"group 2"},{"x":9.0754,"y":152.5632,"group":"group 3"},{"x":4.2248,"y":-11.4569,"group":"group 2"},{"x":2.3702,"y":6.1376,"group":"group 3"},{"x":0.3052,"y":54.6648,"group":"group 1"},{"x":8.0862,"y":58.0715,"group":"group 2"},{"x":7.0882,"y":136.7127,"group":"group 2"},{"x":8.9915,"y":301.4852,"group":"group 1"},{"x":9.5409,"y":336.1521,"group":"group 1"},{"x":0.0036,"y":94.1457,"group":"group 1"},{"x":8.4545,"y":175.5482,"group":"group 1"},{"x":1.0351,"y":-173.9266,"group":"group 3"},{"x":8.1627,"y":141.5131,"group":"group 3"},{"x":9.9213,"y":419.4031,"group":"group 2"},{"x":3.1757,"y":80.5025,"group":"group 1"},{"x":7.6407,"y":144.4288,"group":"group 1"},{"x":2.8003,"y":9.3212,"group":"group 2"},{"x":6.7569,"y":155.6762,"group":"group 2"},{"x":4.5455,"y":31.3334,"group":"group 2"},{"x":7.4925,"y":-172.9651,"group":"group 1"},{"x":9.2653,"y":208.566,"group":"group 3"},{"x":4.8271,"y":41.4729,"group":"group 2"},{"x":5.7147,"y":-34.3155,"group":"group 1"},{"x":9.8013,"y":170.1455,"group":"group 3"},{"x":5.9053,"y":87.1709,"group":"group 3"},{"x":2.2787,"y":-15.9471,"group":"group 1"},{"x":3.3303,"y":-57.8343,"group":"group 2"},{"x":6.3774,"y":63.4665,"group":"group 3"},{"x":5.8784,"y":-91.4494,"group":"group 1"},{"x":8.5112,"y":196.3263,"group":"group 2"},{"x":3.8935,"y":-27.6529,"group":"group 2"},{"x":2.2836,"y":-61.4355,"group":"group 3"},{"x":5.2976,"y":78.8222,"group":"group 1"},{"x":5.2354,"y":15.7557,"group":"group 1"},{"x":1.3225,"y":-203.978,"group":"group 2"},{"x":9.7139,"y":237.6306,"group":"group 2"},{"x":2.4091,"y":-54.2771,"group":"group 2"},{"x":1.3068,"y":-63.7316,"group":"group 2"},{"x":3.7395,"y":80.6151,"group":"group 2"},{"x":1.3802,"y":52.9383,"group":"group 2"},{"x":3.3362,"y":-73.7253,"group":"group 2"},{"x":7.0591,"y":242.5857,"group":"group 1"},{"x":4.7019,"y":104.1648,"group":"group 2"},{"x":9.5519,"y":272.453,"group":"group 3"},{"x":9.8608,"y":298.8764,"group":"group 2"},{"x":8.2083,"y":170.7973,"group":"group 2"},{"x":8.715,"y":335.6923,"group":"group 3"},{"x":6.6136,"y":110.0463,"group":"group 3"},{"x":2.3458,"y":-86.5204,"group":"group 1"},{"x":7.3092,"y":131.1848,"group":"group 2"},{"x":7.9358,"y":301.8724,"group":"group 1"},{"x":3.945,"y":-37.0052,"group":"group 1"},{"x":4.6556,"y":-24.0374,"group":"group 1"},{"x":6.4395,"y":58.5665,"group":"group 1"},{"x":4.8826,"y":-56.1356,"group":"group 3"},{"x":1.0797,"y":-67.7063,"group":"group 2"},{"x":8.7075,"y":158.7697,"group":"group 2"},{"x":4.8103,"y":1.8034,"group":"group 1"},{"x":9.8652,"y":239.6715,"group":"group 3"},{"x":7.7897,"y":100.1812,"group":"group 3"},{"x":6.6447,"y":-70.5464,"group":"group 2"},{"x":5.2032,"y":52.8343,"group":"group 3"},{"x":2.5775,"y":-150.7584,"group":"group 2"},{"x":8.951,"y":335.3193,"group":"group 3"},{"x":8.0554,"y":98.5827,"group":"group 1"},{"x":6.236,"y":-40.782,"group":"group 2"},{"x":5.5353,"y":244.9332,"group":"group 3"},{"x":6.7016,"y":-78.3954,"group":"group 2"},{"x":8.1499,"y":197.9383,"group":"group 3"},{"x":4.923,"y":43.1428,"group":"group 3"},{"x":8.5948,"y":170.5829,"group":"group 1"},{"x":3.5645,"y":44.428,"group":"group 3"},{"x":1.4186,"y":1.6758,"group":"group 1"},{"x":1.775,"y":-46.8665,"group":"group 3"},{"x":8.417,"y":248.2049,"group":"group 3"},{"x":5.3977,"y":144.749,"group":"group 3"},{"x":1.8897,"y":44.074,"group":"group 1"},{"x":9.9835,"y":421.0916,"group":"group 2"},{"x":3.9958,"y":-80.9448,"group":"group 1"},{"x":6.8299,"y":97.1437,"group":"group 1"},{"x":7.2817,"y":228.8704,"group":"group 3"},{"x":6.9195,"y":14.7402,"group":"group 1"},{"x":5.8001,"y":-50.7982,"group":"group 2"},{"x":5.1112,"y":40.8197,"group":"group 1"},{"x":9.5385,"y":347.2631,"group":"group 2"},{"x":0.0381,"y":-146.0991,"group":"group 1"},{"x":1.0492,"y":113.7027,"group":"group 2"},{"x":1.4219,"y":39.9631,"group":"group 1"},{"x":8.9282,"y":104.5879,"group":"group 1"},{"x":2.5499,"y":45.295,"group":"group 3"},{"x":5.8885,"y":65.5611,"group":"group 2"},{"x":3.782,"y":-42.2255,"group":"group 3"},{"x":4.7221,"y":9.4986,"group":"group 2"},{"x":2.3998,"y":-94.6031,"group":"group 2"},{"x":0.8903,"y":-95.9587,"group":"group 2"},{"x":3.0393,"y":-8.9664,"group":"group 1"},{"x":4.5379,"y":84.9578,"group":"group 1"},{"x":0.6506,"y":-93.9752,"group":"group 3"},{"x":3.5871,"y":52.2967,"group":"group 1"},{"x":8.3811,"y":321.3733,"group":"group 2"},{"x":8.1518,"y":277.0786,"group":"group 1"},{"x":9.5635,"y":247.9585,"group":"group 2"},{"x":2.6113,"y":-87.2377,"group":"group 2"},{"x":9.1796,"y":259.5815,"group":"group 1"},{"x":8.6927,"y":270.4065,"group":"group 1"},{"x":7.0517,"y":140.7083,"group":"group 2"},{"x":0.0372,"y":12.5547,"group":"group 1"},{"x":5.7983,"y":157.3438,"group":"group 3"},{"x":1.5242,"y":3.0352,"group":"group 2"},{"x":3.5267,"y":44.7471,"group":"group 2"},{"x":7.4289,"y":109.6324,"group":"group 1"},{"x":4.919,"y":-114.8329,"group":"group 2"},{"x":0.5297,"y":60.2061,"group":"group 2"},{"x":3.0672,"y":112.6606,"group":"group 3"},{"x":5.8853,"y":-128.3626,"group":"group 3"},{"x":5.0886,"y":-59.307,"group":"group 2"},{"x":8.3585,"y":133.429,"group":"group 1"},{"x":6.9205,"y":275.612,"group":"group 3"},{"x":6.4064,"y":25.1998,"group":"group 3"},{"x":5.1312,"y":107.9654,"group":"group 2"},{"x":1.0437,"y":47.7779,"group":"group 3"},{"x":3.447,"y":-72.1946,"group":"group 2"},{"x":8.4087,"y":307.4334,"group":"group 3"},{"x":5.1958,"y":-115.224,"group":"group 3"},{"x":5.4746,"y":77.3147,"group":"group 1"},{"x":2.6193,"y":19.4547,"group":"group 1"},{"x":7.349,"y":178.2281,"group":"group 1"},{"x":6.2897,"y":-52.1581,"group":"group 3"},{"x":4.4932,"y":14.075,"group":"group 1"},{"x":0.5929,"y":71.8845,"group":"group 1"},{"x":0.1886,"y":109.6038,"group":"group 2"},{"x":1.4635,"y":27.3066,"group":"group 3"},{"x":8.7579,"y":314.0219,"group":"group 3"},{"x":9.3203,"y":241.4621,"group":"group 2"},{"x":8.432,"y":198.5585,"group":"group 1"},{"x":0.5774,"y":-176.184,"group":"group 1"},{"x":8.1575,"y":219.6413,"group":"group 3"},{"x":8.2135,"y":114.0994,"group":"group 2"},{"x":7.1663,"y":59.9761,"group":"group 3"},{"x":4.84,"y":65.0767,"group":"group 2"},{"x":4.7534,"y":61.1269,"group":"group 3"},{"x":2.3049,"y":76.9293,"group":"group 2"},{"x":1.791,"y":100.9639,"group":"group 1"},{"x":3.3639,"y":-3.0325,"group":"group 3"},{"x":1.6077,"y":-17.1387,"group":"group 1"},{"x":2.9154,"y":56.5157,"group":"group 3"},{"x":5.0741,"y":-16.7012,"group":"group 2"},{"x":3.9286,"y":66.9978,"group":"group 3"},{"x":8.2921,"y":124.2598,"group":"group 1"},{"x":2.7871,"y":34.1566,"group":"group 2"},{"x":3.399,"y":57.5824,"group":"group 1"},{"x":3.3217,"y":150.5722,"group":"group 2"},{"x":2.954,"y":14.334,"group":"group 1"},{"x":1.7704,"y":-108.8828,"group":"group 1"},{"x":1.2289,"y":231.9883,"group":"group 1"},{"x":2.6917,"y":-92.1462,"group":"group 1"},{"x":9.2908,"y":314.0999,"group":"group 3"},{"x":5.1443,"y":-16.9593,"group":"group 1"},{"x":5.6899,"y":16.8925,"group":"group 2"},{"x":4.5404,"y":-101.0571,"group":"group 3"},{"x":8.7865,"y":382.7427,"group":"group 3"},{"x":3.4787,"y":-6.6589,"group":"group 3"},{"x":6.9529,"y":101.6804,"group":"group 2"},{"x":5.4206,"y":105.6531,"group":"group 3"},{"x":1.4375,"y":-103.2384,"group":"group 1"},{"x":1.8174,"y":-27.8235,"group":"group 2"},{"x":9.934,"y":332.6342,"group":"group 1"},{"x":2.5588,"y":-84.7316,"group":"group 1"}];

    </script>
<p>Now our data is inside our page’s javascript scope and ready to be played with!</p>
</div>
<div id="drawing-pretty-pictures" class="section level2">
<h2>Drawing pretty pictures</h2>
<p>Let’s make a super simple d3 scatter plot to see this randomly generated data. All I have to do is include my desired javascript libraries, make a <code>div</code> element for my visualization to go into and then put my <code>{js}</code> block in. RMarkdown will slot the javascript into the page and we’re good to go.</p>
<p>In this example I did…</p>
<pre><code>&lt;script src=&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://d3js.org/d3.v4.min.js&quot;&gt;&lt;/script&gt;

&lt;div id = &quot;viz&quot;&gt;&lt;/div&gt; 

` ` `{js}
//code goes here
` ` `</code></pre>
</div>
<div id="did-it-work" class="section level2">
<h2>Did it work?</h2>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<div id="viz">

</div>
<script type="text/javascript">
var point_vals = d3.select("#viz")
  .append("p")
  .attr("align", "center")
  .text("Mouseover some data!");

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $("#did-it-work").width();
  
// set the dimensions and margins of the graph
var margin = 30,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d => d.x);
var y_extent = d3.extent(data, d => d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select("#viz").append("svg")
    .attr("width", width + 2*margin)
    .attr("height", height + 2*margin)
  .append("g")
    .attr("transform",
          "translate(" + margin + "," + margin + ")");

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(".dots")
    .data(data)
  .enter().append("circle")
    .attr("class", "dots")
    .attr("fill", d => d.group === "group 1"? "steelblue":"orangered")
    .attr("fill-opacity", 0.3)
    .attr("r", 5)
    .attr("cx", d => x(d.x) )
    .attr("cy", d => y(d.y) )
    .on("mouseover", function(d){
       d3.selectAll(".dots").attr("r", 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr("r", 10);
      
       point_vals.text("X:" + d.x + " Y:" + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append("g")
    .call(d3.axisLeft(y));
</script>
</div>
<div id="why-when" class="section level2">
<h2>Why/ When</h2>
<p>This is a bad example of a visualization for this scenario as something like plotly could do this in much less effort. If you’re doing something more complicated/ bespoke then this is a great resource to have.</p>
</div>
<div id="addendum" class="section level2">
<h2>Addendum</h2>
<p>If you’re interested, here’s the javascript code I included to make the above graph.</p>
<pre><code>var point_vals = d3.select(&quot;#viz&quot;).append(&quot;p&quot;).text(&quot;Mouseover some data!&quot;);

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $(&quot;#did-it-work&quot;).width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d =&gt; d.x);
var y_extent = d3.extent(data, d =&gt; d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select(&quot;#viz&quot;).append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width + 2*margin)
    .attr(&quot;height&quot;, height + 2*margin)
  .append(&quot;g&quot;)
    .attr(&quot;transform&quot;,
          &quot;translate(&quot; + margin + &quot;,&quot; + margin + &quot;)&quot;);

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(&quot;.dots&quot;)
    .data(data)
  .enter().append(&quot;circle&quot;)
    .attr(&quot;class&quot;, &quot;dots&quot;)
    .attr(&quot;fill&quot;, d =&gt; d.group === &quot;group 1&quot;? &quot;steelblue&quot;:&quot;orangered&quot;)
    .attr(&quot;fill-opacity&quot;, 0.3)
    .attr(&quot;r&quot;, 5)
    .attr(&quot;cx&quot;, d =&gt; x(d.x) )
    .attr(&quot;cy&quot;, d =&gt; y(d.y) )
    .on(&quot;mouseover&quot;, function(d){
       d3.selectAll(&quot;.dots&quot;).attr(&quot;r&quot;, 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr(&quot;r&quot;, 10);
      
       point_vals.text(&quot;X:&quot; + d.x + &quot; Y:&quot; + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append(&quot;g&quot;)
    .attr(&quot;transform&quot;, &quot;translate(0,&quot; + height + &quot;)&quot;)
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append(&quot;g&quot;)
    .call(d3.axisLeft(y));</code></pre>
</div>




    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="../../../../" style="background-image: url(/images/logo.png)"><span class="hidden">'s Picture</span></a>
    </figure>
    

    








<div class="post-author">

    <img style = "border-radius: 25px;" src="https://avatars0.githubusercontent.com/u/6764693?v=3&amp;u=c9c491a636605fe3d6122defb43eb367b3d9381f&amp;s=400" alt="Nick Strayer image" width="90" height="90">
    <br>
    <span style="font-size: 1.02em;font-weight: bold;">
        Nick Strayer
    </span>
    |
    <a style = "text-decoration: none;" class = "post-author__text" href = http://nickstrayer.me >
        <img style="width:20px;" src = "http://image.flaticon.com/icons/png/128/12/12195.png"/>
    </a>

    <a class="icon-twitter post-author__text" style="font-size: 1.4em; text-decoration: none;" href = https://twitter.com/NicholasStrayer onclick="window.open(this.href"></a>

    <a style = "text-decoration: none;" class = "post-author__text" href = https://github.com/nstrayer >
        <img style="width:23px;" src = "https://a248.e.akamai.net/assets.github.com/images/icons/emoji/octocat.png"/>
    </a>


    <br>

    <p class="post-author__text">Randomly walking my way though a career in statistics</p>
    


    
<section class="share">
  <p style="font-size: 1em; font-weight:bold;">Share this post <a class="icon-twitter" style="font-size: 1.1em" href="https://twitter.com/share?text=Custom%20JavaScript%20Visualizations%20in%20RMarkdown&nbsp;-&nbsp;Live%20Free%20or%20Dichotomize&amp;url=https://livefreeordichotomize.com%2f2017%2f01%2f24%2fcustom-javascript-visualizations-in-rmarkdown%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
 </a></p>
</section>



    


  <div id="disqus_thread"></div>
    <script type="text/javascript">
       
      var disqus_shortname = 'livefreeordichotomize'; 
      var disqus_identifier = '\/2017\/01\/24\/custom-javascript-visualizations-in-rmarkdown\/';
       
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


      

  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Live Free or Dichotomize</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="../../../../js/jquery.js"></script>
    <script type="text/javascript" src="../../../../js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="../../../../js/index.js"></script>
        
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="../../../../js/header_lines.js"></script>

    
</body>
</html>

