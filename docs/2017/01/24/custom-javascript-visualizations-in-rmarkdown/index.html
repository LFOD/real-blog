<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Custom JavaScript visualizations in RMarkdown"/>
<meta name="twitter:description" content="I happened to stumble upon the preview release page for RStudio recently and noticed something that made me exorbitantly happy.
 A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…
 “Support for JavaScript and CSS chunks in R Notebooks”! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting."/>



  	<meta property="og:title" content=" Custom JavaScript visualizations in RMarkdown &middot;  Live Free or Dichotomize" />
  	<meta property="og:site_name" content="Live Free or Dichotomize" />
  	<meta property="og:url" content="/2017/01/24/custom-javascript-visualizations-in-rmarkdown/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2017-01-24T10:54:24&#43;02:00" />

    
    <meta property="og:article:tag" content="javascript" />
    
    <meta property="og:article:tag" content="visualization" />
    
    

    <title>
       Custom JavaScript visualizations in RMarkdown &middot;  Live Free or Dichotomize
    </title>

    <meta name="description" content="A statistics blog from two goofy Phd students." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../../../../images/favicon.ico">
	  <link rel="apple-touch-icon" href="../../../../images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="../../../../css/screen.css" />
    <link rel="stylesheet" type="text/css" href="../../../../css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />

    
      
          <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="Live Free or Dichotomize" />
      
      
    
    <meta name="generator" content="Hugo 0.17" />

    <link rel="canonical" href="../../../../2017/01/24/custom-javascript-visualizations-in-rmarkdown/" />

    

    






</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="../../../../about/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/lfod/blog">GitHub</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/LucyStats">Lucy&#39;s Twitter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/NickStrayer">Nick&#39;s Twitter</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="../../../../index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="../../../../"><img src="../../../../images/logo.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Custom JavaScript visualizations in RMarkdown</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-01-24T10:54:24&#43;02:00">
            Jan 24, 2017
          </time>
        
         
          <span class="post-tag small"><a href="../../../../tags/javascript/">#javascript</a></span>
         
          <span class="post-tag small"><a href="../../../../tags/visualization/">#visualization</a></span>
         
        </section>
    </header>

    <section class="post-content">


<p><br></p>
<p>I happened to stumble upon the <a href="https://www.rstudio.com/products/rstudio/download/preview/">preview release page</a> for RStudio recently and noticed something that made me exorbitantly happy.</p>
<blockquote>
<p>A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…</p>
</blockquote>
<p><em>“Support for JavaScript and CSS chunks in R Notebooks”</em>! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting. Previously my workflow for generating an interactive graphic would be something like:</p>
<ul>
<li>Download data</li>
<li>Clean data and do preliminary visualization in R</li>
<li>Export what I liked to a csv file and make a new directory with a set of <code>.html, .js, .css</code> files in it.</li>
<li>Load data into javascript/d3.js in the new javascript file.</li>
<li>Plot.</li>
</ul>
<p>This workflow has served me very well, I did it probably 20 times a day when working at the New York Times and I am very fast with it. If you want to just make a stand alone visualization it’s fantastic, however, as a biostatistician who works with a lot of other biostatisticians, people tend to want to see where the data comes from.</p>
<p>With Javascript chunks in <code>.Rmd</code> files you can explicitly show the code for data gathering/cleaning etc. in a language that your collaborators can understand, along with making custom d3 charts with that data. All without ever leaving RStudio. I will show you my quick and dirty solution to doing so.</p>
<div id="getting-data-into-javascript" class="section level2">
<h2>Getting data into Javascript</h2>
<p>Instead of generating a csv file in R and then loading that into javascript we will instead send the data directly through the html to javascript. (<em>Note:</em> This wont work well with super large data).</p>
<p>Inspired by <a href="https://medium.com/@becausealice2/getting-r-and-d3-js-to-play-nicely-in-r-markdown-270e302a52d3#.772g93eb3">this</a> medium post I wrote a little function that takes a dataframe and sends it to the html document in the <code>.json</code> format.</p>
<pre class="r"><code>library(tidyverse)
library(jsonlite)

send_df_to_js &lt;- function(df){
  cat(
    paste(
    &#39;&lt;script&gt;
      var data = &#39;,toJSON(df),&#39;;
    &lt;/script&gt;&#39;
    , sep=&quot;&quot;)
  )
}</code></pre>
<p>To illustrate how it works we will generate some random data into a dataframe.</p>
<pre class="r"><code>#Generate some random x and y data to plot
n &lt;- 300
random_data &lt;- data_frame(x = runif(n)*10) %&gt;% 
  mutate(y = 0.5*x^3 - 1.3*x^2 + rnorm(n, mean = 0, sd = 80),
         group = paste(&quot;group&quot;, sample(c(1,2,3), n, replace = T)))</code></pre>
<p>Now we send a snippit of the dataframe into the function to see the output…</p>
<pre class="r"><code>random_data %&gt;% 
  head() %&gt;% 
  send_df_to_js()</code></pre>
<pre><code>## &lt;script&gt;
##       var data = [{&quot;x&quot;:4.0804,&quot;y&quot;:15.6892,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:9.3618,&quot;y&quot;:308.4212,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:8.5421,&quot;y&quot;:272.6251,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:1.0672,&quot;y&quot;:-100.2135,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:9.999,&quot;y&quot;:378.6786,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:6.5766,&quot;y&quot;:54.2057,&quot;group&quot;:&quot;group 3&quot;}];
##     &lt;/script&gt;</code></pre>
<p>Beautiful, we have our data, in <code>json</code> format, wrapped in a script tag. Now we can send the whole dataframe through. This time I am using the <code>results = &quot;asis&quot;</code> option in the code chunk (<code>{r, results = &quot;asis&quot;}</code>), to write the results directly to the html document and not to the output like we did above.</p>
<pre class="r"><code>#Initiate data transfer protocol one
send_df_to_js(random_data)</code></pre>
<script>
      var data = [{"x":4.0804,"y":15.6892,"group":"group 1"},{"x":9.3618,"y":308.4212,"group":"group 2"},{"x":8.5421,"y":272.6251,"group":"group 1"},{"x":1.0672,"y":-100.2135,"group":"group 3"},{"x":9.999,"y":378.6786,"group":"group 1"},{"x":6.5766,"y":54.2057,"group":"group 3"},{"x":7.7037,"y":212.0067,"group":"group 1"},{"x":4.3,"y":111.8917,"group":"group 1"},{"x":1.5121,"y":-22.4925,"group":"group 3"},{"x":0.3954,"y":29.7616,"group":"group 3"},{"x":3.5737,"y":52.5659,"group":"group 3"},{"x":8.279,"y":187.0672,"group":"group 3"},{"x":4.2981,"y":-113.3463,"group":"group 1"},{"x":2.1959,"y":64.669,"group":"group 3"},{"x":7.5977,"y":30.0415,"group":"group 3"},{"x":2.9044,"y":-30.339,"group":"group 2"},{"x":6.5621,"y":56.1832,"group":"group 2"},{"x":9.4553,"y":282.5716,"group":"group 2"},{"x":1.3865,"y":-151.2519,"group":"group 1"},{"x":4.0558,"y":-23.1655,"group":"group 3"},{"x":7.1594,"y":98.2888,"group":"group 3"},{"x":2.43,"y":-25.7297,"group":"group 1"},{"x":8.876,"y":250.9431,"group":"group 3"},{"x":3.2923,"y":35.9877,"group":"group 3"},{"x":7.6998,"y":90.2723,"group":"group 2"},{"x":2.7997,"y":-21.0396,"group":"group 2"},{"x":4.7283,"y":70.324,"group":"group 3"},{"x":6.2807,"y":31.5122,"group":"group 2"},{"x":4.9885,"y":-9.6005,"group":"group 1"},{"x":0.281,"y":15.8435,"group":"group 1"},{"x":6.1082,"y":-4.1507,"group":"group 3"},{"x":6.3761,"y":158.3336,"group":"group 1"},{"x":3.443,"y":-132.6158,"group":"group 3"},{"x":1.1468,"y":61.2987,"group":"group 3"},{"x":0.2501,"y":84.8603,"group":"group 3"},{"x":6.1365,"y":-18.4451,"group":"group 2"},{"x":2.6103,"y":2.8207,"group":"group 1"},{"x":0.6965,"y":98.9759,"group":"group 2"},{"x":0.8368,"y":46.9183,"group":"group 1"},{"x":0.835,"y":-29.337,"group":"group 3"},{"x":7.8883,"y":108.5664,"group":"group 3"},{"x":1.4212,"y":10.7555,"group":"group 3"},{"x":4.274,"y":-73.5146,"group":"group 3"},{"x":3.0438,"y":-20.5293,"group":"group 2"},{"x":6.6893,"y":13.5731,"group":"group 1"},{"x":3.2231,"y":40.7089,"group":"group 1"},{"x":0.7346,"y":69.6988,"group":"group 2"},{"x":8.6664,"y":167.8813,"group":"group 3"},{"x":3.8472,"y":56.6236,"group":"group 3"},{"x":7.6454,"y":181.2056,"group":"group 1"},{"x":4.3348,"y":74.4805,"group":"group 1"},{"x":3.8229,"y":100.4891,"group":"group 3"},{"x":5.7347,"y":26.6651,"group":"group 1"},{"x":7.0621,"y":135.3171,"group":"group 2"},{"x":0.1147,"y":0.8685,"group":"group 3"},{"x":6.9813,"y":-27.33,"group":"group 3"},{"x":7.8896,"y":53.2539,"group":"group 2"},{"x":4.3356,"y":-9.961,"group":"group 1"},{"x":5.377,"y":12.1224,"group":"group 3"},{"x":5.6255,"y":5.2405,"group":"group 2"},{"x":2.9111,"y":-18.3201,"group":"group 3"},{"x":9.3412,"y":283.9498,"group":"group 1"},{"x":8.4312,"y":284.7218,"group":"group 1"},{"x":8.2281,"y":36.9924,"group":"group 1"},{"x":5.7929,"y":6.5551,"group":"group 2"},{"x":1.5167,"y":-62.8657,"group":"group 2"},{"x":7.9613,"y":82.1154,"group":"group 3"},{"x":5.3161,"y":-12.3608,"group":"group 3"},{"x":6.9995,"y":304.3194,"group":"group 1"},{"x":0.5993,"y":-78.224,"group":"group 2"},{"x":3.9102,"y":-2.8099,"group":"group 1"},{"x":4.2462,"y":-20.258,"group":"group 1"},{"x":8.9325,"y":330.4557,"group":"group 2"},{"x":5.7136,"y":33.5017,"group":"group 3"},{"x":9.161,"y":216.7713,"group":"group 2"},{"x":3.6571,"y":-46.4253,"group":"group 2"},{"x":4.8026,"y":89.0758,"group":"group 2"},{"x":5.2283,"y":20.1433,"group":"group 2"},{"x":3.9469,"y":-37.7306,"group":"group 1"},{"x":3.969,"y":-27.1934,"group":"group 3"},{"x":8.0588,"y":74.1591,"group":"group 3"},{"x":9.2123,"y":221.0162,"group":"group 3"},{"x":2.7055,"y":-64.6937,"group":"group 3"},{"x":2.1442,"y":53.4307,"group":"group 2"},{"x":0.8638,"y":101.5452,"group":"group 3"},{"x":6.0006,"y":6.5604,"group":"group 3"},{"x":4.0931,"y":134.7388,"group":"group 1"},{"x":6.2919,"y":104.7796,"group":"group 1"},{"x":0.9258,"y":47.776,"group":"group 2"},{"x":7.1874,"y":97.4999,"group":"group 2"},{"x":4.7879,"y":36.5323,"group":"group 1"},{"x":9.786,"y":293.7139,"group":"group 1"},{"x":7.1491,"y":215.0538,"group":"group 3"},{"x":3.9382,"y":107.8434,"group":"group 3"},{"x":4.4374,"y":118.0256,"group":"group 2"},{"x":9.8783,"y":402.297,"group":"group 2"},{"x":3.1956,"y":-8.134,"group":"group 2"},{"x":3.5055,"y":122.3176,"group":"group 3"},{"x":3.0146,"y":-105.7884,"group":"group 1"},{"x":5.6082,"y":-13.4472,"group":"group 1"},{"x":3.2403,"y":101.5125,"group":"group 3"},{"x":2.9969,"y":71.9083,"group":"group 3"},{"x":0.1513,"y":-139.4103,"group":"group 1"},{"x":9.1086,"y":391.5673,"group":"group 2"},{"x":0.9407,"y":8.8933,"group":"group 1"},{"x":1.3673,"y":87.1346,"group":"group 1"},{"x":2.9621,"y":-42.1147,"group":"group 1"},{"x":9.0138,"y":312.3831,"group":"group 1"},{"x":3.6885,"y":5.1523,"group":"group 2"},{"x":7.1399,"y":218.313,"group":"group 1"},{"x":4.6981,"y":27.6139,"group":"group 3"},{"x":3.8158,"y":65.3199,"group":"group 1"},{"x":1.7618,"y":-156.0473,"group":"group 2"},{"x":6.8816,"y":-14.4811,"group":"group 3"},{"x":3.3102,"y":21.6866,"group":"group 3"},{"x":8.6649,"y":115.8285,"group":"group 2"},{"x":9.5157,"y":329.3457,"group":"group 1"},{"x":9.39,"y":359.2483,"group":"group 1"},{"x":4.5529,"y":9.6719,"group":"group 1"},{"x":4.316,"y":-43.9455,"group":"group 3"},{"x":8.4666,"y":78.0863,"group":"group 3"},{"x":2.544,"y":-120.9728,"group":"group 1"},{"x":9.3773,"y":295.3248,"group":"group 1"},{"x":6.5082,"y":77.7259,"group":"group 1"},{"x":8.5689,"y":108.9013,"group":"group 1"},{"x":9.8989,"y":301.8726,"group":"group 3"},{"x":1.199,"y":30.3649,"group":"group 1"},{"x":2.2412,"y":55.077,"group":"group 1"},{"x":7.7597,"y":49.7693,"group":"group 3"},{"x":8.666,"y":207.0773,"group":"group 3"},{"x":6.7453,"y":102.7853,"group":"group 1"},{"x":0.3335,"y":-63.9473,"group":"group 1"},{"x":5.3731,"y":109.4226,"group":"group 2"},{"x":5.4655,"y":49.0952,"group":"group 1"},{"x":5.7824,"y":109.6812,"group":"group 3"},{"x":5.2848,"y":-28.8546,"group":"group 1"},{"x":8.5719,"y":314.9185,"group":"group 2"},{"x":7.3628,"y":146.1817,"group":"group 2"},{"x":0.2897,"y":-22.6806,"group":"group 1"},{"x":1.8823,"y":-177.0891,"group":"group 1"},{"x":5.2634,"y":77.3403,"group":"group 2"},{"x":9.1274,"y":229.4655,"group":"group 3"},{"x":4.1067,"y":85.1153,"group":"group 2"},{"x":7.8062,"y":239.4255,"group":"group 3"},{"x":2.7224,"y":111.8017,"group":"group 1"},{"x":5.2587,"y":-10.1332,"group":"group 3"},{"x":9.5745,"y":299.0451,"group":"group 1"},{"x":2.1796,"y":-21.2583,"group":"group 1"},{"x":7.8829,"y":120.8836,"group":"group 2"},{"x":2.4239,"y":-150.6713,"group":"group 2"},{"x":2.3968,"y":-64.9971,"group":"group 3"},{"x":0.1361,"y":22.3011,"group":"group 1"},{"x":1.3542,"y":-0.6902,"group":"group 3"},{"x":9.0092,"y":225.7205,"group":"group 3"},{"x":9.7203,"y":357.0912,"group":"group 1"},{"x":4.1421,"y":-13.848,"group":"group 2"},{"x":3.395,"y":14.36,"group":"group 1"},{"x":0.4655,"y":29.2154,"group":"group 1"},{"x":3.9633,"y":32.4499,"group":"group 3"},{"x":4.6362,"y":13.5102,"group":"group 3"},{"x":2.5576,"y":-82.8547,"group":"group 2"},{"x":1.4862,"y":11.317,"group":"group 1"},{"x":2.8071,"y":-163.7411,"group":"group 3"},{"x":4.2453,"y":98.7684,"group":"group 1"},{"x":9.6119,"y":491.0913,"group":"group 2"},{"x":4.4136,"y":45.3229,"group":"group 1"},{"x":2.7729,"y":30.4844,"group":"group 2"},{"x":9.3072,"y":369.1282,"group":"group 2"},{"x":3.7404,"y":-53.2339,"group":"group 3"},{"x":2.5513,"y":63.3736,"group":"group 2"},{"x":2.0831,"y":-9.5128,"group":"group 2"},{"x":0.8322,"y":59.3985,"group":"group 1"},{"x":9.4551,"y":393.4252,"group":"group 2"},{"x":5.1427,"y":152.6729,"group":"group 1"},{"x":9.2235,"y":373.8384,"group":"group 2"},{"x":6.7482,"y":221.6612,"group":"group 3"},{"x":2.4303,"y":81.9321,"group":"group 1"},{"x":5.7131,"y":133.4837,"group":"group 3"},{"x":0.6115,"y":35.6528,"group":"group 1"},{"x":7.546,"y":100.5444,"group":"group 3"},{"x":2.0225,"y":-96.7322,"group":"group 1"},{"x":6.7282,"y":67.0794,"group":"group 2"},{"x":8.6078,"y":207.5242,"group":"group 1"},{"x":6.2909,"y":-48.0518,"group":"group 1"},{"x":7.0452,"y":78.2533,"group":"group 3"},{"x":7.2682,"y":152.1535,"group":"group 1"},{"x":4.7132,"y":84.8005,"group":"group 1"},{"x":9.9461,"y":355.4276,"group":"group 2"},{"x":5.5373,"y":22.6076,"group":"group 1"},{"x":5.6532,"y":196.2051,"group":"group 2"},{"x":1.668,"y":85.2852,"group":"group 3"},{"x":6.7372,"y":86.2429,"group":"group 1"},{"x":9.1295,"y":403.1169,"group":"group 3"},{"x":0.5518,"y":-28.6702,"group":"group 1"},{"x":0.0742,"y":17.585,"group":"group 3"},{"x":2.0996,"y":64.6196,"group":"group 2"},{"x":6.2378,"y":-33.0154,"group":"group 1"},{"x":1.5,"y":-23.1787,"group":"group 1"},{"x":2.3419,"y":-0.7544,"group":"group 2"},{"x":9.301,"y":241.5271,"group":"group 2"},{"x":3.3695,"y":77.3351,"group":"group 3"},{"x":9.9586,"y":364.3368,"group":"group 3"},{"x":3.129,"y":-11.0861,"group":"group 2"},{"x":1.3389,"y":-1.9966,"group":"group 1"},{"x":3.3436,"y":-51.5212,"group":"group 2"},{"x":1.9281,"y":45.4773,"group":"group 1"},{"x":3.7898,"y":-57.1679,"group":"group 2"},{"x":3.73,"y":-6.2519,"group":"group 3"},{"x":4.6453,"y":87.9345,"group":"group 3"},{"x":4.172,"y":-23.6301,"group":"group 1"},{"x":6.5907,"y":95.0002,"group":"group 1"},{"x":1.2341,"y":74.6408,"group":"group 3"},{"x":8.4552,"y":204.1606,"group":"group 3"},{"x":6.2738,"y":67.2123,"group":"group 2"},{"x":0.9358,"y":-157.2815,"group":"group 3"},{"x":4.6284,"y":74.2356,"group":"group 3"},{"x":1.1117,"y":103.5719,"group":"group 1"},{"x":6.5126,"y":72.0084,"group":"group 3"},{"x":6.4672,"y":106.8436,"group":"group 3"},{"x":9.2392,"y":262.1202,"group":"group 3"},{"x":7.1937,"y":177.8851,"group":"group 3"},{"x":7.2741,"y":156.0735,"group":"group 1"},{"x":3.8357,"y":87.3845,"group":"group 2"},{"x":3.4093,"y":76.3526,"group":"group 3"},{"x":3.5481,"y":-60.3074,"group":"group 2"},{"x":9.2981,"y":365.2378,"group":"group 3"},{"x":4.1437,"y":74.8104,"group":"group 2"},{"x":5.5113,"y":110.1815,"group":"group 2"},{"x":0.912,"y":-15.2526,"group":"group 3"},{"x":6.2674,"y":196.4986,"group":"group 2"},{"x":0.1969,"y":126.5569,"group":"group 1"},{"x":6.7449,"y":80.8444,"group":"group 2"},{"x":0.7552,"y":11.769,"group":"group 2"},{"x":7.4621,"y":256.3332,"group":"group 2"},{"x":7.1882,"y":108.5786,"group":"group 2"},{"x":5.5028,"y":56.3904,"group":"group 3"},{"x":5.1253,"y":26.0744,"group":"group 2"},{"x":4.2516,"y":66.9391,"group":"group 1"},{"x":5.7785,"y":5.0006,"group":"group 2"},{"x":0.1105,"y":7.4206,"group":"group 3"},{"x":0.0302,"y":5.1003,"group":"group 2"},{"x":5.3208,"y":-146.401,"group":"group 1"},{"x":4.0592,"y":148.6635,"group":"group 1"},{"x":1.0469,"y":11.4781,"group":"group 2"},{"x":6.8074,"y":137.7089,"group":"group 3"},{"x":9.36,"y":338.5066,"group":"group 3"},{"x":7.3254,"y":28.8489,"group":"group 3"},{"x":8.5868,"y":329.6668,"group":"group 1"},{"x":4.6577,"y":76.2213,"group":"group 2"},{"x":4.8825,"y":-221.4776,"group":"group 2"},{"x":1.1728,"y":5.7783,"group":"group 1"},{"x":8.9399,"y":180.1095,"group":"group 2"},{"x":3.4221,"y":-57.4686,"group":"group 3"},{"x":4.1025,"y":88.6903,"group":"group 1"},{"x":5.0881,"y":-86.8537,"group":"group 1"},{"x":0.7298,"y":42.0683,"group":"group 2"},{"x":5.284,"y":26.4544,"group":"group 3"},{"x":9.7399,"y":407.6015,"group":"group 1"},{"x":9.0579,"y":129.1747,"group":"group 3"},{"x":7.0874,"y":93.2034,"group":"group 3"},{"x":1.9229,"y":2.5655,"group":"group 3"},{"x":4.0571,"y":-32.2967,"group":"group 3"},{"x":0.3734,"y":38.2698,"group":"group 1"},{"x":8.675,"y":177.9825,"group":"group 2"},{"x":5.5368,"y":131.1423,"group":"group 1"},{"x":5.7346,"y":-93.7112,"group":"group 1"},{"x":4.5365,"y":72.5709,"group":"group 1"},{"x":9.24,"y":325.1435,"group":"group 3"},{"x":7.9293,"y":279.1832,"group":"group 1"},{"x":3.2663,"y":-54.1879,"group":"group 1"},{"x":5.2575,"y":5.2217,"group":"group 3"},{"x":9.7106,"y":253.6835,"group":"group 3"},{"x":3.952,"y":30.1848,"group":"group 2"},{"x":2.0276,"y":-68.6641,"group":"group 3"},{"x":3.6523,"y":118.2446,"group":"group 3"},{"x":5.464,"y":140.9943,"group":"group 3"},{"x":8.0714,"y":256.6628,"group":"group 1"},{"x":8.2567,"y":215.8155,"group":"group 2"},{"x":8.2521,"y":179.8423,"group":"group 1"},{"x":5.0952,"y":29.7201,"group":"group 2"},{"x":4.5155,"y":91.7519,"group":"group 1"},{"x":9.5259,"y":372.8772,"group":"group 3"},{"x":7.5119,"y":142.6092,"group":"group 1"},{"x":2.3833,"y":22.8934,"group":"group 2"},{"x":7.1481,"y":-21.852,"group":"group 3"},{"x":6.8342,"y":153.0454,"group":"group 2"},{"x":1.9696,"y":111.8957,"group":"group 3"},{"x":7.727,"y":107.0185,"group":"group 3"},{"x":0.817,"y":6.8144,"group":"group 2"},{"x":0.681,"y":-67.212,"group":"group 1"},{"x":0.5823,"y":171.0193,"group":"group 1"},{"x":5.0273,"y":39.4568,"group":"group 2"},{"x":7.1117,"y":119.6551,"group":"group 3"},{"x":5.1985,"y":20.1209,"group":"group 1"},{"x":4.9278,"y":9.6629,"group":"group 2"},{"x":2.4693,"y":82.7055,"group":"group 1"},{"x":1.955,"y":-93.0198,"group":"group 1"},{"x":7.4294,"y":69.7305,"group":"group 2"},{"x":6.7416,"y":178.9256,"group":"group 1"},{"x":6.6122,"y":25.5252,"group":"group 1"}];
    </script>
<p>Now our data is inside our page’s javascript scope and ready to be played with!</p>
</div>
<div id="drawing-pretty-pictures" class="section level2">
<h2>Drawing pretty pictures</h2>
<p>Let’s make a super simple d3 scatter plot to see this randomly generated data. All I have to do is include my desired javascript libraries, make a <code>div</code> element for my visualization to go into and then put my <code>{js}</code> block in. RMarkdown will slot the javascript into the page and we’re good to go.</p>
<p>In this example I did…</p>
<pre><code>&lt;script src=&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://d3js.org/d3.v4.min.js&quot;&gt;&lt;/script&gt;

&lt;div id = &quot;viz&quot;&gt;&lt;/div&gt; 

` ` `{js}
//code goes here
` ` `</code></pre>
</div>
<div id="did-it-work" class="section level2">
<h2>Did it work?</h2>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<div id="viz">

</div>
<script type="text/javascript">
var point_vals = d3.select("#viz")
  .append("p")
  .attr("align", "center")
  .text("Mouseover some data!");

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $("#did-it-work").width();
  
// set the dimensions and margins of the graph
var margin = 30,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d => d.x);
var y_extent = d3.extent(data, d => d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select("#viz").append("svg")
    .attr("width", width + 2*margin)
    .attr("height", height + 2*margin)
  .append("g")
    .attr("transform",
          "translate(" + margin + "," + margin + ")");

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(".dots")
    .data(data)
  .enter().append("circle")
    .attr("class", "dots")
    .attr("fill", d => d.group === "group 1"? "steelblue":"orangered")
    .attr("fill-opacity", 0.3)
    .attr("r", 5)
    .attr("cx", d => x(d.x) )
    .attr("cy", d => y(d.y) )
    .on("mouseover", function(d){
       d3.selectAll(".dots").attr("r", 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr("r", 10);
      
       point_vals.text("X:" + d.x + " Y:" + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append("g")
    .call(d3.axisLeft(y));
</script>
</div>
<div id="why-when" class="section level2">
<h2>Why/ When</h2>
<p>This is a bad example of a visualization for this scenario as something like plotly could do this in much less effort. If you’re doing something more complicated/ bespoke then this is a great resource to have.</p>
</div>
<div id="addendum" class="section level2">
<h2>Addendum</h2>
<p>If you’re interested, here’s the javascript code I included to make the above graph.</p>
<pre><code>var point_vals = d3.select(&quot;#viz&quot;).append(&quot;p&quot;).text(&quot;Mouseover some data!&quot;);

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $(&quot;#did-it-work&quot;).width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d =&gt; d.x);
var y_extent = d3.extent(data, d =&gt; d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select(&quot;#viz&quot;).append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width + 2*margin)
    .attr(&quot;height&quot;, height + 2*margin)
  .append(&quot;g&quot;)
    .attr(&quot;transform&quot;,
          &quot;translate(&quot; + margin + &quot;,&quot; + margin + &quot;)&quot;);

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(&quot;.dots&quot;)
    .data(data)
  .enter().append(&quot;circle&quot;)
    .attr(&quot;class&quot;, &quot;dots&quot;)
    .attr(&quot;fill&quot;, d =&gt; d.group === &quot;group 1&quot;? &quot;steelblue&quot;:&quot;orangered&quot;)
    .attr(&quot;fill-opacity&quot;, 0.3)
    .attr(&quot;r&quot;, 5)
    .attr(&quot;cx&quot;, d =&gt; x(d.x) )
    .attr(&quot;cy&quot;, d =&gt; y(d.y) )
    .on(&quot;mouseover&quot;, function(d){
       d3.selectAll(&quot;.dots&quot;).attr(&quot;r&quot;, 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr(&quot;r&quot;, 10);
      
       point_vals.text(&quot;X:&quot; + d.x + &quot; Y:&quot; + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append(&quot;g&quot;)
    .attr(&quot;transform&quot;, &quot;translate(0,&quot; + height + &quot;)&quot;)
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append(&quot;g&quot;)
    .call(d3.axisLeft(y));</code></pre>
</div>




    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="../../../../" style="background-image: url(/images/logo.png)"><span class="hidden">'s Picture</span></a>
    </figure>
    

    








<div class="post-author">

    <img style = "border-radius: 25px;" src="https://avatars0.githubusercontent.com/u/6764693?v=3&amp;u=c9c491a636605fe3d6122defb43eb367b3d9381f&amp;s=400" alt="Nick Strayer image" width="90" height="90">
    <br>
    <span style="font-size: 1.02em;font-weight: bold;">
        Nick Strayer
    </span>
    |
    <a style = "text-decoration: none;" class = "post-author__text" href = http://nickstrayer.me >
        <img style="width:20px;" src = "http://image.flaticon.com/icons/png/128/12/12195.png"/>
    </a>

    <a class="icon-twitter post-author__text" style="font-size: 1.4em; text-decoration: none;" href = https://twitter.com/NicholasStrayer onclick="window.open(this.href"></a>

    <a style = "text-decoration: none;" class = "post-author__text" href = https://github.com/nstrayer >
        <img style="width:23px;" src = "https://a248.e.akamai.net/assets.github.com/images/icons/emoji/octocat.png"/>
    </a>


    <br>

    <p class="post-author__text">Randomly walking my way though a career in statistics</p>
    


    
<section class="share">
  <p style="font-size: 1em; font-weight:bold;">Share this post <a class="icon-twitter" style="font-size: 1.1em" href="https://twitter.com/share?text=Custom%20JavaScript%20visualizations%20in%20RMarkdown&nbsp;-&nbsp;Live%20Free%20or%20Dichotomize&amp;url=https://livefreeordichotomize.com%2f2017%2f01%2f24%2fcustom-javascript-visualizations-in-rmarkdown%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
 </a></p>
</section>



    


  <div id="disqus_thread"></div>
    <script type="text/javascript">
       
      var disqus_shortname = 'livefreeordichotomize'; 
      var disqus_identifier = '\/2017\/01\/24\/custom-javascript-visualizations-in-rmarkdown\/';
       
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


      

  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Live Free or Dichotomize</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="../../../../js/jquery.js"></script>
    <script type="text/javascript" src="../../../../js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="../../../../js/index.js"></script>
        
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="../../../../js/header_lines.js"></script>

    
</body>
</html>

