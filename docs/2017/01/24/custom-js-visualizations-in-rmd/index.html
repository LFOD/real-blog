<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Custom JS Visualizations in Rmd"/>
<meta name="twitter:description" content="I happened to stumble upon the preview release page for RStudio recently and noticed something that made me exorbitantly happy.
 A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…
 “Support for JavaScript and CSS chunks in R Notebooks”! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting."/>



  	<meta property="og:title" content=" Custom JS Visualizations in Rmd &middot;  Live Free or Dichotomize" />
  	<meta property="og:site_name" content="Live Free or Dichotomize" />
  	<meta property="og:url" content="/2017/01/24/custom-js-visualizations-in-rmd/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2017-01-24T10:54:24&#43;02:00" />

    
    <meta property="og:article:tag" content="javascript" />
    
    <meta property="og:article:tag" content="visualization" />
    
    

    <title>
       Custom JS Visualizations in Rmd &middot;  Live Free or Dichotomize
    </title>

    <meta name="description" content="A statistics blog from two goofy Phd students." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../../../../images/favicon.ico">
	  <link rel="apple-touch-icon" href="../../../../images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="../../../../css/screen.css" />
    <link rel="stylesheet" type="text/css" href="../../../../css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />


    
      
          <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="Live Free or Dichotomize" />
      
      
    
    <meta name="generator" content="Hugo 0.18.1" />

    <link rel="canonical" href="../../../../2017/01/24/custom-js-visualizations-in-rmd/" />

    

    






</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="../../../../about/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/lfod/blog">GitHub</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/LucyStats">Lucy&#39;s Twitter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/NickStrayer">Nick&#39;s Twitter</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="../../../../index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="../../../../"><img src="../../../../images/logo.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Custom JS Visualizations in Rmd</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-01-24T10:54:24&#43;02:00">
            Jan 24, 2017
          </time>
        
         
          <span class="post-tag small"><a href="../../../../tags/javascript/">#javascript</a></span>
         
          <span class="post-tag small"><a href="../../../../tags/visualization/">#visualization</a></span>
         
        </section>
    </header>

    <section class="post-content">


<p>I happened to stumble upon the <a href="https://www.rstudio.com/products/rstudio/download/preview/">preview release page</a> for RStudio recently and noticed something that made me exorbitantly happy.</p>
<blockquote>
<p>A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes… Support for JavaScript and CSS chunks in R Notebooks…</p>
</blockquote>
<p><em>“Support for JavaScript and CSS chunks in R Notebooks”</em>! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting. Previously my workflow for generating an interactive graphic would be something like:</p>
<ul>
<li>Download data</li>
<li>Clean data and do preliminary visualization in R</li>
<li>Export what I liked to a csv file and make a new directory with a set of <code>.html, .js, .css</code> files in it.</li>
<li>Load data into javascript/d3.js in the new javascript file.</li>
<li>Plot.</li>
</ul>
<p>This workflow has served me very well, I did it probably 20 times a day when working at the New York Times and I am very fast with it. If you want to just make a stand alone visualization it’s fantastic, however, as a biostatistician who works with a lot of other biostatisticians, people tend to want to see where the data comes from.</p>
<p>With Javascript chunks in <code>.Rmd</code> files you can explicitly show the code for data gathering/cleaning etc. in a language that your collaborators can understand, along with making custom d3 charts with that data. All without ever leaving RStudio. I will show you my quick and dirty solution to doing so.</p>
<div id="getting-data-into-javascript" class="section level2">
<h2>Getting data into Javascript</h2>
<p>Instead of generating a csv file in R and then loading that into javascript we will instead send the data directly through the html to javascript. (<em>Note:</em> This wont work well with super large data).</p>
<p>Inspired by <a href="https://medium.com/@becausealice2/getting-r-and-d3-js-to-play-nicely-in-r-markdown-270e302a52d3#.772g93eb3">this</a> medium post I wrote a little function that takes a dataframe and sends it to the html document in the <code>.json</code> format.</p>
<pre class="r"><code>library(tidyverse)
library(jsonlite)

send_df_to_js &lt;- function(df){
  cat(
    paste(
    &#39;&lt;script&gt;
      var data = &#39;,toJSON(df),&#39;;
    &lt;/script&gt;&#39;
    , sep=&quot;&quot;)
  )
}</code></pre>
<p>To illustrate how it works we will generate some random data into a dataframe.</p>
<pre class="r"><code>#Generate some random x and y data to plot
n &lt;- 300
random_data &lt;- data_frame(x = runif(n)*10) %&gt;% 
  mutate(y = 0.5*x^3 - 1.3*x^2 + rnorm(n, mean = 0, sd = 80),
         group = paste(&quot;group&quot;, sample(c(1,2,3), n, replace = T)))</code></pre>
<p>Now we send a snippit of the dataframe into the function to see the output…</p>
<pre class="r"><code>random_data %&gt;% 
  head() %&gt;% 
  send_df_to_js()</code></pre>
<pre><code>## &lt;script&gt;
##       var data = [{&quot;x&quot;:6.6491,&quot;y&quot;:169.5654,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:5.2649,&quot;y&quot;:79.2439,&quot;group&quot;:&quot;group 3&quot;},{&quot;x&quot;:6.489,&quot;y&quot;:-27.0345,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:7.931,&quot;y&quot;:301.9384,&quot;group&quot;:&quot;group 2&quot;},{&quot;x&quot;:9.0134,&quot;y&quot;:209.5231,&quot;group&quot;:&quot;group 1&quot;},{&quot;x&quot;:0.1651,&quot;y&quot;:33.5991,&quot;group&quot;:&quot;group 3&quot;}];
##     &lt;/script&gt;</code></pre>
<p>Beautiful, we have our data, in <code>json</code> format, wrapped in a script tag. Now we can send the whole dataframe through. This time I am using the <code>results = &quot;asis&quot;</code> option in the code chunk (<code>{r, results = &quot;asis&quot;}</code>), to write the results directly to the html document and not to the output like we did above.</p>
<pre class="r"><code>#Initiate data transfer protocol one
send_df_to_js(random_data)</code></pre>
<script>
      var data = [{"x":6.6491,"y":169.5654,"group":"group 2"},{"x":5.2649,"y":79.2439,"group":"group 3"},{"x":6.489,"y":-27.0345,"group":"group 2"},{"x":7.931,"y":301.9384,"group":"group 2"},{"x":9.0134,"y":209.5231,"group":"group 1"},{"x":0.1651,"y":33.5991,"group":"group 3"},{"x":1.8562,"y":159.4648,"group":"group 3"},{"x":0.8469,"y":46.9985,"group":"group 3"},{"x":0.1125,"y":2.8755,"group":"group 1"},{"x":6.3401,"y":85.2602,"group":"group 1"},{"x":5.7668,"y":53.1591,"group":"group 3"},{"x":4.0684,"y":107.5312,"group":"group 1"},{"x":6.6683,"y":168.1665,"group":"group 2"},{"x":2.0651,"y":-106.6563,"group":"group 3"},{"x":4.1786,"y":9.2575,"group":"group 3"},{"x":8.0507,"y":153.0368,"group":"group 2"},{"x":1.2613,"y":103.1086,"group":"group 2"},{"x":5.0924,"y":49.1197,"group":"group 3"},{"x":5.0479,"y":94.7571,"group":"group 3"},{"x":1.642,"y":-99.5796,"group":"group 1"},{"x":6.9906,"y":188.2268,"group":"group 1"},{"x":5.8378,"y":129.8832,"group":"group 1"},{"x":1.782,"y":-10.1843,"group":"group 2"},{"x":9.701,"y":283.9745,"group":"group 3"},{"x":7.2917,"y":58.5111,"group":"group 2"},{"x":4.315,"y":6.0572,"group":"group 3"},{"x":0.6042,"y":96.5084,"group":"group 2"},{"x":2.5715,"y":-58.0235,"group":"group 3"},{"x":4.8566,"y":64.1933,"group":"group 1"},{"x":5.4602,"y":-61.9502,"group":"group 1"},{"x":9.5289,"y":389.8686,"group":"group 1"},{"x":2.1123,"y":-1.9385,"group":"group 2"},{"x":1.1394,"y":-89.8079,"group":"group 1"},{"x":2.5776,"y":84.4403,"group":"group 3"},{"x":2.332,"y":80.5456,"group":"group 2"},{"x":0.1886,"y":57.5603,"group":"group 2"},{"x":6.9238,"y":81.803,"group":"group 2"},{"x":6.9143,"y":-26.8143,"group":"group 2"},{"x":5.4008,"y":41.5268,"group":"group 3"},{"x":9.8541,"y":455.8628,"group":"group 1"},{"x":8.0472,"y":278.3222,"group":"group 1"},{"x":6.162,"y":39.5894,"group":"group 3"},{"x":2.5782,"y":61.075,"group":"group 2"},{"x":4.8068,"y":-43.546,"group":"group 1"},{"x":8.5314,"y":185.8073,"group":"group 2"},{"x":3.9075,"y":56.9736,"group":"group 2"},{"x":5.9837,"y":-6.3031,"group":"group 1"},{"x":7.1259,"y":51.4368,"group":"group 1"},{"x":1.6554,"y":8.9999,"group":"group 3"},{"x":0.7673,"y":4.3657,"group":"group 1"},{"x":9.3497,"y":325.4552,"group":"group 3"},{"x":9.9653,"y":452.3276,"group":"group 1"},{"x":0.3049,"y":80.6678,"group":"group 1"},{"x":7.146,"y":70.9498,"group":"group 2"},{"x":9.8107,"y":314.5618,"group":"group 1"},{"x":9.1752,"y":178.2719,"group":"group 3"},{"x":2.4809,"y":-101.5613,"group":"group 2"},{"x":1.2282,"y":-3.3466,"group":"group 2"},{"x":2.1752,"y":-191.6754,"group":"group 2"},{"x":2.9476,"y":47.7604,"group":"group 2"},{"x":9.8994,"y":392.0786,"group":"group 1"},{"x":3.1112,"y":-126.8721,"group":"group 2"},{"x":3.4602,"y":64.3191,"group":"group 2"},{"x":9.3642,"y":321.4782,"group":"group 3"},{"x":3.455,"y":-29.6269,"group":"group 3"},{"x":9.6699,"y":423.0486,"group":"group 2"},{"x":7.0579,"y":75.5816,"group":"group 1"},{"x":4.6264,"y":81.9698,"group":"group 3"},{"x":5.0208,"y":24.417,"group":"group 1"},{"x":1.2816,"y":150.0315,"group":"group 2"},{"x":2.6047,"y":-25.5638,"group":"group 1"},{"x":0.1509,"y":-49.8471,"group":"group 1"},{"x":9.4871,"y":277.2008,"group":"group 1"},{"x":3.3756,"y":-19.2451,"group":"group 1"},{"x":2.9147,"y":21.3672,"group":"group 1"},{"x":3.6006,"y":29.9356,"group":"group 3"},{"x":8.3344,"y":349.9915,"group":"group 3"},{"x":1.1181,"y":-37.8925,"group":"group 3"},{"x":8.6048,"y":290.7783,"group":"group 3"},{"x":8.4653,"y":188.1955,"group":"group 3"},{"x":9.6868,"y":371.5358,"group":"group 3"},{"x":4.4403,"y":100.9848,"group":"group 3"},{"x":6.0917,"y":84.9867,"group":"group 1"},{"x":6.034,"y":-13.7402,"group":"group 3"},{"x":3.0066,"y":10.4049,"group":"group 1"},{"x":3.6595,"y":138.54,"group":"group 3"},{"x":0.0242,"y":127.5453,"group":"group 2"},{"x":3.6591,"y":112.9296,"group":"group 3"},{"x":3.8578,"y":-46.7488,"group":"group 1"},{"x":3.4777,"y":-147.1847,"group":"group 3"},{"x":2.3986,"y":8.5948,"group":"group 3"},{"x":1.9085,"y":-19.5708,"group":"group 1"},{"x":5.7694,"y":232.2911,"group":"group 1"},{"x":4.9453,"y":153.0439,"group":"group 2"},{"x":3.458,"y":29.8967,"group":"group 1"},{"x":8.3846,"y":209.4075,"group":"group 2"},{"x":3.9745,"y":69.4284,"group":"group 3"},{"x":4.869,"y":130.4281,"group":"group 2"},{"x":2.7304,"y":14.3087,"group":"group 3"},{"x":7.4228,"y":69.1418,"group":"group 2"},{"x":9.7286,"y":315.2639,"group":"group 3"},{"x":6.8713,"y":108.8047,"group":"group 2"},{"x":0.1901,"y":-6.0995,"group":"group 1"},{"x":8.2392,"y":275.9273,"group":"group 1"},{"x":4.2768,"y":-103.4801,"group":"group 3"},{"x":3.5536,"y":45.3599,"group":"group 3"},{"x":3.6116,"y":-37.1005,"group":"group 1"},{"x":2.8066,"y":-9.2368,"group":"group 3"},{"x":4.0753,"y":-17.6856,"group":"group 2"},{"x":7.4808,"y":118.3425,"group":"group 3"},{"x":3.3095,"y":-77.1881,"group":"group 2"},{"x":5.9444,"y":-79.4604,"group":"group 1"},{"x":8.0981,"y":267.2777,"group":"group 3"},{"x":5.3022,"y":58.0936,"group":"group 3"},{"x":1.9897,"y":83.6695,"group":"group 1"},{"x":9.6674,"y":439.3513,"group":"group 3"},{"x":2.9522,"y":-62.8216,"group":"group 3"},{"x":5.9422,"y":-75.8817,"group":"group 2"},{"x":8.5951,"y":223.9322,"group":"group 3"},{"x":6.9095,"y":136.6347,"group":"group 2"},{"x":3.5863,"y":106.3962,"group":"group 1"},{"x":2.5752,"y":-99.5252,"group":"group 1"},{"x":8.6449,"y":288.8835,"group":"group 1"},{"x":7.093,"y":-16.1338,"group":"group 2"},{"x":7.729,"y":62.537,"group":"group 2"},{"x":5.6727,"y":-19.3544,"group":"group 3"},{"x":4.8926,"y":-7.6714,"group":"group 1"},{"x":7.5337,"y":86.1841,"group":"group 3"},{"x":3.643,"y":28.7377,"group":"group 1"},{"x":5.6686,"y":21.1842,"group":"group 1"},{"x":4.6765,"y":116.4327,"group":"group 2"},{"x":0.2513,"y":233.0667,"group":"group 3"},{"x":9.4733,"y":513.4115,"group":"group 1"},{"x":7.1506,"y":24.0807,"group":"group 1"},{"x":8.0785,"y":119.3842,"group":"group 1"},{"x":0.5681,"y":84.7907,"group":"group 2"},{"x":5.4103,"y":18.673,"group":"group 1"},{"x":1.6474,"y":73.4434,"group":"group 2"},{"x":2.6309,"y":28.8906,"group":"group 3"},{"x":9.5901,"y":309.9654,"group":"group 3"},{"x":8.4318,"y":268.4912,"group":"group 3"},{"x":7.5877,"y":166.3278,"group":"group 3"},{"x":6.762,"y":110.8004,"group":"group 2"},{"x":1.4907,"y":-114.3468,"group":"group 2"},{"x":5.969,"y":109.9872,"group":"group 3"},{"x":3.2571,"y":-81.6768,"group":"group 3"},{"x":6.8418,"y":167.5273,"group":"group 2"},{"x":5.0901,"y":46.6479,"group":"group 3"},{"x":5.1155,"y":65.2521,"group":"group 3"},{"x":4.6937,"y":-20.5438,"group":"group 2"},{"x":0.0827,"y":-52.0684,"group":"group 1"},{"x":1.7378,"y":68.7099,"group":"group 2"},{"x":2.6284,"y":-74.8781,"group":"group 3"},{"x":1.0122,"y":-95.0345,"group":"group 2"},{"x":4.1194,"y":-14.2952,"group":"group 1"},{"x":4.0932,"y":55.5687,"group":"group 1"},{"x":0.1918,"y":8.1409,"group":"group 3"},{"x":9.9937,"y":383.6336,"group":"group 1"},{"x":6.3124,"y":31.0147,"group":"group 3"},{"x":8.1957,"y":280.618,"group":"group 3"},{"x":4.8554,"y":92.1015,"group":"group 3"},{"x":2.1286,"y":0.9489,"group":"group 2"},{"x":6.162,"y":-25.8664,"group":"group 2"},{"x":0.455,"y":77.7708,"group":"group 3"},{"x":6.2261,"y":116.734,"group":"group 3"},{"x":0.3663,"y":47.8073,"group":"group 2"},{"x":0.9925,"y":17.1956,"group":"group 1"},{"x":7.3214,"y":167.9033,"group":"group 3"},{"x":2.0773,"y":55.0514,"group":"group 1"},{"x":6.0146,"y":105.1438,"group":"group 2"},{"x":5.2613,"y":28.9478,"group":"group 3"},{"x":8.4929,"y":139.8925,"group":"group 2"},{"x":4.3377,"y":-148.5076,"group":"group 1"},{"x":7.2913,"y":166.6608,"group":"group 1"},{"x":6.95,"y":53.3551,"group":"group 3"},{"x":9.0372,"y":340.4567,"group":"group 2"},{"x":8.5945,"y":226.9199,"group":"group 3"},{"x":9.9696,"y":422.5175,"group":"group 1"},{"x":7.4988,"y":156.46,"group":"group 2"},{"x":9.3456,"y":333.1989,"group":"group 2"},{"x":6.4566,"y":105.8731,"group":"group 3"},{"x":8.7686,"y":250.6,"group":"group 3"},{"x":6.3321,"y":183.5567,"group":"group 2"},{"x":2.9876,"y":-42.5855,"group":"group 3"},{"x":0.408,"y":-86.1009,"group":"group 1"},{"x":4.9945,"y":-80.124,"group":"group 1"},{"x":2.7455,"y":69.8191,"group":"group 2"},{"x":6.8371,"y":41.0656,"group":"group 3"},{"x":1.8747,"y":34.6473,"group":"group 3"},{"x":2.2465,"y":-43.3434,"group":"group 3"},{"x":0.216,"y":-4.3855,"group":"group 1"},{"x":2.1797,"y":57.5756,"group":"group 3"},{"x":2.7501,"y":-112.2047,"group":"group 3"},{"x":9.7155,"y":305.086,"group":"group 2"},{"x":9.845,"y":456.0534,"group":"group 1"},{"x":6.7844,"y":211.8634,"group":"group 3"},{"x":4.6766,"y":39.4273,"group":"group 2"},{"x":8.8276,"y":185.2507,"group":"group 2"},{"x":6.1924,"y":95.5303,"group":"group 3"},{"x":8.6925,"y":171.7048,"group":"group 3"},{"x":9.3188,"y":344.6535,"group":"group 2"},{"x":1.2609,"y":-59.6314,"group":"group 3"},{"x":5.6215,"y":209.2261,"group":"group 2"},{"x":3.1559,"y":2.2824,"group":"group 3"},{"x":0.7029,"y":57.1318,"group":"group 3"},{"x":7.268,"y":125.2024,"group":"group 1"},{"x":2.599,"y":174.0408,"group":"group 2"},{"x":7.7968,"y":298.0023,"group":"group 2"},{"x":7.3788,"y":50.1254,"group":"group 3"},{"x":7.1112,"y":49.1014,"group":"group 1"},{"x":2.7239,"y":111.6642,"group":"group 2"},{"x":1.0795,"y":-16.7084,"group":"group 1"},{"x":8.2407,"y":226.5252,"group":"group 2"},{"x":9.0107,"y":313.8196,"group":"group 3"},{"x":3.3954,"y":-36.7262,"group":"group 2"},{"x":1.4534,"y":45.9781,"group":"group 1"},{"x":0.9287,"y":-84.8565,"group":"group 2"},{"x":2.9604,"y":-88.8442,"group":"group 1"},{"x":3.7327,"y":41.6851,"group":"group 2"},{"x":8.2921,"y":97.5459,"group":"group 1"},{"x":8.4443,"y":247.3228,"group":"group 3"},{"x":0.7394,"y":-18.847,"group":"group 2"},{"x":2.873,"y":-103.363,"group":"group 1"},{"x":0.1084,"y":69.7549,"group":"group 3"},{"x":0.3162,"y":2.4004,"group":"group 1"},{"x":1.534,"y":-61.1327,"group":"group 1"},{"x":8.1357,"y":291.0825,"group":"group 3"},{"x":5.8888,"y":127.2131,"group":"group 1"},{"x":4.2884,"y":23.4168,"group":"group 3"},{"x":0.723,"y":122.7052,"group":"group 1"},{"x":0.4899,"y":117.3307,"group":"group 1"},{"x":7.1882,"y":48.0744,"group":"group 1"},{"x":4.7524,"y":67.4292,"group":"group 3"},{"x":6.8388,"y":14.6668,"group":"group 2"},{"x":1.6543,"y":-62.4057,"group":"group 2"},{"x":8.1798,"y":165.6479,"group":"group 3"},{"x":8.6191,"y":268.8643,"group":"group 3"},{"x":4.6624,"y":-52.4277,"group":"group 1"},{"x":4.6649,"y":85.6781,"group":"group 3"},{"x":4.7431,"y":42.6106,"group":"group 2"},{"x":4.963,"y":72.3454,"group":"group 3"},{"x":5.2029,"y":-38.7753,"group":"group 1"},{"x":8.6644,"y":303.9404,"group":"group 1"},{"x":1.1267,"y":-29.978,"group":"group 2"},{"x":9.3358,"y":267.064,"group":"group 2"},{"x":1.3721,"y":-80.5128,"group":"group 3"},{"x":6.6493,"y":-15.7879,"group":"group 1"},{"x":1.6275,"y":23.8309,"group":"group 3"},{"x":7.7866,"y":199.3896,"group":"group 3"},{"x":6.0231,"y":159.5779,"group":"group 2"},{"x":1.0109,"y":-43.8017,"group":"group 1"},{"x":9.7181,"y":408.3013,"group":"group 2"},{"x":3.5131,"y":-167.4724,"group":"group 2"},{"x":7.7643,"y":84.5837,"group":"group 3"},{"x":3.1157,"y":40.1561,"group":"group 3"},{"x":7.1396,"y":143.4697,"group":"group 2"},{"x":1.0048,"y":-110.2644,"group":"group 3"},{"x":0.2121,"y":4.5769,"group":"group 2"},{"x":9.7994,"y":258.0368,"group":"group 1"},{"x":5.2709,"y":-17.4355,"group":"group 1"},{"x":2.7324,"y":15.6607,"group":"group 2"},{"x":3.1374,"y":-108.1649,"group":"group 1"},{"x":8.7033,"y":225.5639,"group":"group 1"},{"x":7.8353,"y":277.2478,"group":"group 2"},{"x":7.4843,"y":181.5428,"group":"group 1"},{"x":3.2291,"y":-22.9167,"group":"group 2"},{"x":3.3238,"y":61.6034,"group":"group 1"},{"x":8.9314,"y":286.5068,"group":"group 3"},{"x":5.5392,"y":-174.1899,"group":"group 3"},{"x":5.7787,"y":36.4186,"group":"group 2"},{"x":6.8494,"y":160.7165,"group":"group 3"},{"x":1.304,"y":69.7189,"group":"group 3"},{"x":3.803,"y":28.7059,"group":"group 1"},{"x":4.9885,"y":32.3844,"group":"group 2"},{"x":6.5596,"y":38.7713,"group":"group 1"},{"x":1.0013,"y":-38.9912,"group":"group 3"},{"x":0.2772,"y":111.9586,"group":"group 1"},{"x":6.7248,"y":-10.5376,"group":"group 1"},{"x":1.3144,"y":32.6933,"group":"group 2"},{"x":4.3158,"y":50.8124,"group":"group 1"},{"x":1.4197,"y":7.9872,"group":"group 2"},{"x":2.9564,"y":-95.5729,"group":"group 3"},{"x":0.2627,"y":-67.5932,"group":"group 1"},{"x":4.849,"y":-97.7867,"group":"group 2"},{"x":3.1967,"y":2.3979,"group":"group 3"},{"x":4.1137,"y":-30.2514,"group":"group 2"},{"x":0.0546,"y":116.9001,"group":"group 3"},{"x":0.4349,"y":88.7743,"group":"group 1"},{"x":1.7185,"y":-16.2077,"group":"group 3"},{"x":9.2002,"y":191.3182,"group":"group 1"},{"x":2.9467,"y":15.7354,"group":"group 3"},{"x":1.5307,"y":-57.181,"group":"group 2"},{"x":6.425,"y":-25.8154,"group":"group 2"},{"x":2.2541,"y":168.8594,"group":"group 2"},{"x":7.7326,"y":117.6308,"group":"group 3"},{"x":9.6142,"y":265.1772,"group":"group 3"},{"x":7.322,"y":244.9246,"group":"group 1"},{"x":5.0405,"y":-20.6643,"group":"group 3"},{"x":2.2181,"y":-63.1688,"group":"group 2"},{"x":5.4107,"y":122.8428,"group":"group 3"}];
    </script>
<p>Now our data is inside our page’s javascript scope and ready to be played with!</p>
</div>
<div id="drawing-pretty-pictures" class="section level2">
<h2>Drawing pretty pictures</h2>
<p>Let’s make a super simple d3 scatter plot to see this randomly generated data. All I have to do is include my desired javascript libraries, make a <code>div</code> element for my visualization to go into and then put my <code>{js}</code> block in. RMarkdown will slot the javascript into the page and we’re good to go.</p>
<p>In this example I did…</p>
<pre><code>&lt;script src=&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://d3js.org/d3.v4.min.js&quot;&gt;&lt;/script&gt;

&lt;div id = &quot;viz&quot;&gt;&lt;/div&gt; 

` ` `{js}
//code goes here
` ` `</code></pre>
</div>
<div id="did-it-work" class="section level2">
<h2>Did it work?</h2>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<div id="viz">

</div>
<script type="text/javascript">
var point_vals = d3.select("#viz").append("p").text("Mouseover some data!");

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $("#did-it-work").width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d => d.x);
var y_extent = d3.extent(data, d => d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select("#viz").append("svg")
    .attr("width", width + 2*margin)
    .attr("height", height + 2*margin)
  .append("g")
    .attr("transform",
          "translate(" + margin + "," + margin + ")");

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(".dots")
    .data(data)
  .enter().append("circle")
    .attr("class", "dots")
    .attr("fill", d => d.group === "group 1"? "steelblue":"orangered")
    .attr("fill-opacity", 0.3)
    .attr("r", 5)
    .attr("cx", d => x(d.x) )
    .attr("cy", d => y(d.y) )
    .on("mouseover", function(d){
       d3.selectAll(".dots").attr("r", 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr("r", 10);
      
       point_vals.text("X:" + d.x + " Y:" + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append("g")
    .call(d3.axisLeft(y));
</script>
</div>
<div id="why-when" class="section level2">
<h2>Why/ When</h2>
<p>This is a bad example of a visualization for this scenario as something like plotly could do this in much less effort. If you’re doing something more complicated/ bespoke then this is a great resource to have.</p>
</div>
<div id="addendum" class="section level2">
<h2>Addendum</h2>
<p>If you’re interested, here’s the javascript code I included to make the above graph.</p>
<pre><code>var point_vals = d3.select(&quot;#viz&quot;).append(&quot;p&quot;).text(&quot;Mouseover some data!&quot;);

//Get how wide our page is in pixels so we can draw our plot in it
var page_width = $(&quot;#did-it-work&quot;).width();
  
// set the dimensions and margins of the graph
var margin = 20,
    width = page_width - 2*margin,
    height = page_width*0.8 - 2*margin;
    
// Find max data values
var x_extent = d3.extent(data, d =&gt; d.x);
var y_extent = d3.extent(data, d =&gt; d.y);

// Set the scales 
var x = d3.scaleLinear()
  .domain(x_extent)
  .range([0, width]);
  
var y = d3.scaleLinear()
  .domain(y_extent)
  .range([height, 0]);

//Set up our SVG element
var svg = d3.select(&quot;#viz&quot;).append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width + 2*margin)
    .attr(&quot;height&quot;, height + 2*margin)
  .append(&quot;g&quot;)
    .attr(&quot;transform&quot;,
          &quot;translate(&quot; + margin + &quot;,&quot; + margin + &quot;)&quot;);

var bounce_select = d3.transition()
    .duration(1000)
    .ease(d3.easeElastic.period(0.4));
    
// Add the scatterplot
svg.selectAll(&quot;.dots&quot;)
    .data(data)
  .enter().append(&quot;circle&quot;)
    .attr(&quot;class&quot;, &quot;dots&quot;)
    .attr(&quot;fill&quot;, d =&gt; d.group === &quot;group 1&quot;? &quot;steelblue&quot;:&quot;orangered&quot;)
    .attr(&quot;fill-opacity&quot;, 0.3)
    .attr(&quot;r&quot;, 5)
    .attr(&quot;cx&quot;, d =&gt; x(d.x) )
    .attr(&quot;cy&quot;, d =&gt; y(d.y) )
    .on(&quot;mouseover&quot;, function(d){
       d3.selectAll(&quot;.dots&quot;).attr(&quot;r&quot;, 5) //make sure all the dots are small
       d3.select(this)
        .transition(bounce_select)
        .attr(&quot;r&quot;, 10);
      
       point_vals.text(&quot;X:&quot; + d.x + &quot; Y:&quot; + d.y) //change the title of the graph to the datapoint
    });
    
// Draw the axes    
// Add the X Axis
svg.append(&quot;g&quot;)
    .attr(&quot;transform&quot;, &quot;translate(0,&quot; + height + &quot;)&quot;)
    .call(d3.axisBottom(x));

// Add the Y Axis
svg.append(&quot;g&quot;)
    .call(d3.axisLeft(y));</code></pre>
</div>




    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="../../../../" style="background-image: url(/images/logo.png)"><span class="hidden">'s Picture</span></a>
    </figure>
    

    








<div class="post-author">

    <img style = "border-radius: 25px;" src="https://avatars0.githubusercontent.com/u/6764693?v=3&amp;u=c9c491a636605fe3d6122defb43eb367b3d9381f&amp;s=400" alt="Nick Strayer image" width="90" height="90">
    <br>
    <span style="font-size: 1.02em;font-weight: bold;">
        Nick Strayer
    </span>
    |
    <a style = "text-decoration: none;" class = "post-author__text" href = http://nickstrayer.me >
        <img style="width:20px;" src = "http://image.flaticon.com/icons/png/128/12/12195.png"/>
    </a>

    <a class="icon-twitter post-author__text" style="font-size: 1.4em; text-decoration: none;" href = https://twitter.com/NicholasStrayer onclick="window.open(this.href"></a>

    <a style = "text-decoration: none;" class = "post-author__text" href = https://github.com/nstrayer >
        <img style="width:23px;" src = "https://a248.e.akamai.net/assets.github.com/images/icons/emoji/octocat.png"/>
    </a>


    <br>

    <p class="post-author__text">Randomly walking my way though a career in statistics</p>
    


    
<section class="share">
  <p style="font-size: 1em; font-weight:bold;">Share this post <a class="icon-twitter" style="font-size: 1.1em" href="https://twitter.com/share?text=Custom%20JS%20Visualizations%20in%20Rmd&nbsp;-&nbsp;Live%20Free%20or%20Dichotomize&amp;url=https://livefreeordichotomize.com%2f2017%2f01%2f24%2fcustom-js-visualizations-in-rmd%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
 </a></p>
</section>



    




  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Live Free or Dichotomize</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="../../../../js/jquery.js"></script>
    <script type="text/javascript" src="../../../../js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="../../../../js/index.js"></script>
    
</body>
</html>

