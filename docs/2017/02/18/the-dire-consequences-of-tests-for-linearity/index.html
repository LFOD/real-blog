<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="The dire consequences of tests for linearity"/>
<meta name="twitter:description" content="This is a tale of the dire type 1 error consequences that occur when you test for linearity.
 Edvard Munch‚Äôs The Scream (1893), coincidentally also the face Frank Harrell makes when he sees students testing for linearity. First, my favorite explanation of type 1 error üê∫:
 @jgschraiber @eagereyes Pro-tip that changed my life: in The Boy Who Cried Wolf, the villagers first make a Type 1, and then a Type 2 error."/>



  	<meta property="og:title" content=" The dire consequences of tests for linearity &middot;  Live Free or Dichotomize" />
  	<meta property="og:site_name" content="Live Free or Dichotomize" />
  	<meta property="og:url" content="/2017/02/18/the-dire-consequences-of-tests-for-linearity/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2017-02-18T09:03:06-06:00" />

    
    <meta property="og:article:tag" content="rms" />
    
    <meta property="og:article:tag" content="type 1 error" />
    
    <meta property="og:article:tag" content="nonlinearity" />
    
    

    <title>
       The dire consequences of tests for linearity &middot;  Live Free or Dichotomize
    </title>

    <meta name="description" content="A statistics blog from two goofy Phd students." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../../../../images/favicon.ico">
	  <link rel="apple-touch-icon" href="../../../../images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="../../../../css/screen.css" />
    <link rel="stylesheet" type="text/css" href="../../../../css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />

    
      
          <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="Live Free or Dichotomize" />
      
      
    
    <meta name="generator" content="Hugo 0.17" />

    <link rel="canonical" href="../../../../2017/02/18/the-dire-consequences-of-tests-for-linearity/" />

    

    






</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="../../../../about/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/lfod/blog">GitHub</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/LucyStats">Lucy&#39;s Twitter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/NickStrayer">Nick&#39;s Twitter</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="../../../../index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="../../../../"><img src="../../../../images/logo.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">The dire consequences of tests for linearity</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-02-18T09:03:06-06:00">
            Feb 18, 2017
          </time>
        
         
          <span class="post-tag small"><a href="../../../../tags/rms/">#rms</a></span>
         
          <span class="post-tag small"><a href="../../../../tags/type-1-error/">#type 1 error</a></span>
         
          <span class="post-tag small"><a href="../../../../tags/nonlinearity/">#nonlinearity</a></span>
         
        </section>
    </header>

    <section class="post-content">


<p>This is a tale of the dire <strong>type 1 error</strong> consequences that occur when you test for linearity.</p>
<a href="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f4/The_Scream.jpg/603px-The_Scream.jpg" target="_blank"> <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f4/The_Scream.jpg/603px-The_Scream.jpg" width=50% alt="the scream"> </a>
<p style="color:#EB6864; font-size: 10pt;LINE-HEIGHT:15px;">
<em>Edvard Munch‚Äôs The Scream (1893), coincidentally also the face <a href="https://twitter.com/f2harrell">Frank Harrell</a> makes when he sees students testing for linearity.</em>
</p>
<p>First, my favorite explanation of <strong>type 1 error</strong> üê∫:</p>
<center>
<blockquote class="twitter-tweet" data-conversation="none" data-lang="en">
<p lang="en" dir="ltr">
<a href="https://twitter.com/jgschraiber"><span class="citation">@jgschraiber</span></a> <a href="https://twitter.com/eagereyes"><span class="citation">@eagereyes</span></a> Pro-tip that changed my life: in The Boy Who Cried Wolf, the villagers first make a Type 1, and then a Type 2 error.
</p>
‚Äî Sam (<span class="citation">@geometrywarrior</span>) <a href="https://twitter.com/geometrywarrior/status/781162199540719616">September 28, 2016</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>
<p>We generally fix (or claim to fix) this <strong>type 1 error</strong> at 0.05, but sometimes our procedures can make this go awry!</p>
<p>I‚Äôve prepared a <strong>very</strong> basic simulation.</p>
<ul>
<li>generate 100 data points from two independent random normal distributions, an outcome <span class="math inline">\(y\)</span> and a predictor <span class="math inline">\(x\)</span><span style="color:#EB6864"> (Since these are generated randomly, we would <strong>not</strong> expect there to be an association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. If all goes as planned, our <strong>type 1 error</strong> would be 0.05) </span></li>
<li>fit simple linear model with a restricted cubic spline on the predictor <span class="math inline">\(x\)</span></li>
<li>test whether the nonlinear terms are significant</li>
<li>if they are, leave them in and test the association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span></li>
<li>if they are not, remove them and refit the model with only a linear term for <span class="math inline">\(x\)</span> &amp; proceed to test the association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.<br />
</li>
<li>calculate the <strong>type 1 error</strong>, how many times we detected a spurious significant association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</li>
</ul>
<p>Here‚Äôs my simulation code (run it yourself!):</p>
<pre class="r"><code>library(&#39;rms&#39;)

sim &lt;- function(wrong = TRUE){
#generate completely random data
y &lt;- rnorm(100)
x &lt;- rnorm(100)
#fit a model with a restricted cubic spline
mod &lt;- ols(y~rcs(x))

if (wrong == TRUE &amp; anova(mod)[3,5] &gt; 0.05){
  #if the test for non-linearity is not &quot;significant&quot;, remove nonlinear terms
  mod &lt;- ols(y~x)
} 
 #save the p-value
 anova(mod)[1,5]
}</code></pre>
<center>
<p><span style="color:#EB6864; font-size: 20pt"> [Type 1 error when removing non-significant nonlinear terms]</p>
<p></span></p>
</center>
<pre class="r"><code>test &lt;- replicate(10000, sim()) 
cat(&quot;The type 1 error is&quot;, mean(test &lt;= 0.05)) </code></pre>
<pre><code>## The type 1 error is 0.0853</code></pre>
<p>Uh oh! That <strong>type 1 error</strong> is certainly higher than the nominal 0.05 we claim!</p>
<center>
<p><span style="color:#EB6864; font-size: 20pt"> [Type 1 error when not removing non-significant nonlinear terms]</span></p>
</center>
<p>We would expect the <strong>type 1 error</strong> to be 0.05 ‚Äì I perform the same simulation omitting the step of removing non-significant nonlinear terms and calculate the <strong>type 1 error</strong> again.</p>
<pre class="r"><code>test &lt;- replicate(10000, sim(wrong = FALSE))
cat(&quot;The type 1 error is&quot;, mean(test &lt;= 0.05))</code></pre>
<pre><code>## The type 1 error is 0.0501</code></pre>
<p>Much better üëØ</p>
<p>The conclusion: <a href="http://livefreeordichotomize.com/2017/01/27/yoga-for-modeling/">fit flexible models</a> - skip the tests for linearity!</p>
<p><em>This has been elegently demonstrated by others, check out <a href="http://onlinelibrary.wiley.com/doi/10.1002/sim.4780100504/full">Grambsch and O‚ÄôBrien</a>.</em></p>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="../../../../" style="background-image: url(/images/logo.png)"><span class="hidden">'s Picture</span></a>
    </figure>
    

    








<div class="post-author">

    <img style = "border-radius: 25px;" src="https://avatars0.githubusercontent.com/u/8431897?v=3&amp;s=460" alt="Lucy D&#39;Agostino McGowan image" width="90" height="90">
    <br>
    <span style="font-size: 1.02em;font-weight: bold;">
        Lucy D&#39;Agostino McGowan
    </span>
    |
    <a style = "text-decoration: none;" class = "post-author__text" href = http://lucymcgowan.com >
        <img style="width:20px;" src = "http://image.flaticon.com/icons/png/128/12/12195.png"/>
    </a>

    <a class="icon-twitter post-author__text" style="font-size: 1.4em; text-decoration: none;" href = https://twitter.com/lucyStats onclick="window.open(this.href"></a>

    <a style = "text-decoration: none;" class = "post-author__text" href = https://github.com/LucyMcGowan >
        <img style="width:23px;" src = "https://a248.e.akamai.net/assets.github.com/images/icons/emoji/octocat.png"/>
    </a>


    <br>

    <p class="post-author__text">Currently excited about: observational study methods, translational research, BB-8</p>
    


    
<section class="share">
  <p style="font-size: 1em; font-weight:bold;">Share this post <a class="icon-twitter" style="font-size: 1.1em" href="https://twitter.com/share?text=The%20dire%20consequences%20of%20tests%20for%20linearity&nbsp;-&nbsp;Live%20Free%20or%20Dichotomize&amp;url=https://livefreeordichotomize.com%2f2017%2f02%2f18%2fthe-dire-consequences-of-tests-for-linearity%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
 </a></p>
</section>



    


      

  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Live Free or Dichotomize</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="../../../../js/jquery.js"></script>
    <script type="text/javascript" src="../../../../js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="../../../../js/index.js"></script>
        
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="../../../../js/header_lines.js"></script>

    
</body>
</html>

